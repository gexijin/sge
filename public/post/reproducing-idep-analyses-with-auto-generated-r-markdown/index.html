<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.42.2" />
  <meta name="author" content="Steven Xijin Ge">

  
  
  
  
    
      
    
  
  <meta name="description" content="iDEP is a tool for interactive analysis of RNA-Seq data. After analyzing their data, users have the option to download a R Markdown file, toegether with other data files, to reproduce the entire workflow. This blog is both the easiest and hardest of all. It is easy because everything below was automatically generated by iDEP; it is hard as I have to write code to write code when developing iDEP.">

  
  <link rel="alternate" hreflang="en-us" href="/post/reproducing-idep-analyses-with-auto-generated-r-markdown/">

  


  

  
  
  <meta name="theme-color" content="#0095eb">
  
  
  
  
    
  
  
    
    
      
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
      
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
  
  <link rel="stylesheet" href="/styles.css">
  

  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-87863704-4', 'auto');
      
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="In Data We Trust">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="In Data We Trust">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/reproducing-idep-analyses-with-auto-generated-r-markdown/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@StevenXGe">
  <meta property="twitter:creator" content="@StevenXGe">
  
  <meta property="og:site_name" content="In Data We Trust">
  <meta property="og:url" content="/post/reproducing-idep-analyses-with-auto-generated-r-markdown/">
  <meta property="og:title" content="Reproducing iDEP analyses with auto-generated R Markdown | In Data We Trust">
  <meta property="og:description" content="iDEP is a tool for interactive analysis of RNA-Seq data. After analyzing their data, users have the option to download a R Markdown file, toegether with other data files, to reproduce the entire workflow. This blog is both the easiest and hardest of all. It is easy because everything below was automatically generated by iDEP; it is hard as I have to write code to write code when developing iDEP.">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2018-07-08T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2018-07-08T00:00:00&#43;00:00">
  

  

  

  <title>Reproducing iDEP analyses with auto-generated R Markdown | In Data We Trust</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" >

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/">In Data We Trust</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-right">
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>About</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <h1 itemprop="name">Reproducing iDEP analyses with auto-generated R Markdown</h1>

    

<div class="article-metadata">

  

  <span class="article-date">
    
    <meta content="2018-07-08 00:00:00 &#43;0000 UTC" itemprop="datePublished">
    <time datetime="2018-07-08 00:00:00 &#43;0000 UTC" itemprop="dateModified">
      Jul 8, 2018
    </time>
  </span>
  <span itemscope itemprop="author publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Steven Xijin Ge">
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    14 min read
  </span>
  

  
  
  <span class="middot-divider"></span>
  <a href="/post/reproducing-idep-analyses-with-auto-generated-r-markdown/#disqus_thread"></a>
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="/categories/r/">R</a
    >, 
    
    <a href="/categories/rna-seq/">RNA-Seq</a
    >, 
    
    <a href="/categories/bioinformatics/">Bioinformatics</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Reproducing%20iDEP%20analyses%20with%20auto-generated%20R%20Markdown&amp;url=%2fpost%2freproducing-idep-analyses-with-auto-generated-r-markdown%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2freproducing-idep-analyses-with-auto-generated-r-markdown%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2freproducing-idep-analyses-with-auto-generated-r-markdown%2f&amp;title=Reproducing%20iDEP%20analyses%20with%20auto-generated%20R%20Markdown"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2freproducing-idep-analyses-with-auto-generated-r-markdown%2f&amp;title=Reproducing%20iDEP%20analyses%20with%20auto-generated%20R%20Markdown"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Reproducing%20iDEP%20analyses%20with%20auto-generated%20R%20Markdown&amp;body=%2fpost%2freproducing-idep-analyses-with-auto-generated-r-markdown%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


    <div class="article-style" itemprop="articleBody">
      

<p><a href="http://bioinformatics.sdstate.edu/idep" target="_blank">iDEP</a> is a tool for interactive analysis of RNA-Seq data. After analyzing their data, users have the option to download a R Markdown file, toegether with other data files, to reproduce the entire workflow. This blog is both the easiest and hardest of all. It is easy because everything below was automatically generated by iDEP; it is hard as I have to write code to write code when developing iDEP.</p>

<h2 id="1-read-data">1. Read data</h2>

<p>R packages and iDEP core Functions.
    Users can also download the iDEP_core_functions.R file.
    Many R packages needs to be installed first. This may take hours.
    Each of these packages took years to develop.So be a patient thief. Sometimes dependencies needs to be installed manually.
    If you are using an older version of R, and having trouble with package installation,
    try un-install the current version of R, delete all folders and files, and  reinstall from scratch.</p>

<pre><code class="language-r"> if(file.exists('iDEP_core_functions.R'))
    source('iDEP_core_functions.R') else 
    source('https://raw.githubusercontent.com/iDEP-SDSU/idep/master/shinyapps/idep/iDEP_core_functions.R') 
</code></pre>

<p>We are using the downloaded gene expression file where gene IDs has
    been converted to Ensembl gene IDs. This is because the ID conversion database is too large
    to download. You can use your original file if your file uses Ensembl ID, or you do not want
    to use the pathway files available in iDEP (or it is not available).</p>

<pre><code class="language-r"> inputFile &lt;- 'C:/Users/Xijin.Ge/Downloads/Downloaded_Converted_Data.csv'  # Expression matrix
 sampleInfoFile &lt;- 'C:/Users/Xijin.Ge/Downloads/Downloaded_sampleInfoFile.csv' # Experiment design file 
 geneInfoFile &lt;- 'C:/Users/Xijin.Ge/Downloads/Mouse__mmusculus_gene_ensembl_GeneInfo.csv' #Gene symbols, location etc. 
 geneSetFile &lt;- 'C:/Users/Xijin.Ge/Downloads/Mouse__mmusculus_gene_ensembl.db'  # pathway database in SQL; can be GMT format 
 STRING10_speciesFile &lt;- 'https://raw.githubusercontent.com/iDEP-SDSU/idep/master/shinyapps/idep/STRING10_species.csv' 
</code></pre>

<p>Parameters for reading data</p>

<pre><code class="language-r"> input_missingValue &lt;- 'geneMedian' #Missing values imputation method
 input_dataFileFormat &lt;- 1  #1- read counts, 2 FKPM/RPKM or DNA microarray
 input_minCounts &lt;- 0.5 #Min counts
 input_NminSamples &lt;- 1 #Minimum number of samples 
 input_countsLogStart &lt;- 4  #Pseudo count for log CPM
 input_CountsTransform &lt;- 1 #Methods for data transformation of counts. 1-EdgeR's logCPM 2-VST, 3-rlog 
</code></pre>

<pre><code class="language-r"> readData.out &lt;- readData(inputFile) 
 library(knitr)   #  install if needed. for showing tables with kable 
 kable( head(readData.out$data) )    # show the first few rows of data 
</code></pre>

<table>
<thead>
<tr>
<th align="left"></th>
<th align="right">p53_mock_1</th>
<th align="right">p53_mock_2</th>
<th align="right">p53_mock_3</th>
<th align="right">p53_mock_4</th>
<th align="right">p53_IR_1</th>
<th align="right">p53_IR_2</th>
<th align="right">p53_IR_3</th>
<th align="right">p53_IR_4</th>
<th align="right">null_mock_1</th>
<th align="right">null_mock_2</th>
<th align="right">null_IR_1</th>
<th align="right">null_IR_2</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">ENSMUSG00000075014</td>
<td align="right">5.986190</td>
<td align="right">10.245204</td>
<td align="right">11.622005</td>
<td align="right">12.445437</td>
<td align="right">19.58986</td>
<td align="right">21.07925</td>
<td align="right">8.279954</td>
<td align="right">17.40506</td>
<td align="right">13.23741</td>
<td align="right">12.91427</td>
<td align="right">6.949322</td>
<td align="right">14.57512</td>
</tr>

<tr>
<td align="left">ENSMUSG00000076617</td>
<td align="right">18.174331</td>
<td align="right">18.020764</td>
<td align="right">17.901045</td>
<td align="right">16.892389</td>
<td align="right">18.06544</td>
<td align="right">18.52019</td>
<td align="right">16.933927</td>
<td align="right">17.68636</td>
<td align="right">17.18909</td>
<td align="right">17.39665</td>
<td align="right">17.663020</td>
<td align="right">17.21374</td>
</tr>

<tr>
<td align="left">ENSMUSG00000015656</td>
<td align="right">15.349228</td>
<td align="right">15.086274</td>
<td align="right">15.392536</td>
<td align="right">14.817324</td>
<td align="right">15.95674</td>
<td align="right">15.75896</td>
<td align="right">16.233039</td>
<td align="right">16.04712</td>
<td align="right">15.03582</td>
<td align="right">14.98886</td>
<td align="right">18.603855</td>
<td align="right">17.00075</td>
</tr>

<tr>
<td align="left">ENSMUSG00000052305</td>
<td align="right">13.766147</td>
<td align="right">11.436670</td>
<td align="right">10.523028</td>
<td align="right">15.927563</td>
<td align="right">10.57175</td>
<td align="right">11.22625</td>
<td align="right">10.125088</td>
<td align="right">10.20851</td>
<td align="right">11.81668</td>
<td align="right">17.59129</td>
<td align="right">10.311098</td>
<td align="right">15.82093</td>
</tr>

<tr>
<td align="left">ENSMUSG00000069917</td>
<td align="right">13.511114</td>
<td align="right">11.202619</td>
<td align="right">10.240337</td>
<td align="right">15.915347</td>
<td align="right">10.33765</td>
<td align="right">11.20676</td>
<td align="right">10.280270</td>
<td align="right">10.32910</td>
<td align="right">11.51218</td>
<td align="right">17.41403</td>
<td align="right">10.236792</td>
<td align="right">15.73450</td>
</tr>

<tr>
<td align="left">ENSMUSG00000075015</td>
<td align="right">4.023733</td>
<td align="right">7.791965</td>
<td align="right">9.161421</td>
<td align="right">9.809036</td>
<td align="right">16.98655</td>
<td align="right">18.47457</td>
<td align="right">5.767006</td>
<td align="right">14.96939</td>
<td align="right">10.59269</td>
<td align="right">10.25800</td>
<td align="right">4.742948</td>
<td align="right">12.00540</td>
</tr>
</tbody>
</table>

<pre><code class="language-r"> readSampleInfo.out &lt;- readSampleInfo(sampleInfoFile) 
 kable( readSampleInfo.out )  
</code></pre>

<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">p53</th>
<th align="left">Treatment</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">p53_mock_1</td>
<td align="left">wt</td>
<td align="left">mock</td>
</tr>

<tr>
<td align="left">p53_mock_2</td>
<td align="left">wt</td>
<td align="left">mock</td>
</tr>

<tr>
<td align="left">p53_mock_3</td>
<td align="left">wt</td>
<td align="left">mock</td>
</tr>

<tr>
<td align="left">p53_mock_4</td>
<td align="left">wt</td>
<td align="left">mock</td>
</tr>

<tr>
<td align="left">p53_IR_1</td>
<td align="left">wt</td>
<td align="left">IR</td>
</tr>

<tr>
<td align="left">p53_IR_2</td>
<td align="left">wt</td>
<td align="left">IR</td>
</tr>

<tr>
<td align="left">p53_IR_3</td>
<td align="left">wt</td>
<td align="left">IR</td>
</tr>

<tr>
<td align="left">p53_IR_4</td>
<td align="left">wt</td>
<td align="left">IR</td>
</tr>

<tr>
<td align="left">null_mock_1</td>
<td align="left">null</td>
<td align="left">mock</td>
</tr>

<tr>
<td align="left">null_mock_2</td>
<td align="left">null</td>
<td align="left">mock</td>
</tr>

<tr>
<td align="left">null_IR_1</td>
<td align="left">null</td>
<td align="left">IR</td>
</tr>

<tr>
<td align="left">null_IR_2</td>
<td align="left">null</td>
<td align="left">IR</td>
</tr>
</tbody>
</table>

<pre><code class="language-r"> input_selectOrg =&quot;NEW&quot; 
 input_selectGO &lt;- 'KEGG'   #Gene set category 
 input_noIDConversion = TRUE  
 allGeneInfo.out &lt;- geneInfo(geneInfoFile) 
 converted.out = NULL 
 convertedData.out &lt;- convertedData()    
 nGenesFilter()  
</code></pre>

<pre><code>## [1] &quot;6882 genes in 12 samples. 6882  genes passed filter.\n Original gene IDs used.&quot;
</code></pre>

<pre><code class="language-r"> convertedCounts.out &lt;- convertedCounts()  # converted counts, just for compatibility 
 readCountsBias()  # detecting bias in sequencing depth 
</code></pre>

<pre><code>## [1] &quot;Warning! Sequencing depth bias detected. Total read counts are significantly different among sample groups (p= 1.04e-02 ) based on ANOVA.&quot;
</code></pre>

<h2 id="2-pre-process">2. Pre-process</h2>

<pre><code class="language-r"># Read counts per library 
 parDefault = par() 
 par(mar=c(12,4,2,2)) 
 # barplot of total read counts
 x &lt;- readData.out$rawCounts
 groups = as.factor( detectGroups(colnames(x ) ) )
 if(nlevels(groups)&lt;=1 | nlevels(groups) &gt;20 )  
  col1 = 'green'  else
  col1 = rainbow(nlevels(groups))[ groups ]             
         
 barplot( colSums(x)/1e6, 
        col=col1,las=3, main=&quot;Total read counts (millions)&quot;)  
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>

<pre><code class="language-r"> # Box plot 
 x = readData.out$data 
 boxplot(x, las = 2, col=col1,
    ylab='Transformed expression levels',
    main='Distribution of transformed data') 
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>

<pre><code class="language-r"> #Density plot 
 par(parDefault) 
 densityPlot()       
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>

<pre><code class="language-r"> # Scatter plot of the first two samples 
 plot(x[,1:2],xlab=colnames(x)[1],ylab=colnames(x)[2], 
    main='Scatter plot of first two samples') 
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>

<pre><code class="language-r"> ####plot gene or gene family
 input_selectOrg =&quot;BestMatch&quot; 
 input_geneSearch &lt;- 'HOXA' #Gene ID for searching 
 genePlot()  
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>

<pre><code class="language-r"> input_useSD &lt;- 'FALSE' #Use standard deviation instead of standard error in error bar? 
 geneBarPlotError()       
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>

<h2 id="3-heatmap">3. Heatmap</h2>

<pre><code class="language-r"> # hierarchical clustering tree
 x &lt;- readData.out$data
 maxGene &lt;- apply(x,1,max)
 # remove bottom 25% lowly expressed genes, which inflate the PPC
 x &lt;- x[which(maxGene &gt; quantile(maxGene)[1] ) ,] 
 plot(as.dendrogram(hclust2( dist2(t(x)))), ylab=&quot;1 - Pearson C.C.&quot;, type = &quot;rectangle&quot;) 
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>

<pre><code class="language-r"> #Correlation matrix
 input_labelPCC &lt;- TRUE #Show correlation coefficient? 
 correlationMatrix() 
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>

<pre><code class="language-r"> # Parameters for heatmap
 input_nGenes &lt;- 1000   #Top genes for heatmap
 input_geneCentering &lt;- TRUE    #centering genes ?
 input_sampleCentering &lt;- FALSE #Center by sample?
 input_geneNormalize &lt;- FALSE   #Normalize by gene?
 input_sampleNormalize &lt;- FALSE #Normalize by sample?
 input_noSampleClustering &lt;- FALSE  #Use original sample order
 input_heatmapCutoff &lt;- 4   #Remove outliers beyond number of SDs 
 input_distFunctions &lt;- 1   #which distant funciton to use
 input_hclustFunctions &lt;- 1 #Linkage type
 input_heatColors1 &lt;- 1 #Colors
 input_selectFactorsHeatmap &lt;- 'Sample_Name'    #Sample coloring factors 
 #png('heatmap.png', width = 10, height = 15, units = 'in', res = 300) 
 #staticHeatmap() 
 #dev.off()  
</code></pre>

<p><img src="/img/heatmap.png" alt="heatmap" /></p>

<pre><code class="language-r"># heatmapPlotly() # interactive heatmap using Plotly 
</code></pre>

<h2 id="4-k-means-clustering">4. K-means clustering</h2>

<pre><code class="language-r"> input_nGenesKNN &lt;- 2000    #Number of genes fro k-Means
 input_nClusters &lt;- 4   #Number of clusters 
 maxGeneClustering = 12000
 input_kmeansNormalization &lt;- 'geneMean'    #Normalization
 input_KmeansReRun &lt;- 0 #Random seed 

 distributionSD()  #Distribution of standard deviations 
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>

<pre><code class="language-r"> KmeansNclusters()  #Number of clusters 
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>

<pre><code class="language-r"> Kmeans.out = Kmeans()   #Running K-means 
 KmeansHeatmap()   #Heatmap for k-Means 
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>

<pre><code class="language-r"> #Read gene sets for enrichment analysis 
 sqlite  &lt;- dbDriver('SQLite')
 input_selectGO3 &lt;- 'GOBP'  #Gene set category
 input_minSetSize &lt;- 15 #Min gene set size
 input_maxSetSize &lt;- 2000   #Max gene set size 
 GeneSets.out &lt;-readGeneSets( geneSetFile,
    convertedData.out, input_selectGO3,input_selectOrg,
    c(input_minSetSize, input_maxSetSize)  )  
 # Alternatively, users can use their own GMT files by
 #GeneSets.out &lt;- readGMTRobust('somefile.GMT')  
 results &lt;- KmeansGO()  #Enrichment analysis for k-Means clusters   
 results$adj.Pval &lt;- format( results$adj.Pval,digits=3 )
 kable( results, row.names=FALSE) 
</code></pre>

<table>
<thead>
<tr>
<th align="left">Cluster</th>
<th align="left">adj.Pval</th>
<th align="left">Genes</th>
<th align="left">Pathways</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">A</td>
<td align="left">2.69e-144</td>
<td align="left">121</td>
<td align="left">RNA processing</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">1.99e-140</td>
<td align="left">106</td>
<td align="left">Ribonucleoprotein complex biogenesis</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">2.29e-134</td>
<td align="left">103</td>
<td align="left">NcRNA metabolic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">3.50e-117</td>
<td align="left">84</td>
<td align="left">Ribosome biogenesis</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">6.34e-115</td>
<td align="left">84</td>
<td align="left">NcRNA processing</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">3.48e-107</td>
<td align="left">144</td>
<td align="left">Organonitrogen compound metabolic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">1.71e-101</td>
<td align="left">119</td>
<td align="left">Organonitrogen compound biosynthetic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">6.86e-93</td>
<td align="left">65</td>
<td align="left">RRNA processing</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">2.89e-92</td>
<td align="left">65</td>
<td align="left">RRNA metabolic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">5.05e-75</td>
<td align="left">74</td>
<td align="left">Translation</td>
</tr>

<tr>
<td align="left">B</td>
<td align="left">2.08e-25</td>
<td align="left">36</td>
<td align="left">Cellular response to stress</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">4.56e-23</td>
<td align="left">36</td>
<td align="left">Apoptotic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">4.56e-23</td>
<td align="left">37</td>
<td align="left">Cell death</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">5.85e-23</td>
<td align="left">36</td>
<td align="left">Programmed cell death</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">5.85e-23</td>
<td align="left">25</td>
<td align="left">Apoptotic signaling pathway</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">1.23e-20</td>
<td align="left">24</td>
<td align="left">Positive regulation of cell death</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">1.44e-20</td>
<td align="left">23</td>
<td align="left">Cellular response to DNA damage stimulus</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">3.58e-19</td>
<td align="left">18</td>
<td align="left">Intrinsic apoptotic signaling pathway</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">1.01e-18</td>
<td align="left">22</td>
<td align="left">Positive regulation of programmed cell death</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">1.18e-18</td>
<td align="left">14</td>
<td align="left">Intrinsic apoptotic signaling pathway in response to DNA damage</td>
</tr>

<tr>
<td align="left">C</td>
<td align="left">2.39e-63</td>
<td align="left">115</td>
<td align="left">Immune system process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">8.23e-45</td>
<td align="left">86</td>
<td align="left">Positive regulation of response to stimulus</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">1.18e-44</td>
<td align="left">76</td>
<td align="left">Immune response</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">1.51e-42</td>
<td align="left">81</td>
<td align="left">Establishment of protein localization</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">7.23e-42</td>
<td align="left">76</td>
<td align="left">Macromolecular complex assembly</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">2.29e-40</td>
<td align="left">69</td>
<td align="left">Regulation of immune system process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">2.29e-40</td>
<td align="left">69</td>
<td align="left">Protein complex assembly</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">2.29e-40</td>
<td align="left">75</td>
<td align="left">Protein transport</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">2.29e-40</td>
<td align="left">69</td>
<td align="left">Protein complex biogenesis</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">2.29e-40</td>
<td align="left">72</td>
<td align="left">Protein complex subunit organization</td>
</tr>

<tr>
<td align="left">D</td>
<td align="left">9.62e-94</td>
<td align="left">147</td>
<td align="left">Immune system process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">6.16e-55</td>
<td align="left">99</td>
<td align="left">Positive regulation of response to stimulus</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">5.38e-52</td>
<td align="left">93</td>
<td align="left">Positive regulation of molecular function</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">6.50e-52</td>
<td align="left">93</td>
<td align="left">Protein phosphorylation</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">1.86e-51</td>
<td align="left">84</td>
<td align="left">Defense response</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">7.25e-51</td>
<td align="left">86</td>
<td align="left">Regulation of intracellular signal transduction</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">1.02e-49</td>
<td align="left">72</td>
<td align="left">Cell activation</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">2.24e-47</td>
<td align="left">88</td>
<td align="left">Regulation of transport</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">1.00e-46</td>
<td align="left">95</td>
<td align="left">Response to external stimulus</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">5.13e-46</td>
<td align="left">73</td>
<td align="left">Vesicle-mediated transport</td>
</tr>
</tbody>
</table>

<pre><code class="language-r"> input_seedTSNE &lt;- 0    #Random seed for t-SNE
 input_colorGenes &lt;- TRUE   #Color genes in t-SNE plot? 
 tSNEgenePlot()  #Plot genes using t-SNE 
</code></pre>

<pre><code>## Warning: package 'Rtsne' was built under R version 3.5.1
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>

<h2 id="5-pca-and-beyond">5. PCA and beyond</h2>

<pre><code class="language-r"> input_selectFactors &lt;- 'Sample_Name'   #Factor coded by color
 input_selectFactors2 &lt;- 'Sample_Name'  #Factor coded by shape
 input_tsneSeed2 &lt;- 0   #Random seed for t-SNE 
 #PCA, MDS and t-SNE plots
 PCAplot()  
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>

<pre><code class="language-r"> MDSplot() 
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>

<pre><code class="language-r"> tSNEplot()  
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>

<pre><code class="language-r"> #Read gene sets for pathway analysis using PGSEA on principal components 
 input_selectGO6 &lt;- 'GOBP' 
 GeneSets.out &lt;-readGeneSets( geneSetFile,
    convertedData.out, input_selectGO6,input_selectOrg,
    c(input_minSetSize, input_maxSetSize)  )  
 PCApathway() # Run PGSEA analysis 
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>

<pre><code class="language-r"> cat( PCA2factor() )   #The correlation between PCs with factors 
</code></pre>

<pre><code>## 
##  Correlation between Principal Components (PCs) with factors
## PC1 is correlated with Treatment (p=6.56e-05).
</code></pre>

<h2 id="6-differentially-expressed-genes-deg1">6. Differentially Expressed Genes (DEG1)</h2>

<pre><code class="language-r"> input_CountsDEGMethod &lt;- 3 #DESeq2= 3,limma-voom=2,limma-trend=1 
 input_limmaPval &lt;- 0.1 #FDR cutoff
 input_limmaFC &lt;- 2 #Fold-change cutoff
 input_selectModelComprions &lt;- c('p53: wt vs. null','Treatment: IR vs. mock')   #Selected comparisons
 input_selectFactorsModel &lt;- c('p53','Treatment')   #Selected comparisons
 input_selectInteractions &lt;- 'p53:Treatment'    #Selected comparisons
 input_selectBlockFactorsModel &lt;- NULL  #Selected comparisons
 factorReferenceLevels.out &lt;- c('p53:null','Treatment:mock') 

 limma.out &lt;- limma()
 DEG.data.out &lt;- DEG.data()
 limma.out$comparisons 
</code></pre>

<pre><code>## [1] &quot;wt-null&quot;               &quot;IR-mock&quot;               &quot;I:p53_wt.Treatment_IR&quot;
## [4] &quot;wt-null_for_IR&quot;        &quot;IR-mock_for_wt&quot;
</code></pre>

<pre><code class="language-r"> input_selectComparisonsVenn = limma.out$comparisons[1:3] # use first three comparisons
 input_UpDownRegulated &lt;- FALSE #Split up and down regulated genes 
 vennPlot() # Venn diagram 
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>

<pre><code class="language-r">  sigGeneStats() # number of DEGs as figure 
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>

<pre><code class="language-r">  sigGeneStatsTable() # number of DEGs as table 
</code></pre>

<pre><code>##                                 Comparisons   Up Down
## wt-null                             wt-null   20   16
## IR-mock                             IR-mock 1532  702
## I:p53_wt-Treatment_IR I:p53_wt-Treatment_IR  694  478
## wt-null_for_IR               wt-null_for_IR 1118  577
## IR-mock_for_wt               IR-mock_for_wt 1856  487
</code></pre>

<h2 id="7-differentially-expressed-genes-deg1">7. Differentially Expressed Genes (DEG1)</h2>

<pre><code class="language-r"> input_selectContrast &lt;- 'I:p53_wt.Treatment_IR'    #Selected comparisons 
 selectedHeatmap.data.out &lt;- selectedHeatmap.data()
 selectedHeatmap()   # heatmap for DEGs in selected comparison
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>

<pre><code class="language-r"> # Save gene lists and data into files
 write.csv( selectedHeatmap.data()$genes, 'heatmap.data.csv') 
 write.csv(DEG.data(),'DEG.data.csv' )
 write(AllGeneListsGMT() ,'AllGeneListsGMT.gmt')
</code></pre>

<pre><code class="language-r"> input_selectGO2 &lt;- 'GSKB.TF.Target'    #Gene set category 
 geneListData.out &lt;- geneListData()  
 volcanoPlot()  
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>

<pre><code class="language-r">scatterPlot()  
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>

<pre><code class="language-r">  MAplot()  
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>

<pre><code class="language-r">  geneListGOTable.out &lt;- geneListGOTable()  
 # Read pathway data again 
 GeneSets.out &lt;-readGeneSets( geneSetFile,
    convertedData.out, input_selectGO2,input_selectOrg,
    c(input_minSetSize, input_maxSetSize)  ) 
 input_removeRedudantSets &lt;- TRUE   #Remove highly redundant gene sets? 
 results &lt;- geneListGO()  #Enrichment analysis for k-Means clusters 
 results$adj.Pval &lt;- format( results$adj.Pval,digits=3 )
 kable( results, row.names=FALSE) 
</code></pre>

<table>
<thead>
<tr>
<th align="left">Direction</th>
<th align="left">adj.Pval</th>
<th align="right">nGenes</th>
<th align="left">Pathways</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">Down regulated</td>
<td align="left">3.3e-61</td>
<td align="right">95</td>
<td align="left">Organonitrogen compound metabolic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">4.8e-53</td>
<td align="right">84</td>
<td align="left">Small molecule metabolic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">1.2e-51</td>
<td align="right">75</td>
<td align="left">Cell cycle</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">1.4e-48</td>
<td align="right">62</td>
<td align="left">DNA metabolic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">3.4e-45</td>
<td align="right">67</td>
<td align="left">Organonitrogen compound biosynthetic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">6.7e-45</td>
<td align="right">61</td>
<td align="left">Cell cycle process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">7.2e-43</td>
<td align="right">71</td>
<td align="left">Macromolecular complex assembly</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">2.5e-40</td>
<td align="right">68</td>
<td align="left">Cellular response to stress</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">3.0e-40</td>
<td align="right">52</td>
<td align="left">Mitotic cell cycle</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">7.6e-39</td>
<td align="right">49</td>
<td align="left">Mitotic cell cycle process</td>
</tr>

<tr>
<td align="left">Up regulated</td>
<td align="left">6.0e-41</td>
<td align="right">82</td>
<td align="left">Tissue development</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">6.8e-39</td>
<td align="right">79</td>
<td align="left">Regulation of transcription from RNA polymerase II promoter</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">6.8e-39</td>
<td align="right">80</td>
<td align="left">Transcription from RNA polymerase II promoter</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">6.8e-39</td>
<td align="right">85</td>
<td align="left">Apoptotic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">6.8e-39</td>
<td align="right">84</td>
<td align="left">Cell development</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">1.5e-38</td>
<td align="right">85</td>
<td align="left">Programmed cell death</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">7.7e-38</td>
<td align="right">86</td>
<td align="left">Cell death</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">2.1e-37</td>
<td align="right">78</td>
<td align="left">Positive regulation of nitrogen compound metabolic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">5.5e-36</td>
<td align="right">74</td>
<td align="left">Positive regulation of nucleobase-containing compound metabolic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">1.3e-35</td>
<td align="right">86</td>
<td align="left">Cellular response to organic substance</td>
</tr>
</tbody>
</table>

<p>STRING-db API access.
    We need to find the taxonomy id of your species, this used by STRING.
  First we try to guess the ID based on iDEP&rsquo;s database. Users can also skip this step and assign NCBI taxonomy id directly by
  findTaxonomyID.out = 10090 # mouse 10090, human 9606 etc.</p>

<pre><code class="language-r"> STRING10_species = read.csv(STRING10_speciesFile)  
 ix = grep('Mus musculus', STRING10_species$official_name )
 findTaxonomyID.out &lt;- STRING10_species[ix,1] # find taxonomyID
 findTaxonomyID.out  
</code></pre>

<pre><code>## [1] 10090
</code></pre>

<p>Enrichment analysis using STRING</p>

<pre><code class="language-r">  STRINGdb_geneList.out &lt;- STRINGdb_geneList() #convert gene lists
</code></pre>

<pre><code>## Warning:  we couldn't map to STRING 8% of your identifiers
</code></pre>

<pre><code class="language-r"> input_STRINGdbGO &lt;- 'Process'  #'Process', 'Component', 'Function', 'KEGG', 'Pfam', 'InterPro' 
 results &lt;- stringDB_GO_enrichmentData()  # enrichment using STRING 
 results$adj.Pval &lt;- format( results$adj.Pval,digits=3 )
 kable( results, row.names=FALSE) 
</code></pre>

<table>
<thead>
<tr>
<th align="left">Direction</th>
<th align="left">adj.Pval</th>
<th align="right">nGenes</th>
<th align="left">Pathways</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">Up regulated</td>
<td align="left">4.5e-11</td>
<td align="right">66</td>
<td align="left">intracellular signal transduction</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">2.6e-10</td>
<td align="right">51</td>
<td align="left">apoptotic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">4.5e-10</td>
<td align="right">51</td>
<td align="left">programmed cell death</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">9.8e-10</td>
<td align="right">51</td>
<td align="left">cell death</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">9.8e-10</td>
<td align="right">51</td>
<td align="left">death</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">2.2e-09</td>
<td align="right">71</td>
<td align="left">tissue development</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">4.1e-09</td>
<td align="right">26</td>
<td align="left">apoptotic signaling pathway</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">5.2e-09</td>
<td align="right">20</td>
<td align="left">intrinsic apoptotic signaling pathway</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">9.7e-09</td>
<td align="right">15</td>
<td align="left">intrinsic apoptotic signaling pathway in response to DNA damage</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">1.7e-08</td>
<td align="right">58</td>
<td align="left">regulation of apoptotic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">3.2e-08</td>
<td align="right">65</td>
<td align="left">cell development</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">3.7e-08</td>
<td align="right">62</td>
<td align="left">positive regulation of molecular function</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">5.2e-08</td>
<td align="right">47</td>
<td align="left">negative regulation of signal transduction</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">5.2e-08</td>
<td align="right">62</td>
<td align="left">cell surface receptor signaling pathway</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">5.2e-08</td>
<td align="right">57</td>
<td align="left">regulation of programmed cell death</td>
</tr>

<tr>
<td align="left">Down regulated</td>
<td align="left">2.2e-15</td>
<td align="right">60</td>
<td align="left">cell cycle</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">5.2e-15</td>
<td align="right">25</td>
<td align="left">protein folding</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">3.1e-14</td>
<td align="right">65</td>
<td align="left">small molecule metabolic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">3.1e-14</td>
<td align="right">33</td>
<td align="left">small molecule biosynthetic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">1.1e-13</td>
<td align="right">53</td>
<td align="left">single-organism biosynthetic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">3.4e-13</td>
<td align="right">61</td>
<td align="left">organonitrogen compound metabolic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">5.2e-13</td>
<td align="right">46</td>
<td align="left">organonitrogen compound biosynthetic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">2.4e-12</td>
<td align="right">38</td>
<td align="left">mitotic cell cycle</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">2.4e-12</td>
<td align="right">46</td>
<td align="left">cell cycle process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">3.1e-12</td>
<td align="right">37</td>
<td align="left">mitotic cell cycle process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">7.6e-12</td>
<td align="right">30</td>
<td align="left">ncRNA metabolic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">2.8e-11</td>
<td align="right">24</td>
<td align="left">organic acid biosynthetic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">2.8e-11</td>
<td align="right">24</td>
<td align="left">carboxylic acid biosynthetic process</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">5.0e-11</td>
<td align="right">33</td>
<td align="left">cell division</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">8.6e-11</td>
<td align="right">37</td>
<td align="left">DNA metabolic process</td>
</tr>
</tbody>
</table>

<p>PPI network retrieval and analysis</p>

<pre><code class="language-r"> input_nGenesPPI &lt;- 100 #Number of top genes for PPI retrieval and analysis 
 stringDB_network1(1) #Show PPI network 
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-38-1.png" width="672" />
Generating interactive PPI</p>

<pre><code class="language-r"> write(stringDB_network_link(), 'PPI_results.html') # write results to html file 
</code></pre>

<pre><code>## Warning:  we couldn't map to STRING 8% of your identifiers
</code></pre>

<pre><code class="language-r"> browseURL('PPI_results.html') # open in browser 
</code></pre>

<h2 id="8-pathway-analysis">8. Pathway analysis</h2>

<pre><code class="language-r"> input_selectContrast1 &lt;- 'I:p53_wt.Treatment_IR'   #select Comparison 
 #input_selectContrast1 = limma.out$comparisons[3] # manually set
 input_selectGO &lt;- 'KEGG'   #Gene set category 
 #input_selectGO='custom' # if custom gmt file
 input_minSetSize &lt;- 15 #Min size for gene set
 input_maxSetSize &lt;- 2000   #Max size for gene set 
 # Read pathway data again 
 GeneSets.out &lt;-readGeneSets( geneSetFile,
    convertedData.out, input_selectGO,input_selectOrg,
    c(input_minSetSize, input_maxSetSize)  ) 
 input_pathwayPvalCutoff &lt;- 0.2 #FDR cutoff
 input_nPathwayShow &lt;- 30   #Top pathways to show
 input_absoluteFold &lt;- FALSE    #Use absolute values of fold-change?
 input_GenePvalCutoff &lt;- 1  #FDR to remove genes 

 input_pathwayMethod = 1  # 1  GAGE
 gagePathwayData.out &lt;- gagePathwayData()  # pathway analysis using GAGE  
   
 results &lt;- gagePathwayData.out  #Enrichment analysis for k-Means clusters  
 results$adj.Pval &lt;- format( results$adj.Pval,digits=3 )
 kable( results, row.names=FALSE) 
</code></pre>

<table>
<thead>
<tr>
<th align="left">Direction</th>
<th align="left">GAGE  analysis: I:p53_wt.Treatment_IR</th>
<th align="left">statistic</th>
<th align="right">Genes</th>
<th align="left">adj.Pval</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">Down</td>
<td align="left">Ribosome biogenesis in eukaryotes</td>
<td align="left">-4.6634</td>
<td align="right">40</td>
<td align="left">2.3e-03</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">RNA transport</td>
<td align="left">-4.2098</td>
<td align="right">62</td>
<td align="left">2.9e-03</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">Spliceosome</td>
<td align="left">-4.0557</td>
<td align="right">39</td>
<td align="left">4.5e-03</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">Protein processing in endoplasmic reticulum</td>
<td align="left">-3.9119</td>
<td align="right">54</td>
<td align="left">4.5e-03</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">Metabolic pathways</td>
<td align="left">-3.7276</td>
<td align="right">449</td>
<td align="left">4.5e-03</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">DNA replication</td>
<td align="left">-3.4728</td>
<td align="right">20</td>
<td align="left">3.5e-02</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">Proteasome</td>
<td align="left">-3.221</td>
<td align="right">23</td>
<td align="left">4.1e-02</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">Aminoacyl-tRNA biosynthesis</td>
<td align="left">-3.2197</td>
<td align="right">17</td>
<td align="left">5.0e-02</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">Pyrimidine metabolism</td>
<td align="left">-3.1178</td>
<td align="right">50</td>
<td align="left">4.0e-02</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">Biosynthesis of amino acids</td>
<td align="left">-3.1022</td>
<td align="right">32</td>
<td align="left">4.1e-02</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">Carbon metabolism</td>
<td align="left">-2.9154</td>
<td align="right">47</td>
<td align="left">5.0e-02</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">Oxidative phosphorylation</td>
<td align="left">-2.5729</td>
<td align="right">46</td>
<td align="left">1.1e-01</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">Ribosome</td>
<td align="left">-2.5555</td>
<td align="right">28</td>
<td align="left">1.2e-01</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">Oocyte meiosis</td>
<td align="left">-2.5519</td>
<td align="right">39</td>
<td align="left">1.1e-01</td>
</tr>

<tr>
<td align="left"></td>
<td align="left">Progesterone-mediated oocyte maturation</td>
<td align="left">-2.2879</td>
<td align="right">27</td>
<td align="left">2.0e-01</td>
</tr>
</tbody>
</table>

<pre><code class="language-r"> pathwayListData.out = pathwayListData() 
 enrichmentPlot(pathwayListData.out, 25  ) 
</code></pre>

<pre><code>## Warning: package 'dendextend' was built under R version 3.5.1
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>

<pre><code class="language-r">  enrichmentNetwork(pathwayListData.out )  
</code></pre>

<pre><code>## Warning: package 'igraph' was built under R version 3.5.1
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>

<pre><code class="language-r">#  enrichmentNetworkPlotly(pathwayListData.out) 
</code></pre>

<pre><code class="language-r"> input_pathwayMethod = 3  # 1  fgsea 
 fgseaPathwayData.out &lt;- fgseaPathwayData() #Pathway analysis using fgsea 
 results &lt;- fgseaPathwayData.out  #Enrichment analysis for k-Means clusters 
 results$adj.Pval &lt;- format( results$adj.Pval,digits=3 )
 kable( results, row.names=FALSE) 
</code></pre>

<pre><code class="language-r">  pathwayListData.out = pathwayListData() 
 enrichmentPlot(pathwayListData.out, 25  ) 
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>

<pre><code class="language-r">  enrichmentNetwork(pathwayListData.out )  
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>

<pre><code class="language-r">#  enrichmentNetworkPlotly(pathwayListData.out) 
</code></pre>

<pre><code class="language-r">   PGSEAplot() # pathway analysis using PGSEA 
</code></pre>

<pre><code>## 
## Computing P values using ANOVA
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-48-1.png" width="864" /></p>

<h2 id="9-chromosome">9. Chromosome</h2>

<pre><code class="language-r"> input_selectContrast2 &lt;- 'IR-mock_for_wt'  #select Comparison 
 #input_selectContrast2 = limma.out$comparisons[3] # manually set
 input_limmaPvalViz &lt;- 0.1  #FDR to filter genes
 input_limmaFCViz &lt;- 2  #FDR to filter genes 
# genomePlotly() # shows fold-changes on the genome 
</code></pre>

<p><img src="/img/genome.jpg" alt="" /></p>

<h2 id="10-biclustering">10. Biclustering</h2>

<pre><code class="language-r"> input_nGenesBiclust &lt;- 1000    #Top genes for biclustering
 input_biclustMethod &lt;- 'BCCC()'    #Method: 'BCCC', 'QUBIC', 'runibic' ... 
 biclustering.out = biclustering()  # run analysis
</code></pre>

<pre><code>## Warning: package 'biclust' was built under R version 3.5.1
</code></pre>

<pre><code class="language-r"> input_selectBicluster &lt;- 1 #select a cluster 
 biclustHeatmap()   # heatmap for selected cluster 
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>

<pre><code class="language-r"> input_selectGO4 &lt;- 'GOBP'  #Gene set category 
 # Read pathway data again 
 GeneSets.out &lt;-readGeneSets( geneSetFile,
    convertedData.out, input_selectGO4,input_selectOrg,
    c(input_minSetSize, input_maxSetSize)  )  
 results &lt;- geneListBclustGO()  #Enrichment analysis for k-Means clusters   
 results$adj.Pval &lt;- format( results$adj.Pval,digits=3 )
 kable( results, row.names=FALSE) 
</code></pre>

<table>
<thead>
<tr>
<th align="left">adj.Pval</th>
<th align="right">Genes</th>
<th align="left">Pathways</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">3.1e-124</td>
<td align="right">207</td>
<td align="left">Immune system process</td>
</tr>

<tr>
<td align="left">1.5e-89</td>
<td align="right">157</td>
<td align="left">Organonitrogen compound metabolic process</td>
</tr>

<tr>
<td align="left">4.7e-86</td>
<td align="right">148</td>
<td align="left">Positive regulation of molecular function</td>
</tr>

<tr>
<td align="left">5.4e-86</td>
<td align="right">155</td>
<td align="left">Cell death</td>
</tr>

<tr>
<td align="left">2.0e-83</td>
<td align="right">139</td>
<td align="left">Homeostatic process</td>
</tr>

<tr>
<td align="left">3.2e-81</td>
<td align="right">136</td>
<td align="left">Macromolecular complex assembly</td>
</tr>

<tr>
<td align="left">3.5e-80</td>
<td align="right">146</td>
<td align="left">Programmed cell death</td>
</tr>

<tr>
<td align="left">2.9e-79</td>
<td align="right">144</td>
<td align="left">Apoptotic process</td>
</tr>

<tr>
<td align="left">1.1e-75</td>
<td align="right">132</td>
<td align="left">Regulation of cell death</td>
</tr>

<tr>
<td align="left">2.2e-75</td>
<td align="right">117</td>
<td align="left">Cell-cell adhesion</td>
</tr>
</tbody>
</table>

<h2 id="11-co-expression-network">11. Co-expression network</h2>

<pre><code class="language-r"> input_mySoftPower &lt;- 5 #SoftPower to cutoff
 input_nGenesNetwork &lt;- 1000    #Number of top genes
 input_minModuleSize &lt;- 20  #Module size minimum 
 wgcna.out = wgcna()   # run WGCNA  
</code></pre>

<pre><code>## Warning: package 'WGCNA' was built under R version 3.5.1
</code></pre>

<pre><code>## ==========================================================================
## *
## *  Package WGCNA 1.63 loaded.
## *
## *    Important note: It appears that your system supports multi-threading,
## *    but it is not enabled within WGCNA in R. 
## *    To allow multi-threading within WGCNA with all available cores, use 
## *
## *          allowWGCNAThreads()
## *
## *    within R. Use disableWGCNAThreads() to disable threading if necessary.
## *    Alternatively, set the following environment variable on your system:
## *
## *          ALLOW_WGCNA_THREADS=&lt;number_of_processors&gt;
## *
## *    for example 
## *
## *          ALLOW_WGCNA_THREADS=8
## *
## *    To set the environment variable in linux bash shell, type 
## *
## *           export ALLOW_WGCNA_THREADS=8
## *
## *     before running R. Other operating systems or shells will
## *     have a similar command to achieve the same aim.
## *
## ==========================================================================
</code></pre>

<pre><code>## Warning: executing %dopar% sequentially: no parallel backend registered
</code></pre>

<pre><code>##    Power SFT.R.sq   slope truncated.R.sq mean.k. median.k. max.k.
## 1      1   0.9720  2.7600          0.966   572.0     612.0    711
## 2      2   0.9490  1.2200          0.956   412.0     449.0    578
## 3      3   0.9050  0.7070          0.923   325.0     353.0    495
## 4      4   0.7480  0.4190          0.797   269.0     287.0    439
## 5      5   0.5350  0.2490          0.615   230.0     239.0    398
## 6      6   0.1820  0.1090          0.255   200.0     204.0    367
## 7      7   0.0040  0.0131          0.185   178.0     175.0    342
## 8      8   0.0965 -0.0738          0.144   160.0     152.0    321
## 9      9   0.2500 -0.1240          0.238   145.0     133.0    303
## 10    10   0.4570 -0.1930          0.431   132.0     118.0    287
## 11    12   0.5670 -0.2940          0.514   113.0      98.9    263
## 12    14   0.6340 -0.3830          0.587    97.8      84.7    243
## 13    16   0.6890 -0.4420          0.655    86.2      73.5    227
## 14    18   0.7120 -0.4930          0.673    76.9      63.8    213
## 15    20   0.7290 -0.5420          0.683    69.3      55.7    201
## TOM calculation: adjacency..
## ..will not use multithreading.
##  Fraction of slow calculations: 0.000000
## ..connectivity..
## ..matrix multiplication (system BLAS)..
## ..normalization..
## ..done.
</code></pre>

<pre><code class="language-r"> softPower()  # soft power curve 
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>

<pre><code class="language-r">  modulePlot()  # plot modules  
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>

<pre><code class="language-r">  listWGCNA.Modules.out = listWGCNA.Modules() #modules
</code></pre>

<pre><code class="language-r"> input_selectGO5 &lt;- 'GOBP'  #Gene set category 
 # Read pathway data again 
 GeneSets.out &lt;-readGeneSets( geneSetFile,
    convertedData.out, input_selectGO5,input_selectOrg,
    c(input_minSetSize, input_maxSetSize)  ) 
 input_selectWGCNA.Module &lt;- '1. turquoise (495 genes)' #Select a module
 input_topGenesNetwork &lt;- 10    #SoftPower to cutoff
 input_edgeThreshold &lt;- 0.4 #Number of top genes 
 moduleNetwork()    # show network of top genes in selected module
</code></pre>

<pre><code>##  softConnectivity: FYI: connecitivty of genes with less than 4 valid samples will be returned as NA.
##  ..calculating connectivities..
</code></pre>

<p><img src="/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>

<pre><code class="language-r"> input_removeRedudantSets &lt;- TRUE   #Remove redundant gene sets 
 results &lt;- networkModuleGO()  #Enrichment analysis of selected module
 results$adj.Pval &lt;- format( results$adj.Pval,digits=3 )
 kable( results, row.names=FALSE) 
</code></pre>

<table>
<thead>
<tr>
<th align="left">adj.Pval</th>
<th align="right">Genes</th>
<th align="left">Pathways</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">6.2e-68</td>
<td align="right">106</td>
<td align="left">Organonitrogen compound metabolic process</td>
</tr>

<tr>
<td align="left">3.0e-62</td>
<td align="right">61</td>
<td align="left">Ribonucleoprotein complex biogenesis</td>
</tr>

<tr>
<td align="left">6.9e-62</td>
<td align="right">68</td>
<td align="left">RNA processing</td>
</tr>

<tr>
<td align="left">4.0e-61</td>
<td align="right">84</td>
<td align="left">Organonitrogen compound biosynthetic process</td>
</tr>

<tr>
<td align="left">2.4e-56</td>
<td align="right">57</td>
<td align="left">NcRNA metabolic process</td>
</tr>

<tr>
<td align="left">4.2e-53</td>
<td align="right">101</td>
<td align="left">Immune system process</td>
</tr>

<tr>
<td align="left">2.0e-49</td>
<td align="right">81</td>
<td align="left">Macromolecular complex assembly</td>
</tr>

<tr>
<td align="left">3.0e-48</td>
<td align="right">46</td>
<td align="left">Ribosome biogenesis</td>
</tr>

<tr>
<td align="left">3.4e-48</td>
<td align="right">84</td>
<td align="left">Establishment of protein localization</td>
</tr>

<tr>
<td align="left">4.7e-48</td>
<td align="right">63</td>
<td align="left">Cellular amide metabolic process</td>
</tr>
</tbody>
</table>

    </div>

    


<div class="article-tags">
  
  <a class="btn btn-primary btn-outline" href="/tags/idep/">iDEP</a>
  
</div>




    
    

    

    
<section id="comments">
  <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-gex-netlify-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



  </div>
</article>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2018 &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    
    <script id="dsq-count-scr" src="//https-gex-netlify-com.disqus.com/count.js" async></script>
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>
    
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

