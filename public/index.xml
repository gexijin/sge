<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Academic on Academic</title>
    <link>/</link>
    <description>Recent content in Academic on Academic</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2018</copyright>
    <lastBuildDate>Sun, 15 Oct 2017 00:00:00 -0500</lastBuildDate>
    <atom:link href="/" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Using Amazon EC2 to run large data analysis cheaply</title>
      <link>/post/using-amazon-ec2-to-run-large-data-analysis-cheaply/</link>
      <pubDate>Thu, 05 Jul 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/using-amazon-ec2-to-run-large-data-analysis-cheaply/</guid>
      <description>&lt;p&gt;Spot instances on Amazon Elastic Compute Cloud (EC2) allows researchers to compute at very low cost. These are some of the idling machines. One caveat is that they can be terminated at any given time. But this is rather rare. Here I document how you how I started a virtual machine on Amazon, establish a connection via SSH and set up the brand-new Linux machine to run R using docker images. I know little about Linux and networking. So if I can make this work, so can you. This is how I managed to make it work. May not be the best way to do it, as I do not understand a lot of the technology.&lt;/p&gt;

&lt;p&gt;Main topics covered this tutorial:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Set up Key Pairs and Security Groups to enable SHH login.&lt;/li&gt;
&lt;li&gt;Request spot instance (virtual machine)&lt;/li&gt;
&lt;li&gt;SHH access to the instance via Putty and Filezilla&lt;/li&gt;
&lt;li&gt;Install Docker software so that we can easily configure a computing environment&lt;/li&gt;
&lt;li&gt;Build a docker image based on the Bioconductor docker definition files and a few extra packages&lt;/li&gt;
&lt;li&gt;Start R and compute from within the docker container&lt;/li&gt;
&lt;li&gt;Create a &amp;ldquo;volume&amp;rdquo; (a virtual hard drive) and attach it to running instances.&lt;/li&gt;
&lt;li&gt;Take a snapshot of a running instance, copy it across regions, and use it to create a volume.&lt;/li&gt;
&lt;li&gt;Google Compute Engine set-up.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Follow these detailed instructions:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Create an account and sign in to Amazon EC2. You can use your Amazon account. You will need a credit card number.
&lt;img src=&#34;/img/postEC2/image001.png&#34; alt=&#34;EC2&#34; /&gt;&lt;/li&gt;
&lt;li&gt;Create a key pair using the menu on the left in the NETWORK &amp;amp; SECURITY. A file named XXX.pem will be downloaded automatically. I called it key1.pem. This file will be needed to establish SHH connection later.
&lt;img src=&#34;/img/postEC2/image003.png&#34; alt=&#34;Keypair&#34; /&gt;&lt;/li&gt;
&lt;li&gt;Create a Security Group.  Under the NETWORK&amp;amp; SECURITY, click on Security Groups and then choose Create Security Group.  Select SSH from the &amp;ldquo;Type&amp;rdquo; column.  The default outbound rule seems to work. We will use this Security Group when we specify our instances.
&lt;img src=&#34;/img/postEC2/image005.png&#34; alt=&#34;rert&#34; /&gt;&lt;/li&gt;
&lt;li&gt;Start requesting an instance (virtual machine) by clicking on the Spot Requests on the left. Instances initiated with Spot Requests are much cheaper than regular instances. They are computers at idle. They can be terminated abruptly though.
&lt;img src=&#34;/img/postEC2/image007.png&#34; alt=&#34;rert&#34; /&gt;&lt;/li&gt;
&lt;li&gt;Start the Spot Advisor and enter your request. Change the amount required to 1. Otherwise, 20 instances will be requested. A 64-core instance with 256GB memory costs $0.67 per hour or about $16 per day.  Note that Amazon has web servers all across the world. You can switch regions from the top right of the screen. Prices and availability of resources vary greatly across the region.
&lt;img src=&#34;/img/postEC2/image009.png&#34; alt=&#34;rert&#34; /&gt;&lt;/li&gt;
&lt;li&gt;Configure your instance

&lt;ul&gt;
&lt;li&gt;Choose Ubuntu Server 16.04&lt;/li&gt;
&lt;li&gt;Increase EBS volumes to 20 GB from the default 8GB&lt;/li&gt;
&lt;li&gt;Make sure the key pair you created (key1) is used.&lt;/li&gt;
&lt;li&gt;Choose the SHH-enabled Security group we created.
&lt;img src=&#34;/img/postEC2/image011.png&#34; alt=&#34;rert&#34; /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Click Launch and wait a few minutes for Amazon to fulfill this request. Reasons for failed requests vary. There are limits on the maximum number of spot instances for a region such as us-east-2b. There are also limits on new users. These can be lifted by filing a request in the Support Center.
&lt;img src=&#34;/img/postEC2/image013.png&#34; alt=&#34;rert&#34; /&gt;&lt;/li&gt;
&lt;li&gt;Once fulfilled, the instance is listed under Instances.
&lt;img src=&#34;/img/postEC2/image015.png&#34; alt=&#34;image&#34; /&gt;&lt;/li&gt;
&lt;li&gt;To connect to the instance, click on the Connect button (above), information like this will be shown.
&lt;img src=&#34;/img/postEC2/image017.png&#34; alt=&#34;image&#34; /&gt;&lt;/li&gt;
&lt;li&gt;Download Puttygen.exe to convert the key1.pem we got from Amazon to a private key file, &amp;ldquo;key1-Ec2.ppk&amp;rdquo;.  &lt;img src=&#34;/img/postEC2/image019.png&#34; alt=&#34;image&#34; /&gt;&lt;/li&gt;
&lt;li&gt;Download and start Putty.exe

&lt;ul&gt;
&lt;li&gt;Copy and paste the public DNS, such as ec2-52-14-231-133.us-east-2.compute.amazonaws.com&lt;/li&gt;
&lt;li&gt;Under Connection and Data, enter the user name: ubuntu or ec2-user&lt;/li&gt;
&lt;li&gt;Under Connection -&amp;gt; SSH  -&amp;gt; Auth, upload the converted private key file &amp;ldquo;key1-Ec2.ppk&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;Save this session info as EC2-spot3, so that next time we can easily connect to this instances without going through a-c.
&lt;img src=&#34;/img/postEC2/image021.png&#34; alt=&#34;image&#34; /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;We are connected to the instance!!!&lt;br /&gt;
&lt;img src=&#34;/img/postEC2/image023.png&#34; alt=&#34;image&#34; /&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;To copy files to this instance, use FileZilla and follow directions &lt;a href=&#34;http://angus.readthedocs.io/en/2014/amazon/transfer-files-between-instance.html&#34; target=&#34;_blank&#34;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Go to Edit -&amp;gt; Settings to add the key1.pem file as a security key&lt;/li&gt;
&lt;li&gt;File -&amp;gt; Site Manager -&amp;gt; New Site:&lt;/li&gt;
&lt;li&gt;Change Protocol to SFTP;  paste host name, Change Logon Type to Normal;  and enter the username &amp;ldquo;ubuntu&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;Alternatively, we can use scp:&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;scp -i ../key1.pem  animals.tar.gz     ubuntu@ec2-52-14-179-157.us-east-2.compute.amazonaws.com:/mnt/data/
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Install Docker software follow this &lt;a href=&#34;https://docs.docker.com/install/linux/docker-ce/ubuntu/#install-using-the-repository&#34; target=&#34;_blank&#34;&gt;instruction&lt;/a&gt;, summerized below:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo apt-get update
sudo apt-get install \
    apt-transport-https \
    ca-certificates \
    curl \
    software-properties-common
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
sudo add-apt-repository \
   &amp;quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu \
   $(lsb_release -cs) \
   stable&amp;quot;
sudo apt-get update
sudo apt-get install docker-ce
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Define your docker image. Save this  as a file called: Dockerfile in a folder such as /home/ubuntu/dockers/. See &lt;a href=&#34;https://www.bioconductor.org/help/docker/&#34; target=&#34;_blank&#34;&gt;here for the Bioconductor docker&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;FROM bioconductor/release_core2
RUN R -e &#39;source(&amp;quot;https://bioconductor.org/biocLite.R&amp;quot;);
biocLite(c(&amp;quot;GO.db&amp;quot;, &amp;quot;GOstats&amp;quot;), suppressUpdates = T)&#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Create an image called mybioconductor. Navigate to the folder that contains the file named Dockerfile, and then&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo docker build -t mybioconductor  .
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Create a data folder&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mkdir ~/data
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;18.Start Bioconductor Docker container instance called bio1. The /home/ubuntu/data folder visible in the docker container as /data&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo docker run -v /home/ubuntu/data:/data --name bio1 -t         mybioconductor 
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Within the container, you now have the most recent R and Bioconductor. Note that you are logged in as root in the container with IDs like 9c4b9c5d1492.
&lt;img src=&#34;/img/postEC2/image025.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;To run large R jobs in the background use nohup&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;nohup R CMD BATCH myScript.R &amp;gt; nohup.out &amp;amp; 
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;It is safe to exit the container. To go back to the container:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo exec -it bio2 /bin/bash 
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;The following steps are optional.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Create a volume from Elastic Block Store on the menu bar of the EC2 interface.
Create volume in the exactly the same region such as us-east-2b. These storages will persist even if the instance is terminated.&lt;/li&gt;
&lt;li&gt;Attach the volume to the instance.  Select the volume and attach to the desired instance&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Mount the created volume to a folder /mnt. Note that the volume needs to be mounted again after reboot. &lt;a href=&#34;https://n2ws.com/blog/how-to-guides/connect-aws-ebs-volume-another-instance&#34; target=&#34;_blank&#34;&gt;See here&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd /
sudo mkdir mnt  # create a folder
sudo chmod -R a+rwX /mnt
lsblk    # check the list of devices 
sudo mkfs.ext4 /dev/xvdf      # create a file system
sudo mount /dev/xvdf  /mnt 
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Snapshots can be created from the running instances. This snapshot can be copied across regions (Ohio to Central). We can also create a volume based on the snapshot and access the data. To mount volumes created from snapshots. Note that file system already exists on the volumes created from snapshots. We should be mounting the xvdf1, not xvdf. &lt;a href=&#34;https://serverfault.com/questions/632905/cannot-mount-an-existing-ebs-on-aws&#34; target=&#34;_blank&#34;&gt;Details&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd /
sudo mkdir mnt  # create folder
lsblk    # check the list of devices 
sudo mount /dev/xvdf1  /mnt      
sudo chmod -R a+rwX /mnt    # make folder writable to all
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Google Compute Engine can be set up following a similar fashion following &lt;a href=&#34;https://www.onepagezen.com/google-cloud-ftp-filezilla-quick-start/&#34; target=&#34;_blank&#34;&gt;instructions&lt;/a&gt;
 - Login and create instance at Google  Compute Engine
 - Download PuttyGen
 - click Generate to create key pairs
 - Save private key file
 - Copy the public key to clipboard
 - Click Metadata in Compute Engine menu and add SHH Key by paste the public key
 - Filezella &amp;ndash;&amp;gt; Edit &amp;ndash;&amp;gt; settings &amp;ndash;&amp;gt; SFTP  &amp;ndash;&amp;gt; Add key file&lt;/p&gt;

&lt;p&gt;Following these step, I was able to create 3 fairly powerful servers, each with 64 cores, 256GB memory and 50GB SSD. Using the foreach and doSNOW  R packages, we can use all the cores in parallel at 100%.  I shut them down when all finished in a few days. It costed less than $200. Yes, the flexibility and affordability of computing are here. It is less complicated to use than you think.&lt;/p&gt;

&lt;p&gt;Note: This was intially a note for myself taken using OneNote. Translating to Markdown is such a painful process. It remains me of the early days programming with Fortran. Counting spaces&amp;hellip; Someone simplify it! I need to figure out a way to insert a html file directly into Blogdown as a post.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Blogdown notes</title>
      <link>/post/blogdown-notes/</link>
      <pubDate>Mon, 02 Jul 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/blogdown-notes/</guid>
      <description>&lt;p&gt;To start a new post, choose &amp;ldquo;New post&amp;rdquo; from Addins.
Use Markdown for texts. If it contains R markdown, rendering plots, etc, use RMarkdown, not Rmd.&lt;/p&gt;

&lt;p&gt;Click &amp;ldquo;Build Websites&amp;rdquo;&lt;/p&gt;

&lt;p&gt;Git GUI.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>DESeq2 experimental design and interpretation</title>
      <link>/post/deseq2-experimental-design-and-interpretation/</link>
      <pubDate>Mon, 02 Jul 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/deseq2-experimental-design-and-interpretation/</guid>
      <description>

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/factors5.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Update. 11/13/17  Thanks to Mike Love for pointing out an error. This is just my understanding. There maybe other errors.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;To allow complex study designs in iDEP(&lt;a href=&#34;http://ge-lab.org/idep/&#34; target=&#34;_blank&#34;&gt;http://ge-lab.org/idep/&lt;/a&gt;), I tried to understand how factoral models are built and the desired results are extracted from DESeq2.  The following is based on the help document from the resutls( ) function in DESeq2, plus some of Mike Love&amp;rsquo;s answers to questions from users.&lt;/p&gt;

&lt;p&gt;An important point I want to make is the interpretation of results is tricky when the study design involve multiple factors.  See figure above for an example involving 3 genotypes under 3  conditions.  Similar to regression analysis in R, the &lt;em&gt;reference levels&lt;/em&gt; for categorical factors forms the foundation of our intereptation. Yet, by default, they are determined alphabetically.&lt;/p&gt;

&lt;p&gt;Before runing DESeq2, it is essential to choose appropriate reference levels for each factors. This can be done by the relevel( ) function in R. Reference level is the baseline level of a factor that forms the basis of meaningful comparisons. In a wildtype vs. mutant experiment, &amp;ldquo;wild-type&amp;rdquo; is the reference level. In treated vs. untreated, the reference level is obviously untreated. More details in Exmple 3.&lt;/p&gt;

&lt;p&gt;iDEP provides a GUI to DESeq2 for most experimental desings. It also provides convienent interface for exploratory data anlysis and pathway analysis. Try it at &lt;a href=&#34;http://ge-lab.org/idep/&#34; target=&#34;_blank&#34;&gt;http://ge-lab.org/idep/&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&#34;example-1-two-group-comparison&#34;&gt;Example 1: two-group comparison&lt;/h1&gt;

&lt;p&gt;First make some example data.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(DESeq2)
dds &amp;lt;- makeExampleDESeqDataSet(n=10000,m=6)
assay(dds)[ 1:10,]
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##        sample1 sample2 sample3 sample4 sample5 sample6
## gene1        6       4      11       1       2      13
## gene2        9      12      23      13      14      28
## gene3       58     121     173     178     118      97
## gene4        0       4       0       3       8       3
## gene5       27       3       6       9       8      12
## gene6       48       8      35      38      21      13
## gene7       36      50      61      52      44      22
## gene8        6       8      16      14      18      19
## gene9      214     266     419     198     157     166
## gene10      20      12      16      12      16       2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This is a very simple experiment design with two conditions.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;colData(dds)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## DataFrame with 6 rows and 1 column
##         condition
##          &amp;lt;factor&amp;gt;
## sample1         A
## sample2         A
## sample3         A
## sample4         B
## sample5         B
## sample6         B
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;dds &amp;lt;- DESeq(dds)
resultsNames(dds)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;Intercept&amp;quot;        &amp;quot;condition_B_vs_A&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This shows the results available. Note that by default, R will choose a reference level for factors based on alphabetical order. Here A is the referece level. Fold change is defined as B compaired with A. To change reference levels, try the relevel( ) function.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res &amp;lt;- results(dds, contrast=c(&amp;quot;condition&amp;quot;,&amp;quot;B&amp;quot;,&amp;quot;A&amp;quot;))
res &amp;lt;- res[order(res$padj),]
library(knitr)
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene9056&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;360.168909&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-2.045379&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001372&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene3087&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;43.897516&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-2.203303&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000173&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0857004&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene3763&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;72.409877&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.834787&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000433&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1434364&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene2054&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;322.494963&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.537408&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000682&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1692730&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene4617&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.227415&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.125238&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0002015&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4001027&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;If we want to use B as control and define fold change using B as baseline. Then we can do this:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res &amp;lt;- results(dds, contrast=c(&amp;quot;condition&amp;quot;,&amp;quot;A&amp;quot;,&amp;quot;B&amp;quot;))
ix = which.min(res$padj)
res &amp;lt;- res[order(res$padj),]
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene9056&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;360.168909&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.045379&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001372&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene3087&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;43.897516&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.203303&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000173&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0857004&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene3763&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;72.409877&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.834787&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000433&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1434364&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene2054&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;322.494963&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.537408&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000682&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1692730&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene4617&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.227415&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-6.125238&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0002015&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4001027&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;As you can see, the fold-change are completely opposite direction. Here we show the most significant gene.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-6-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;p&gt;#Example 2: Multiple groups
Suppose we have three groups A, B, and C.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;dds &amp;lt;- makeExampleDESeqDataSet(n=100,m=6)
dds$condition &amp;lt;- factor( c( &amp;quot;A&amp;quot;,&amp;quot;A&amp;quot;,&amp;quot;B&amp;quot;,&amp;quot;B&amp;quot;,&amp;quot;C&amp;quot;,&amp;quot;C&amp;quot;) )
dds &amp;lt;- DESeq(dds)
res = results(dds, contrast=c(&amp;quot;condition&amp;quot;,&amp;quot;C&amp;quot;,&amp;quot;A&amp;quot;))
res &amp;lt;- res[order(res$padj),]
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.634986&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-5.101773&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0348679&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5515088&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene20&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.678176&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-4.490982&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0445664&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5515088&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene34&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;56.068672&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.462155&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0167820&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5515088&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene35&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;537.847175&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.177240&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0087913&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5515088&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene41&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;93.967810&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.064734&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0412034&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5515088&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&#34;example-3-two-conditions-two-genotypes-with-an-interaction-term&#34;&gt;Example 3: two conditions, two genotypes, with an interaction term&lt;/h1&gt;

&lt;p&gt;Here we have two genotypes, wild-type (WT), and mutant (MU). Two conditions, control (Ctrl) and treated (Trt). We are interested in the responses of both wild-type and mutant to treatment. We are also interested in the differences in response between genotypes, which is captured by the interaction term in linear models.&lt;/p&gt;

&lt;p&gt;First, we construct example data. Note that we changed sample names from &amp;ldquo;sample1&amp;rdquo; to &amp;ldquo;Wt_Ctrl_1&amp;rdquo;, according to the two factors.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;dds &amp;lt;- makeExampleDESeqDataSet(n=10000,m=12)
dds$condition &amp;lt;- factor( c( rep(&amp;quot;Ctrl&amp;quot;,6), rep(&amp;quot;Trt&amp;quot;,6) ) )
dds$genotype &amp;lt;- factor(rep(rep(c(&amp;quot;WT&amp;quot;,&amp;quot;MU&amp;quot;),each=3),2))
colnames(dds) &amp;lt;- paste(as.character( dds$genotype),as.character( dds$condition),rownames(colData(dds)),  sep=&amp;quot;_&amp;quot;  )
colnames(dds) = gsub(&amp;quot;sample&amp;quot;,&amp;quot;&amp;quot;,colnames(dds))
kable(assay(dds)[1:5,])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;WT_Ctrl_1&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;WT_Ctrl_2&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;WT_Ctrl_3&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;MU_Ctrl_4&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;MU_Ctrl_5&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;MU_Ctrl_6&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;WT_Trt_7&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;WT_Trt_8&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;WT_Trt_9&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;MU_Trt_10&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;MU_Trt_11&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;MU_Trt_12&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;81&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;47&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;135&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;72&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;81&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;80&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;76&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;57&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;52&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;49&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;64&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;57&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;70&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;77&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;94&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;54&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;54&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;36&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;51&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;66&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;57&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;51&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;47&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;67&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;37&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;28&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;36&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;40&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;kable( colData(dds))
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;condition&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;genotype&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;WT_Ctrl_1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Ctrl&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;WT&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;WT_Ctrl_2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Ctrl&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;WT&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;WT_Ctrl_3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Ctrl&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;WT&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;MU_Ctrl_4&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Ctrl&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;MU&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;MU_Ctrl_5&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Ctrl&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;MU&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;MU_Ctrl_6&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Ctrl&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;MU&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;WT_Trt_7&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Trt&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;WT&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;WT_Trt_8&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Trt&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;WT&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;WT_Trt_9&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Trt&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;WT&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;MU_Trt_10&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Trt&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;MU&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;MU_Trt_11&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Trt&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;MU&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;MU_Trt_12&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Trt&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;MU&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Check reference levels:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;dds$condition
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##  [1] Ctrl Ctrl Ctrl Ctrl Ctrl Ctrl Trt  Trt  Trt  Trt  Trt  Trt 
## Levels: Ctrl Trt
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;As you could see, &amp;ldquo;Ctrl&amp;rdquo; apeared first in the 2nd line, indicating it is the reference level for factor condition, as we can expect based on alphabetical order. This is what we want and we do not need to do anything.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;dds$genotype
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##  [1] WT WT WT MU MU MU WT WT WT MU MU MU
## Levels: MU WT
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;But  &amp;ldquo;Mu&amp;rdquo; is the reference level for genotype, which is will give us results difficult to interpret. We need to change it.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;dds$genotype = relevel( dds$genotype, &amp;quot;WT&amp;quot;)
dds$genotype
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##  [1] WT WT WT MU MU MU WT WT WT MU MU MU
## Levels: WT MU
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Set up the model, and run DESeq2:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;design(dds) &amp;lt;- ~ genotype + condition + genotype:condition
dds &amp;lt;- DESeq(dds) 
resultsNames(dds)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;Intercept&amp;quot;               &amp;quot;genotype_MU_vs_WT&amp;quot;      
## [3] &amp;quot;condition_Trt_vs_Ctrl&amp;quot;   &amp;quot;genotypeMU.conditionTrt&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Below, we are going to use the combination of the different results (&amp;ldquo;genotype_MU_vs_WT&amp;rdquo;, &amp;ldquo;condition_Trt_vs_Ctrl&amp;rdquo;, &amp;ldquo;genotypeMU.conditionTrt&amp;rdquo; ) to derive biologically meaningful comparisons.&lt;/p&gt;

&lt;p&gt;##The  effect of treatment in wild-type (the main effect).&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, contrast=c(&amp;quot;condition&amp;quot;,&amp;quot;Trt&amp;quot;,&amp;quot;Ctrl&amp;quot;))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene275&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;25.38836&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.607896&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000588&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2684841&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene2744&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;101.02954&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.670837&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001099&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2684841&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5441&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;58.67469&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.758921&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001261&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2684841&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene7021&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;74.29359&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.610853&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001345&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2684841&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene7795&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;326.43308&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.624323&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000407&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2684841&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;This is for WT, treated compared with untreated. Note that WT is not mentioned, because it is the reference level. In other words, this is the difference between samples No. 7-9, compared with samples No. 1-3.&lt;/p&gt;

&lt;p&gt;Here we show the most significant gene.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-14-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;p&gt;##The effect of treatment in mutant
This is, by definition, the main effect &lt;em&gt;plus&lt;/em&gt; the interaction term (the extra condition effect in genotype Mutant compared to genotype WT).&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res &amp;lt;- results(dds, list( c(&amp;quot;condition_Trt_vs_Ctrl&amp;quot;,&amp;quot;genotypeMU.conditionTrt&amp;quot;) ))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5102&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.69017&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.757057&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.60e-06&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0156912&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene7367&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;170.69259&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.481016&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.19e-05&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0396827&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene8351&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;27.77227&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.033622&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.80e-06&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0396827&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene8034&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;53.34342&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.841023&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.62e-05&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0403724&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene7272&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;92.82351&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.414967&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.70e-05&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1125817&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Note that it has to be &lt;em&gt;list&lt;/em&gt;( c(&amp;ldquo;condition_Trt_vs_Ctrl&amp;rdquo;,&amp;ldquo;genotypeMU.conditionTrt&amp;rdquo;) ). If list( ) is ommitted, the results would be drastically different. Perhaps only the first coefficient is used.&lt;/p&gt;

&lt;p&gt;This measures the effect of treatment in mutant. In other words, samples No. 10-12 compared with samples No. 4-6.&lt;/p&gt;

&lt;p&gt;Here we show the most significant gene, which is downregulated expressed in samples 10-12, than samples 4-6 , as expected.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-16-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;p&gt;##What is the difference between mutant and wild-type without treatment?&lt;/p&gt;

&lt;p&gt;As Ctrl is the reference level, we can just retrieve the &amp;ldquo;genotype_MU_vs_WT&amp;rdquo;.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, contrast=c(&amp;quot;genotype&amp;quot;,&amp;quot;MU&amp;quot;,&amp;quot;WT&amp;quot;))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5102&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.69017&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-4.714519&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000020&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0195596&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene2289&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;45.04711&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.763615&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000333&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1218107&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene3388&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;122.85582&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.529323&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000366&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1218107&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene915&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;39.03250&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.104003&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001133&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2374861&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene8351&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;27.77227&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-2.653182&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001190&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2374861&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;In other words, this is the samples No.4-6  compared with No. 1-3. Here we show the most significant gene.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-18-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;p&gt;##With treatment, what is the difference between mutant and wild-type?&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, list( c(&amp;quot;genotype_MU_vs_WT&amp;quot;,&amp;quot;genotypeMU.conditionTrt&amp;quot;) ))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene4127&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;50.03677&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.925094&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000091&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0910879&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene3879&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;34.67704&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-2.133203&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000283&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0940393&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene4799&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24.11059&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-2.459345&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000197&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0940393&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5441&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;58.67469&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.744769&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001418&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2357639&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5926&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;161.16737&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.524163&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001339&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2357639&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;This gives us the difference between genotype MU and WT, under condition Trt. In other words, this is the sampless No. 10-12 compared with samples 7-9.&lt;/p&gt;

&lt;p&gt;Here we show the most significant gene.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-20-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;the-different-response-in-genotypes-interaction-term&#34;&gt;The different response in genotypes (interaction term)&lt;/h2&gt;

&lt;p&gt;Is the  effect of treatment &lt;em&gt;different&lt;/em&gt; across genotypes? This is the interaction term.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, name=&amp;quot;genotypeMU.conditionTrt&amp;quot;)
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5102&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.69017&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7.395771&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000341&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5441&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;58.67469&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-3.297673&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000004&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0019104&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene8034&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;53.34342&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-2.564030&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000205&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0682558&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene8858&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14.68650&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.703936&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000297&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0742076&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene4799&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24.11059&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-2.990101&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001234&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2463661&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Here we show the most significant gene.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-22-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;p&gt;In wild-type, this gene is upregulated by treatment, while for the  mutant, it is downregulated.&lt;/p&gt;

&lt;h1 id=&#34;example-4-two-conditionss-three-genotpes-with-interaction-terms&#34;&gt;Example 4: Two conditionss, three genotpes with interaction terms&lt;/h1&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;dds &amp;lt;- makeExampleDESeqDataSet(n=10000,m=18)
dds$genotype &amp;lt;- factor(rep(rep(c(&amp;quot;I&amp;quot;,&amp;quot;II&amp;quot;,&amp;quot;III&amp;quot;),each=3),2))
colnames(dds) &amp;lt;- paste(rownames(colData(dds)), as.character( dds$condition), as.character( dds$genotype),sep=&amp;quot;_&amp;quot;  )
colnames(dds) = gsub(&amp;quot;sample&amp;quot;,&amp;quot;S&amp;quot;,colnames(dds))
design(dds) &amp;lt;- ~ genotype + condition + genotype:condition
dds &amp;lt;- DESeq(dds)
kable( colData(dds))
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;condition&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;genotype&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;sizeFactor&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S1_A_I&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.053964&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S2_A_I&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.058935&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S3_A_I&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.061629&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S4_A_II&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.047347&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S5_A_II&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.059813&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S6_A_II&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.049639&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S7_A_III&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.060271&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S8_A_III&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.057331&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S9_A_III&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.052053&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S10_B_I&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.053989&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S11_B_I&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.044408&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S12_B_I&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.042376&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S13_B_II&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.042354&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S14_B_II&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.050094&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S15_B_II&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.045868&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S16_B_III&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.050772&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S17_B_III&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.047934&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S18_B_III&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.036983&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;resultsNames(dds)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;Intercept&amp;quot;              &amp;quot;genotype_II_vs_I&amp;quot;      
## [3] &amp;quot;genotype_III_vs_I&amp;quot;      &amp;quot;condition_B_vs_A&amp;quot;      
## [5] &amp;quot;genotypeII.conditionB&amp;quot;  &amp;quot;genotypeIII.conditionB&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;the-condition-effect-for-genotype-i-the-main-effect&#34;&gt;The condition effect for genotype I (the main effect)&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, contrast=c(&amp;quot;condition&amp;quot;,&amp;quot;B&amp;quot;,&amp;quot;A&amp;quot;))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene9348&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;48.01943&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.915941&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000155&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1546441&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene928&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;60.03093&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.562622&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001151&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5748158&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene931&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;439.23135&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.101161&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0004187&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.6066182&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene4483&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16.83153&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.957899&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0005487&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.6066182&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene4612&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;29.09139&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.742999&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0006893&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.6066182&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-24-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;the-condition-effect-for-genotype-iii&#34;&gt;The condition effect for genotype III.&lt;/h2&gt;

&lt;p&gt;This is the main effect &lt;em&gt;plus&lt;/em&gt; the interaction term
(the extra condition effect in genotype III compared to genotype I).&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, contrast=list( c(&amp;quot;condition_B_vs_A&amp;quot;,&amp;quot;genotypeIII.conditionB&amp;quot;) ))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene316&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;63.666427&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.724235&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000294&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2936262&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene252&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.751827&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-6.012712&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001418&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2977597&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene2068&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16.851863&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-2.725616&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001422&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2977597&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene6828&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19.669827&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.840392&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000635&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2977597&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene7420&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;85.226424&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.510240&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001788&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2977597&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-25-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;the-condition-effect-for-genotype-ii&#34;&gt;The condition effect for genotype II.&lt;/h2&gt;

&lt;p&gt;This is the main effect &lt;em&gt;plus&lt;/em&gt; the interaction term
(the extra condition effect in genotype II compared to genotype I).&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, contrast=list( c(&amp;quot;condition_B_vs_A&amp;quot;,&amp;quot;genotypeII.conditionB&amp;quot;) ))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene980&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;71.929692&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.711667&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0005822&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.648323&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene1177&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;109.057633&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.281177&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0002111&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.648323&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5118&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.487054&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-5.757413&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0005110&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.648323&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5570&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23.786589&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.329791&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0004286&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.648323&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene6519&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;94.137270&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.422193&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001399&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.648323&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-26-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;p&gt;This is equivalent to using numeric vector referencing to each of the results.&lt;/p&gt;

&lt;p&gt;[1] &amp;ldquo;Intercept&amp;rdquo;              &amp;ldquo;genotype_II_vs_I&amp;rdquo;       &amp;ldquo;genotype_III_vs_I&amp;rdquo;&lt;br /&gt;
[4] &amp;ldquo;condition_B_vs_A&amp;rdquo;       &amp;ldquo;genotypeII.conditionB&amp;rdquo;  &amp;ldquo;genotypeIII.conditionB&amp;rdquo;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, contrast= c(0,0,0,1,1,0))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene980&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;71.929692&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.711667&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0005822&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.648323&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene1177&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;109.057633&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.281177&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0002111&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.648323&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5118&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.487054&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-5.757413&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0005110&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.648323&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5570&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23.786589&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.329791&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0004286&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.648323&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene6519&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;94.137270&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.422193&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001399&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.648323&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-27-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;the-effect-of-iii-vs-ii-under-condition-a&#34;&gt;The effect of III vs. II, under condition A.&lt;/h2&gt;

&lt;p&gt;This is the  effect of &amp;ldquo;genotype_III_vs_I&amp;rdquo;  &lt;em&gt;minus&lt;/em&gt;     &amp;ldquo;genotype_II_vs_I&amp;rdquo; ?&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, contrast= c(0,-1,1,0,0,0))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene7875&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;172.84101&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.316870&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000354&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.3541800&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene316&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;63.66643&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.399247&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0006044&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5256726&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene557&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17.92683&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.980097&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0008418&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5256726&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene1243&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;51.92628&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.844387&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0004523&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5256726&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene1702&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;55.34857&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.631481&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0006698&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5256726&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-28-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;the-interaction-term-for-condition-effect-in-genotype-iii-vs-genotype-i&#34;&gt;The interaction term for condition effect in genotype III vs genotype I.&lt;/h2&gt;

&lt;p&gt;This tests if the condition effect is different in III compared to I&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, name=&amp;quot;genotypeIII.conditionB&amp;quot;)
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene9348&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;48.019429&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-2.714891&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000104&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1042074&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene6251&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14.477069&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-4.780646&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000479&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2395245&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene839&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;161.393935&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.662756&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000886&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2950638&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene9383&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.149222&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-6.436304&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001560&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.3896367&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene931&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;439.231351&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.562204&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0003858&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4506833&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-29-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;the-interaction-term-for-condition-effect-in-genotype-iii-vs-genotype-ii&#34;&gt;The interaction term for condition effect in genotype III vs genotype II.&lt;/h2&gt;

&lt;p&gt;This tests if the condition effect is different in III compared to II&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, contrast=list(&amp;quot;genotypeIII.conditionB&amp;quot;, &amp;quot;genotypeII.conditionB&amp;quot;))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5761&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;27.797507&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.231182&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000012&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0116510&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene6598&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;100.143591&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.317486&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000214&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1068006&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene3491&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;325.224707&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.942243&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001168&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2853814&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene4635&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.411707&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.206116&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000963&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2853814&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5118&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.487054&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.088922&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0002454&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2853814&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-30-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;h1 id=&#34;example-5-three-conditions-three-genotypes-with-interaction-terms&#34;&gt;Example 5: Three conditions, three genotypes with interaction terms&lt;/h1&gt;

&lt;p&gt;For a more complex example, we now have a 3x3 factorial design. It is convenent to use a diagram to represent study design and the coefficients generated by DESeq2. Each connections in the diagram below represents a coefficient for a contrast and we can use the combination of these to define desired contrasts by travelling through the graph/network.
&lt;img src=&#34;I:/factors5.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;dds &amp;lt;- makeExampleDESeqDataSet(n=10000,m=18)
dds$genotype &amp;lt;- factor(rep(rep(c(&amp;quot;I&amp;quot;,&amp;quot;II&amp;quot;,&amp;quot;III&amp;quot;),each=3),2))
dds$condition &amp;lt;-factor(rep(c(&amp;quot;A&amp;quot;,&amp;quot;B&amp;quot;,&amp;quot;C&amp;quot;), 6)  )
colnames(dds) &amp;lt;- paste(as.character( dds$genotype), as.character( dds$condition),rownames(colData(dds)), sep=&amp;quot;_&amp;quot;  )
colnames(dds) = gsub(&amp;quot;sample&amp;quot;,&amp;quot;&amp;quot;,colnames(dds))
design(dds) &amp;lt;- ~ genotype + condition + genotype:condition
dds &amp;lt;- DESeq(dds)
kable( colData(dds))
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;condition&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;genotype&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;sizeFactor&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;I_A_1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.055853&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;I_B_2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.037228&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;I_C_3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;C&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.048146&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;II_A_4&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.048901&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;II_B_5&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.062858&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;II_C_6&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;C&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.036711&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;III_A_7&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.052625&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;III_B_8&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.033361&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;III_C_9&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;C&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.040028&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;I_A_10&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.054525&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;I_B_11&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.045331&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;I_C_12&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;C&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.036150&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;II_A_13&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.052502&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;II_B_14&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.047103&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;II_C_15&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;C&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.063802&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;III_A_16&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.053762&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;III_B_17&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.041255&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;III_C_18&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;C&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.048660&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;resultsNames(dds)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;Intercept&amp;quot;              &amp;quot;genotype_II_vs_I&amp;quot;      
## [3] &amp;quot;genotype_III_vs_I&amp;quot;      &amp;quot;condition_B_vs_A&amp;quot;      
## [5] &amp;quot;condition_C_vs_A&amp;quot;       &amp;quot;genotypeII.conditionB&amp;quot; 
## [7] &amp;quot;genotypeIII.conditionB&amp;quot; &amp;quot;genotypeII.conditionC&amp;quot; 
## [9] &amp;quot;genotypeIII.conditionC&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;To derive desired contrasts, we can travel on the network of factor levels, using the given 9 coefficients as bridges.For example, we are interested in the difference between genotpes III vs. II, under condition C. This is not readily available. But we can travel from C to III, then III to I, I to II, and then II to C. Namely the path is C&amp;ndash;III&amp;ndash;I&amp;ndash;II&amp;ndash;C. In terms of coefficients: (III-I) - (II-I) + III.C - II.C=
      &amp;ldquo;genotype_III_vs_I&amp;rdquo; - &amp;ldquo;genotype_II_vs_I&amp;rdquo;  + &amp;ldquo;genotypeIII.conditionC&amp;rdquo; - &amp;ldquo;genotypeII.conditionC&amp;rdquo;
For such a complex contrast, we can use the numerical combination using a vector:
c(0,-1,1,0,0,0,0,-1,1 )
These numbers are applied to the coefficients in the resultsNames. To double check we order them:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;cbind(resultsNames(dds),c(0,-1,1,0,0,0,0,-1,1 ) )
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##       [,1]                     [,2]
##  [1,] &amp;quot;Intercept&amp;quot;              &amp;quot;0&amp;quot; 
##  [2,] &amp;quot;genotype_II_vs_I&amp;quot;       &amp;quot;-1&amp;quot;
##  [3,] &amp;quot;genotype_III_vs_I&amp;quot;      &amp;quot;1&amp;quot; 
##  [4,] &amp;quot;condition_B_vs_A&amp;quot;       &amp;quot;0&amp;quot; 
##  [5,] &amp;quot;condition_C_vs_A&amp;quot;       &amp;quot;0&amp;quot; 
##  [6,] &amp;quot;genotypeII.conditionB&amp;quot;  &amp;quot;0&amp;quot; 
##  [7,] &amp;quot;genotypeIII.conditionB&amp;quot; &amp;quot;0&amp;quot; 
##  [8,] &amp;quot;genotypeII.conditionC&amp;quot;  &amp;quot;-1&amp;quot;
##  [9,] &amp;quot;genotypeIII.conditionC&amp;quot; &amp;quot;1&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now we can extract the contrast.&lt;/p&gt;

&lt;h2 id=&#34;the-effect-of-iii-vs-ii-under-condition-c&#34;&gt;The effect of III vs. II, under condition C.&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, contrast= c(0,-1,1,0,0,0,0,0,1 ))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene793&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;50.368566&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.737810&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.36e-05&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1460573&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene1161&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;827.243573&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.844200&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.39e-05&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1460573&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene3314&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23.430794&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.580687&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.57e-05&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1460573&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene4445&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;51.054925&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-3.096770&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.96e-05&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1736784&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene1555&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.073803&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.771498&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.70e-05&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1937244&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-33-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;p&gt;How about many factors, each with many levels? It&amp;rsquo;s going to become increasingly complex. Drawing a network graph like the one above can help you find the right combination.&lt;/p&gt;

&lt;p&gt;Please let me know if you have any comment.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Forecasting mass shootings</title>
      <link>/post/forecasting-mass-shootings/</link>
      <pubDate>Mon, 02 Jul 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/forecasting-mass-shootings/</guid>
      <description>&lt;p&gt;Using the mass shooting data from &lt;a href=&#34;https://www.motherjones.com/politics/2012/12/mass-shootings-mother-jones-full-data/&#34;&gt;Mother Jones website,&lt;/a&gt; I tried to forecast the number of mass shoottings and total fatalities in the rest of 2018. Some of the R scripts are from this &lt;a href=&#34;http://a-little-book-of-r-for-time-series.readthedocs.io/en/latest/src/timeseries.html&#34;&gt;website.&lt;/a&gt; Please let me know if I there is any error. I am not an expert on time series analysis. &lt;a href=&#34;www.twitter.com&#34;&gt;Twitter&lt;/a&gt; &lt;span class=&#34;citation&#34;&gt;@StevenXGe&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;In recent years, mass shootings are becomming more frequent and more deadly. The models suggest for the rest of 2018, there probably be about 6 more shootings, killing about 59 people in the U.S.&lt;/p&gt;
&lt;div id=&#34;data&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Data&lt;/h1&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;url = &amp;quot;https://docs.google.com/spreadsheet/pub?key=0AswaDV9q95oZdG5fVGJTS25GQXhSTDFpZXE0RHhUdkE&amp;amp;output=csv&amp;quot;
x = read.csv(url)
colnames(x)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##  [1] &amp;quot;case&amp;quot;                               
##  [2] &amp;quot;location&amp;quot;                           
##  [3] &amp;quot;date&amp;quot;                               
##  [4] &amp;quot;year&amp;quot;                               
##  [5] &amp;quot;summary&amp;quot;                            
##  [6] &amp;quot;Fatalities&amp;quot;                         
##  [7] &amp;quot;Injured&amp;quot;                            
##  [8] &amp;quot;total_victims&amp;quot;                      
##  [9] &amp;quot;Venue&amp;quot;                              
## [10] &amp;quot;Prior.signs.of.mental.health.issues&amp;quot;
## [11] &amp;quot;Mental.health...details&amp;quot;            
## [12] &amp;quot;Weapons.obtained.legally&amp;quot;           
## [13] &amp;quot;Where.obtained&amp;quot;                     
## [14] &amp;quot;Type.of.weapons&amp;quot;                    
## [15] &amp;quot;Weapon.details&amp;quot;                     
## [16] &amp;quot;Race&amp;quot;                               
## [17] &amp;quot;Gender&amp;quot;                             
## [18] &amp;quot;Sources&amp;quot;                            
## [19] &amp;quot;Mental.Health.Sources&amp;quot;              
## [20] &amp;quot;latitude&amp;quot;                           
## [21] &amp;quot;longitude&amp;quot;                          
## [22] &amp;quot;Type&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;data-cleaning&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Data cleaning&lt;/h1&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;x = x[,c(&amp;quot;date&amp;quot;,&amp;quot;year&amp;quot;,&amp;quot;Fatalities&amp;quot;,&amp;quot;Race&amp;quot;,&amp;quot;Gender&amp;quot;,&amp;quot;Type&amp;quot;)]
x$Race = gsub(&amp;quot;white&amp;quot;,&amp;quot;White&amp;quot;,as.character(x$Race) )
x$Race = as.factor(x$Race)
summary(x)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##         date         year        Fatalities          Race   
##           : 2   Min.   :1982   Min.   : 3.000   White  :56  
##  1/17/1989: 1   1st Qu.:1998   1st Qu.: 5.000   black  : 9  
##  1/28/18  : 1   Median :2009   Median : 6.000   Asian  : 8  
##  1/30/2006: 1   Mean   :2006   Mean   : 8.313   Black  : 7  
##  1/6/2017 : 1   3rd Qu.:2015   3rd Qu.: 8.000   Latino : 7  
##  1/8/2011 : 1   Max.   :2018   Max.   :58.000   Other  : 5  
##  (Other)  :94   NA&amp;#39;s   :2      NA&amp;#39;s   :2        (Other): 9  
##            Gender      Type   
##               : 2        : 2  
##  Female       : 2   Mass :85  
##  M            :26   Spree:14  
##  Male         :70             
##  Male &amp;amp; Female: 1             
##                               
## &lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;x = subset(x,x$year != 2018)
x$date = as.Date(x$date,&amp;quot;%m/%d/%Y&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;the-number-of-mass-shootings-per-year&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;The number of mass shootings per year&lt;/h1&gt;
&lt;p&gt;There is no mass shooting in 1983, 1985, and 2002.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;yearly = table(x$year)
yearly = c(1,0, yearly)
names(yearly)[1:4]= 1982:1985
yearly[3]=2
yearly[4]=0 
yearly = c(yearly[1:20],0, yearly[21:35])
names(yearly)[21] = &amp;quot;2002&amp;quot;
barplot(yearly)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-Forecasting-mass-shootings-2018_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Clearly, the frequency of mass shootings is increasing in the last 6 years.&lt;/p&gt;
&lt;div id=&#34;time-series-model&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Time series model&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;series = ts(yearly,start=c(1982)) 
yforecast = HoltWinters(series, beta=FALSE, gamma=FALSE)
yforecast&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Holt-Winters exponential smoothing without trend and without seasonal component.
## 
## Call:
## HoltWinters(x = series, beta = FALSE, gamma = FALSE)
## 
## Smoothing parameters:
##  alpha: 0.5024872
##  beta : FALSE
##  gamma: FALSE
## 
## Coefficients:
##       [,1]
## a 8.446514&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(yforecast, main=&amp;quot;Number of mass shootings &amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-Forecasting-mass-shootings-2018_files/figure-html/unnamed-chunk-3-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;The red line is probably the model.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;making-forecast&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Making forecast&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# install.packages(&amp;quot;forecast&amp;quot;)
library(forecast)
shottings = forecast(yforecast, h = 1)
shottings&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##      Point Forecast    Lo 80   Hi 80    Lo 95    Hi 95
## 2018       8.446514 6.239526 10.6535 5.071217 11.82181&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The model predicts there would be about 8.4 mass shootings this year. Since 2 already happened. There probably would be 6 incidences of mass shooting for the rest of 2018. The 95% confidence interval is between 5 and 11. So it is very likely at least 3 more shootings will occur in 2018.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;total-fatalities-in-2018&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Total fatalities in 2018&lt;/h1&gt;
&lt;div id=&#34;prepare-data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Prepare data&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tem = aggregate(x$Fatalities, by=list(x$year), FUN=sum)
tem2 = rbind( tem[1,], c(1983,0), tem[2,],c(1985,0),tem[3:18,], c(2002, 0), tem[19:33, ] ) 
fatalities = tem2[,2]
names(fatalities) = tem2[,1]
barplot(fatalities, las=2)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-Forecasting-mass-shootings-2018_files/figure-html/unnamed-chunk-5-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;This data is noisy, but we still see an uptake in total fatalities in the last 10 years.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;series = ts(fatalities,start=c(1982))
yforecast = HoltWinters(series, beta=FALSE, gamma=FALSE)
yforecast&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Holt-Winters exponential smoothing without trend and without seasonal component.
## 
## Call:
## HoltWinters(x = series, beta = FALSE, gamma = FALSE)
## 
## Smoothing parameters:
##  alpha: 0.4323295
##  beta : FALSE
##  gamma: FALSE
## 
## Coefficients:
##       [,1]
## a 79.90564&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(yforecast, main=&amp;quot;Total fatalities from mass shooting&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-Forecasting-mass-shootings-2018_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;shottings = forecast(yforecast, h = 1)
shottings&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##      Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95
## 2018       79.90564 53.81795 105.9933 40.00795 119.8033&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So this model predicts that about 80 people will be killed in mass shootings in 2018. Since there were 21 in Florida and Pennsylvania already. The rest of 2018 will see about 59 people getting killed. I hope these are not going to happen in schools.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>I tried Docker</title>
      <link>/post/i-tried-docker/</link>
      <pubDate>Mon, 02 Jul 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/i-tried-docker/</guid>
      <description>

&lt;p&gt;After being shown by my students many times, I finally figured out how to use Docker to define an isolated environment. My problem is that I wanted to run the most recent version of R and Bioconductor without bothering you guys.&lt;/p&gt;

&lt;p&gt;Turns out it is a two-liner:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo docker login -u gexijin
sudo docker run --name=my-r-base --rm -ti -v /home/gex/Rdocker:/myData bioconductor/release_core2  /bin/bash
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The first line we need to log-in using username and password from Docker hub: &lt;a href=&#34;https://hub.docker.com/&#34; target=&#34;_blank&#34;&gt;https://hub.docker.com/&lt;/a&gt;
The 2nd line, downloads the most recent Bioconductor image from Docker hub, and runs it. A local folder is mapped to the container.&lt;/p&gt;

&lt;p&gt;Its quite useful to have an environment that you can mess with.&lt;/p&gt;

&lt;p&gt;If you want to customize the docker image with additional R packages and use it more than once. Here is the complete steps:&lt;/p&gt;

&lt;h2 id=&#34;1-docker-login&#34;&gt;1.   Docker login&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;sudo docker login - u gexijin
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;2-save-this-as-a-file-called-dockerfile&#34;&gt;2.   Save this  as a file called: Dockerfile&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;FROM bioconductor/release_core2
# https://www.bioconductor.org/help/docker/
 
# install Bioconductor packages
RUN R -e &#39;source(&amp;quot;https://bioconductor.org/biocLite.R&amp;quot;); biocLite(c(&amp;quot;GO.db&amp;quot;, &amp;quot;GOstats&amp;quot;), suppressUpdates = T)&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;3-create-image-called-bioconductor&#34;&gt;3.   Create image called bioconductor&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;sudo docker build -t bioconductor .
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;4-run-an-instance-mapping-rdocker-folder-in-the-host-to-mydata-in-the-container&#34;&gt;4.   Run an instance (mapping Rdocker folder in the host to /myData in the container)&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;docker run -v /home/gex/Rdocker:/myData --name bioconductor1 -t bioconductor
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;From &lt;a href=&#34;https://deis.com/blog/2015/creating-sharing-first-docker-image/&#34; target=&#34;_blank&#34;&gt;https://deis.com/blog/2015/creating-sharing-first-docker-image/&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&#34;5-access-docker-instance&#34;&gt;5.   Access docker instance&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;sudo docker exec -it bioconductor1 /bin/bash
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;6-run-large-r-script&#34;&gt;6.   Run large R script&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;nohup R CMD BATCH gene_mapping_all.R &amp;gt; nohup.out &amp;amp;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;7-stop-a-docker-instance&#34;&gt;7.   Stop a docker instance&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;sudo docker stop bioconductor1
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Predict mass shootings</title>
      <link>/post/predict-mass-shootings/</link>
      <pubDate>Mon, 02 Jul 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/predict-mass-shootings/</guid>
      <description>

&lt;p&gt;Using the mass shooting data from &lt;a href=&#34;https://www.motherjones.com/politics/2012/12/mass-shootings-mother-jones-full-data/&#34; target=&#34;_blank&#34;&gt;Mother Jones website,&lt;/a&gt;
I tried to forecast the number of mass shoottings and total fatalities in the rest of 2018. Some of the R scripts are from this &lt;a href=&#34;http://a-little-book-of-r-for-time-series.readthedocs.io/en/latest/src/timeseries.html&#34; target=&#34;_blank&#34;&gt;website.&lt;/a&gt; Please let me know if I there is any error. I am not an expert on time series analysis. &lt;a href=&#34;www.twitter.com&#34; target=&#34;_blank&#34;&gt;Twitter&lt;/a&gt; @StevenXGe&lt;/p&gt;

&lt;p&gt;In recent years, mass shootings are becomming more frequent and more deadly. The models suggest for the rest of 2018, there probably be about 6 more shootings, killing about 59 people in the U.S.&lt;/p&gt;

&lt;p&gt;#Data&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;url = &amp;quot;https://docs.google.com/spreadsheet/pub?key=0AswaDV9q95oZdG5fVGJTS25GQXhSTDFpZXE0RHhUdkE&amp;amp;output=csv&amp;quot;
x = read.csv(url)
colnames(x)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##  [1] &amp;quot;case&amp;quot;                               
##  [2] &amp;quot;location&amp;quot;                           
##  [3] &amp;quot;date&amp;quot;                               
##  [4] &amp;quot;year&amp;quot;                               
##  [5] &amp;quot;summary&amp;quot;                            
##  [6] &amp;quot;Fatalities&amp;quot;                         
##  [7] &amp;quot;Injured&amp;quot;                            
##  [8] &amp;quot;total_victims&amp;quot;                      
##  [9] &amp;quot;Venue&amp;quot;                              
## [10] &amp;quot;Prior.signs.of.mental.health.issues&amp;quot;
## [11] &amp;quot;Mental.health...details&amp;quot;            
## [12] &amp;quot;Weapons.obtained.legally&amp;quot;           
## [13] &amp;quot;Where.obtained&amp;quot;                     
## [14] &amp;quot;Type.of.weapons&amp;quot;                    
## [15] &amp;quot;Weapon.details&amp;quot;                     
## [16] &amp;quot;Race&amp;quot;                               
## [17] &amp;quot;Gender&amp;quot;                             
## [18] &amp;quot;Sources&amp;quot;                            
## [19] &amp;quot;Mental.Health.Sources&amp;quot;              
## [20] &amp;quot;latitude&amp;quot;                           
## [21] &amp;quot;longitude&amp;quot;                          
## [22] &amp;quot;Type&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;#Data cleaning&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;x = x[,c(&amp;quot;date&amp;quot;,&amp;quot;year&amp;quot;,&amp;quot;Fatalities&amp;quot;,&amp;quot;Race&amp;quot;,&amp;quot;Gender&amp;quot;,&amp;quot;Type&amp;quot;)]
x$Race = gsub(&amp;quot;white&amp;quot;,&amp;quot;White&amp;quot;,as.character(x$Race) )
x$Race = as.factor(x$Race)
summary(x)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##         date         year        Fatalities          Race   
##           : 2   Min.   :1982   Min.   : 3.000   White  :56  
##  1/17/1989: 1   1st Qu.:1998   1st Qu.: 5.000   black  : 9  
##  1/28/18  : 1   Median :2009   Median : 6.000   Asian  : 8  
##  1/30/2006: 1   Mean   :2006   Mean   : 8.313   Black  : 7  
##  1/6/2017 : 1   3rd Qu.:2015   3rd Qu.: 8.000   Latino : 7  
##  1/8/2011 : 1   Max.   :2018   Max.   :58.000   Other  : 5  
##  (Other)  :94   NA&#39;s   :2      NA&#39;s   :2        (Other): 9  
##            Gender      Type   
##               : 2        : 2  
##  Female       : 2   Mass :85  
##  M            :26   Spree:14  
##  Male         :70             
##  Male &amp;amp; Female: 1             
##                               
## 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;x = subset(x,x$year != 2018)
x$date = as.Date(x$date,&amp;quot;%m/%d/%Y&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;the-number-of-mass-shootings-per-year&#34;&gt;The number of mass shootings per year&lt;/h1&gt;

&lt;p&gt;There is no mass shooting in 1983, 1985, and 2002.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;yearly = table(x$year)
yearly = c(1,0, yearly)
names(yearly)[1:4]= 1982:1985
yearly[3]=2
yearly[4]=0 
yearly = c(yearly[1:20],0, yearly[21:35])
names(yearly)[21] = &amp;quot;2002&amp;quot;
barplot(yearly)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-predict-mass-shootings_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Clearly, the frequency of mass shootings is increasing in the last 6 years.&lt;/p&gt;

&lt;h2 id=&#34;time-series-model&#34;&gt;Time series model&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;series = ts(yearly,start=c(1982)) 
yforecast = HoltWinters(series, beta=FALSE, gamma=FALSE)
yforecast
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## Holt-Winters exponential smoothing without trend and without seasonal component.
## 
## Call:
## HoltWinters(x = series, beta = FALSE, gamma = FALSE)
## 
## Smoothing parameters:
##  alpha: 0.5024872
##  beta : FALSE
##  gamma: FALSE
## 
## Coefficients:
##       [,1]
## a 8.446514
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;plot(yforecast, main=&amp;quot;Number of mass shootings &amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-predict-mass-shootings_files/figure-html/unnamed-chunk-3-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;p&gt;The red line is probably the model.&lt;/p&gt;

&lt;h2 id=&#34;making-forecast&#34;&gt;Making forecast&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# install.packages(&amp;quot;forecast&amp;quot;)
library(forecast)
shottings = forecast(yforecast, h = 1)
shottings
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##      Point Forecast    Lo 80   Hi 80    Lo 95    Hi 95
## 2018       8.446514 6.239526 10.6535 5.071217 11.82181
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The model predicts there would be about 8.4 mass shootings this year. Since 2 already happened. There probably would be 6 incidences of mass shooting for the rest of 2018. The 95% confidence interval is between 5 and  11. So it is very likely at least 3 more shootings will occur in 2018.&lt;/p&gt;

&lt;h1 id=&#34;total-fatalities-in-2018&#34;&gt;Total fatalities in 2018&lt;/h1&gt;

&lt;h2 id=&#34;prepare-data&#34;&gt;Prepare data&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;tem = aggregate(x$Fatalities, by=list(x$year), FUN=sum)
tem2 = rbind( tem[1,], c(1983,0), tem[2,],c(1985,0),tem[3:18,], c(2002, 0), tem[19:33, ] ) 
fatalities = tem2[,2]
names(fatalities) = tem2[,1]
barplot(fatalities, las=2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-predict-mass-shootings_files/figure-html/unnamed-chunk-5-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;p&gt;This data is noisy, but we still see an uptake in total fatalities in the last 10 years.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;series = ts(fatalities,start=c(1982))
yforecast = HoltWinters(series, beta=FALSE, gamma=FALSE)
yforecast
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## Holt-Winters exponential smoothing without trend and without seasonal component.
## 
## Call:
## HoltWinters(x = series, beta = FALSE, gamma = FALSE)
## 
## Smoothing parameters:
##  alpha: 0.4323295
##  beta : FALSE
##  gamma: FALSE
## 
## Coefficients:
##       [,1]
## a 79.90564
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;plot(yforecast, main=&amp;quot;Total fatalities from mass shooting&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-predict-mass-shootings_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;shottings = forecast(yforecast, h = 1)
shottings
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##      Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95
## 2018       79.90564 53.81795 105.9933 40.00795 119.8033
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;So this model predicts that about 80 people will be killed in mass shootings in 2018. Since there were 21 in Florida and Pennsylvania already. The rest of 2018 will see about 59 people getting killed. I hope these are not going to happen in schools.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>R markdown </title>
      <link>/post/r-markdown/</link>
      <pubDate>Mon, 02 Jul 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/r-markdown/</guid>
      <description>&lt;p&gt;rertetdfsad&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>R markdown test2</title>
      <link>/post/r-markdown-test2/</link>
      <pubDate>Mon, 02 Jul 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/r-markdown-test2/</guid>
      <description>&lt;p&gt;here is another test&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;hist(iris[,3]) 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-r-markdown-test2_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>markdown 3</title>
      <link>/post/markdown-3/</link>
      <pubDate>Mon, 02 Jul 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/markdown-3/</guid>
      <description>&lt;p&gt;Just test3&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Privacy Policy</title>
      <link>/privacy/</link>
      <pubDate>Thu, 28 Jun 2018 00:00:00 -0500</pubDate>
      
      <guid>/privacy/</guid>
      <description>&lt;p&gt;&amp;hellip;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Example Talk</title>
      <link>/talk/example-talk/</link>
      <pubDate>Sun, 01 Jan 2017 00:00:00 -0600</pubDate>
      
      <guid>/talk/example-talk/</guid>
      <description>&lt;p&gt;Embed your slides or video here using &lt;a href=&#34;https://sourcethemes.com/academic/post/writing-markdown-latex/&#34; target=&#34;_blank&#34;&gt;shortcodes&lt;/a&gt;. Further details can easily be added using &lt;em&gt;Markdown&lt;/em&gt; and $\rm \LaTeX$ math code.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Deep Learning</title>
      <link>/project/deep-learning/</link>
      <pubDate>Wed, 27 Apr 2016 00:00:00 -0500</pubDate>
      
      <guid>/project/deep-learning/</guid>
      <description>&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.&lt;/p&gt;

&lt;p&gt;Nullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.&lt;/p&gt;

&lt;p&gt;Cras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.&lt;/p&gt;

&lt;p&gt;Suspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.&lt;/p&gt;

&lt;p&gt;Aliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>External Project</title>
      <link>/project/example-external-project/</link>
      <pubDate>Wed, 27 Apr 2016 00:00:00 -0500</pubDate>
      
      <guid>/project/example-external-project/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Academic: the website designer for Hugo</title>
      <link>/post/getting-started/</link>
      <pubDate>Wed, 20 Apr 2016 00:00:00 -0500</pubDate>
      
      <guid>/post/getting-started/</guid>
      <description>

&lt;p&gt;&lt;strong&gt;Academic&lt;/strong&gt; is a framework to help you create a beautiful website quickly. Perfect for personal sites, blogs, or business/project sites. &lt;a href=&#34;https://themes.gohugo.io/theme/academic/&#34; target=&#34;_blank&#34;&gt;Check out the latest demo&lt;/a&gt; of what you&amp;rsquo;ll get in less than 10 minutes. Then head on over to the &lt;a href=&#34;https://sourcethemes.com/academic/docs/&#34; target=&#34;_blank&#34;&gt;Quick Start guide&lt;/a&gt; or take a look at the &lt;a href=&#34;https://sourcethemes.com/academic/updates/&#34; target=&#34;_blank&#34;&gt;Release Notes&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/gcushen/hugo-academic/&#34; target=&#34;_blank&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/gcushen/hugo-academic/master/academic.png&#34; alt=&#34;Screenshot&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Key features:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Easily manage various content including homepage, blog posts, publications, talks, and projects&lt;/li&gt;
&lt;li&gt;Extensible via &lt;strong&gt;color themes&lt;/strong&gt; and &lt;strong&gt;widgets/plugins&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Write in &lt;a href=&#34;https://sourcethemes.com/academic/docs/writing-markdown-latex/&#34; target=&#34;_blank&#34;&gt;Markdown&lt;/a&gt; for easy formatting and code highlighting, with &lt;a href=&#34;https://en.wikibooks.org/wiki/LaTeX/Mathematics&#34; target=&#34;_blank&#34;&gt;LaTeX&lt;/a&gt; for mathematical expressions&lt;/li&gt;
&lt;li&gt;Social/academic network linking, &lt;a href=&#34;https://analytics.google.com&#34; target=&#34;_blank&#34;&gt;Google Analytics&lt;/a&gt;, and &lt;a href=&#34;https://disqus.com&#34; target=&#34;_blank&#34;&gt;Disqus&lt;/a&gt; comments&lt;/li&gt;
&lt;li&gt;Responsive and mobile friendly&lt;/li&gt;
&lt;li&gt;Simple and refreshing one page design&lt;/li&gt;
&lt;li&gt;Multilingual and easy to customize&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;color-themes&#34;&gt;Color Themes&lt;/h2&gt;

&lt;p&gt;Academic is available in different color themes and font themes.&lt;/p&gt;



&lt;div class=&#34;gallery&#34;&gt;
  
  
  
  
    
  
  &lt;a data-fancybox=&#34;gallery-1&#34; data-caption=&#34;Default&#34; href=&#34;https://raw.githubusercontent.com/gcushen/hugo-academic/master/images/theme-default.png&#34;&gt;
    &lt;img alt=&#34;&#34; src=&#34;https://raw.githubusercontent.com/gcushen/hugo-academic/master/images/theme-default.png&#34;&gt;
  &lt;/a&gt;
  
  
  
  
    
  
  &lt;a data-fancybox=&#34;gallery-1&#34; data-caption=&#34;Ocean&#34; href=&#34;https://raw.githubusercontent.com/gcushen/hugo-academic/master/images/theme-ocean.png&#34;&gt;
    &lt;img alt=&#34;&#34; src=&#34;https://raw.githubusercontent.com/gcushen/hugo-academic/master/images/theme-ocean.png&#34;&gt;
  &lt;/a&gt;
  
  
  
  
    
  
  &lt;a data-fancybox=&#34;gallery-1&#34; data-caption=&#34;Dark&#34; href=&#34;https://raw.githubusercontent.com/gcushen/hugo-academic/master/images/theme-dark.png&#34;&gt;
    &lt;img alt=&#34;&#34; src=&#34;https://raw.githubusercontent.com/gcushen/hugo-academic/master/images/theme-dark.png&#34;&gt;
  &lt;/a&gt;
  
  
  
  
    
  
  &lt;a data-fancybox=&#34;gallery-1&#34; data-caption=&#34;Default&#34; href=&#34;https://raw.githubusercontent.com/gcushen/hugo-academic/master/images/theme-forest.png&#34;&gt;
    &lt;img alt=&#34;&#34; src=&#34;https://raw.githubusercontent.com/gcushen/hugo-academic/master/images/theme-forest.png&#34;&gt;
  &lt;/a&gt;
  
  
  
  
    
  
  &lt;a data-fancybox=&#34;gallery-1&#34; data-caption=&#34;Coffee theme with Playfair font&#34; href=&#34;https://raw.githubusercontent.com/gcushen/hugo-academic/master/images/theme-coffee-playfair.png&#34;&gt;
    &lt;img alt=&#34;&#34; src=&#34;https://raw.githubusercontent.com/gcushen/hugo-academic/master/images/theme-coffee-playfair.png&#34;&gt;
  &lt;/a&gt;
  
  
  
  
    
  
  &lt;a data-fancybox=&#34;gallery-1&#34; data-caption=&#34;1950s&#34; href=&#34;https://raw.githubusercontent.com/gcushen/hugo-academic/master/images/theme-1950s.png&#34;&gt;
    &lt;img alt=&#34;&#34; src=&#34;https://raw.githubusercontent.com/gcushen/hugo-academic/master/images/theme-1950s.png&#34;&gt;
  &lt;/a&gt;
  
&lt;/div&gt;

&lt;h2 id=&#34;install&#34;&gt;Install&lt;/h2&gt;

&lt;p&gt;You can choose from one of the following four methods to install:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;one-click install using your web browser (recommended)&lt;/li&gt;
&lt;li&gt;install on your computer using Git with the Command Prompt/Terminal app&lt;/li&gt;
&lt;li&gt;install on your computer by downloading the ZIP files&lt;/li&gt;
&lt;li&gt;install on your computer with RStudio&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;quick-install-using-your-web-browser&#34;&gt;Quick install using your web browser&lt;/h3&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://app.netlify.com/start/deploy?repository=https://github.com/sourcethemes/academic-kickstart&#34; target=&#34;_blank&#34;&gt;Install Academic with Netlify&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;Netlify will provide you with a customizable URL to access your new site&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;On GitHub, go to your newly created &lt;code&gt;academic-kickstart&lt;/code&gt; repository and edit &lt;code&gt;config.toml&lt;/code&gt; to personalize your site. Shortly after saving the file, your site will automatically update&lt;/li&gt;
&lt;li&gt;Read the &lt;a href=&#34;https://sourcethemes.com/academic/docs/&#34; target=&#34;_blank&#34;&gt;Quick Start Guide&lt;/a&gt; to learn how to add Markdown content. For inspiration, refer to the &lt;a href=&#34;https://github.com/gcushen/hugo-academic/tree/master/exampleSite&#34; target=&#34;_blank&#34;&gt;Markdown content&lt;/a&gt; which powers the &lt;a href=&#34;https://themes.gohugo.io/theme/academic/&#34; target=&#34;_blank&#34;&gt;Demo&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;install-with-git&#34;&gt;Install with Git&lt;/h3&gt;

&lt;p&gt;Prerequisites:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://git-scm.com/downloads&#34; target=&#34;_blank&#34;&gt;Download and install Git&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://gohugo.io/getting-started/installing/#quick-install&#34; target=&#34;_blank&#34;&gt;Download and install Hugo&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://github.com/sourcethemes/academic-kickstart#fork-destination-box&#34; target=&#34;_blank&#34;&gt;Fork&lt;/a&gt; the &lt;em&gt;Academic Kickstart&lt;/em&gt; repository and clone your fork with Git:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git clone https://github.com/sourcethemes/academic-kickstart.git My_Website
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;em&gt;Note that if you forked Academic Kickstart, the above command should be edited to clone your fork, i.e. replace &lt;code&gt;sourcethemes&lt;/code&gt; with your GitHub username.&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Initialize the theme:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd My_Website
git submodule update --init --recursive
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;install-with-zip&#34;&gt;Install with ZIP&lt;/h3&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/sourcethemes/academic-kickstart/archive/master.zip&#34; target=&#34;_blank&#34;&gt;Download&lt;/a&gt; and extract &lt;em&gt;Academic Kickstart&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/gcushen/hugo-academic/archive/master.zip&#34; target=&#34;_blank&#34;&gt;Download&lt;/a&gt; and extract the &lt;em&gt;Academic theme&lt;/em&gt; to the &lt;code&gt;themes/academic/&lt;/code&gt; folder from the above step&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;install-with-rstudio&#34;&gt;Install with RStudio&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://sourcethemes.com/academic/docs/install/#install-with-rstudio&#34; target=&#34;_blank&#34;&gt;View the guide to installing Academic with RStudio&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&#34;quick-start&#34;&gt;Quick start&lt;/h2&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;If you installed on your computer, view your new website by running the following command:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;hugo server
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now visit &lt;a href=&#34;http://localhost:1313&#34; target=&#34;_blank&#34;&gt;localhost:1313&lt;/a&gt; and your new Academic powered website will appear. Otherwise, if using Netlify, they will provide you with your URL.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Read the &lt;a href=&#34;https://sourcethemes.com/academic/docs/&#34; target=&#34;_blank&#34;&gt;Quick Start Guide&lt;/a&gt; to learn how to add Markdown content, customize your site, and deploy it. For inspiration, refer to the &lt;a href=&#34;https://github.com/gcushen/hugo-academic/tree/master/exampleSite&#34; target=&#34;_blank&#34;&gt;Markdown content&lt;/a&gt; which powers the &lt;a href=&#34;https://themes.gohugo.io/theme/academic/&#34; target=&#34;_blank&#34;&gt;Demo&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Build your site by running the &lt;code&gt;hugo&lt;/code&gt; command. Then &lt;a href=&#34;https://georgecushen.com/create-your-website-with-hugo/&#34; target=&#34;_blank&#34;&gt;host it for free using Github Pages&lt;/a&gt; or Netlify (refer to the first installation method). Alternatively, copy the generated &lt;code&gt;public/&lt;/code&gt; directory (by FTP, Rsync, etc.) to your production web server (such as a university&amp;rsquo;s hosting service).&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&#34;updating&#34;&gt;Updating&lt;/h2&gt;

&lt;p&gt;Feel free to &lt;em&gt;star&lt;/em&gt; the project on &lt;a href=&#34;https://github.com/gcushen/hugo-academic/&#34; target=&#34;_blank&#34;&gt;Github&lt;/a&gt; to help keep track of updates and check out the &lt;a href=&#34;https://sourcethemes.com/academic/updates&#34; target=&#34;_blank&#34;&gt;release notes&lt;/a&gt; prior to updating your site.&lt;/p&gt;

&lt;p&gt;Before updating the framework, it is recommended to make a backup of your entire website directory (or at least your &lt;code&gt;themes/academic&lt;/code&gt; directory) and record your current version number.&lt;/p&gt;

&lt;p&gt;By default, Academic is installed as a Git submodule which can be updated by running the following command:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;git submodule update --remote --merge
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a href=&#34;https://sourcethemes.com/academic/docs/update/&#34; target=&#34;_blank&#34;&gt;Check out the update guide&lt;/a&gt; for full instructions and alternative methods.&lt;/p&gt;

&lt;h2 id=&#34;feedback-contributing&#34;&gt;Feedback &amp;amp; Contributing&lt;/h2&gt;

&lt;p&gt;Please use the &lt;a href=&#34;https://github.com/gcushen/hugo-academic/issues&#34; target=&#34;_blank&#34;&gt;issue tracker&lt;/a&gt; to let me know about any bugs or feature requests, or alternatively make a pull request.&lt;/p&gt;

&lt;p&gt;For support, head over to the &lt;a href=&#34;http://discuss.gohugo.io&#34; target=&#34;_blank&#34;&gt;Hugo discussion forum&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&#34;license&#34;&gt;License&lt;/h2&gt;

&lt;p&gt;Copyright 2016-present &lt;a href=&#34;https://georgecushen.com&#34; target=&#34;_blank&#34;&gt;George Cushen&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Released under the &lt;a href=&#34;https://github.com/gcushen/hugo-academic/blob/master/LICENSE.md&#34; target=&#34;_blank&#34;&gt;MIT&lt;/a&gt; license.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>A Person Re-Identification System For Mobile Devices</title>
      <link>/publication/person-re-identification/</link>
      <pubDate>Tue, 01 Sep 2015 00:00:00 -0500</pubDate>
      
      <guid>/publication/person-re-identification/</guid>
      <description>&lt;p&gt;More detail can easily be written here using &lt;em&gt;Markdown&lt;/em&gt; and $\rm \LaTeX$ math code.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
