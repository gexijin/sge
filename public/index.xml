<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>In Data We Trust on In Data We Trust</title>
    <link>/</link>
    <description>Recent content in In Data We Trust on In Data We Trust</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2018</copyright>
    <lastBuildDate>Sun, 15 Oct 2017 00:00:00 -0500</lastBuildDate>
    <atom:link href="/" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Preparing NIH grant proposals</title>
      <link>/post/preparing-nih-grant-proposals/</link>
      <pubDate>Sun, 08 Jul 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/preparing-nih-grant-proposals/</guid>
      <description>

&lt;p&gt;&lt;img src=&#34;/img/nih/nih.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;During the preparation of my NIH proposal in May 2018, I started a OneNote document to organize the information I gathered.  These are my notes and some tips.  Hope it can be useful to new investigators. I got lucky with NIH only once, so I am not that &amp;ldquo;seasoned&amp;rdquo;. This is based on my personal opinions, experiences, and lessons.&lt;/p&gt;

&lt;h2 id=&#34;1-suck-it-up-and-write-it&#34;&gt;1. Suck it up and write it&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;I use &lt;strong&gt;one Microsoft Word document&lt;/strong&gt; to write all the components: Project Summary, Narrative, Specific Aims, Research Strategy, References, Facilities, Equipment, Personnel justification, Resource Sharing Plan, &lt;em&gt;etc&lt;/em&gt;.  Start a new page for each component, so that you can print out only the pages for the component to a PDF file. Google &amp;ldquo;Print to PDF&amp;rdquo; if you do not know how to do it.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Save your Microsoft Word document often&lt;/strong&gt;, and create multiple copies with versions. Large files can get corrupted. Your hard drive can crash. Email yourself new versions as you write. Or use Google drive.  When things go wrong they tend to go wrong at the worst of time.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Write the summary and specific aims pages and ask for feedback from colleagues/friends&lt;/strong&gt;. If you don&amp;rsquo;t have a good &lt;strong&gt;idea&lt;/strong&gt;, &lt;strong&gt;preliminary data&lt;/strong&gt;, and a &lt;strong&gt;solid research plan&lt;/strong&gt;,  go back to your research work or literature reading.  Don&amp;rsquo;t waste weeks or months on an idea that has little chance. Go fishing, golfing, or jogging. You may have your aha moment!&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Grammarly&lt;/strong&gt;.com can help with grammatical issues, better than Word.  It works as a plug-in to Microsoft Word. But ask someone to proofread. I even had an undergraduate student read through my proposal and he was very helpful.&lt;/li&gt;
&lt;li&gt;Use &lt;strong&gt;EndNote&lt;/strong&gt; to manage references.&lt;/li&gt;
&lt;li&gt;The &lt;strong&gt;Project Summary and Specific Aims&lt;/strong&gt; are vital. I found it useful to &lt;strong&gt;read them aloud, over and over again&lt;/strong&gt;. If it sounds unnatural, try put it differently.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Cross-references&lt;/strong&gt; to Tables and Figures in Word is helpful but can be tricky.  You have to select the entire document and &amp;ldquo;Update Fields&amp;rdquo;.  I have a &amp;ldquo;(See Table 2)&amp;rdquo; in my proposal that looks great in Word. But when you print or generate PDFs, it becomes &amp;ldquo;(See &lt;strong&gt;Error! Reference source not found.&lt;/strong&gt;)&amp;ldquo;  Since it is buried on page 4, a grant specialist only found it after the proposal was submitted. We had to retract it at 4:15pm on the due date. Only to mess other things up. Then the computer decides to lock me out because I didn&amp;rsquo;t update my network password properly &amp;hellip;&lt;/li&gt;
&lt;li&gt;Get s&lt;strong&gt;upport letters and Biosketches from collaborators early&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Try not to fill in as much text in every square inch. Make it reader-friendly and organized. Less is more.&lt;/li&gt;
&lt;li&gt;Use short sentences.&lt;/li&gt;
&lt;li&gt;I found it more efficient to &lt;strong&gt;sleep well and keep playing tennis&lt;/strong&gt; throughout the process. A high-quality proposal demands sharp, focused, and creative minds. Somethings just cannot be accomplished by simply working &amp;ldquo;hard&amp;rdquo; overnight, as there is a lot of decision making, not simple mental labor.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;2-choose-an-award-mechanism&#34;&gt;2. Choose an award mechanism&lt;/h2&gt;

&lt;p&gt;According to &lt;a href=&#34;https://www.niaid.nih.gov/grants-contracts/research-project-grants&#34; target=&#34;_blank&#34;&gt;NIAID,&lt;/a&gt; &amp;ldquo;An R01 is a mature award that gives you four or five years of independent support, enough money (as well as time) to complete a project, publish results, and start writing your next application in time to get an award before the funding ends.&amp;rdquo; &lt;strong&gt;&amp;ldquo;If you have preliminary data, we recommend an R01.&amp;rdquo;&lt;/strong&gt; &amp;ldquo;Drawbacks for Smaller Awards (R21, R03) These awards are primarily for established investigators who want to complete a limited project, for example, a pilot or feasibility study. NIH did not design them to help you establish a research career. Nor are these smaller awards easy to get.&amp;rdquo; See NIH  &lt;a href=&#34;https://report.nih.gov/success_rates/&#34; target=&#34;_blank&#34;&gt;success rates&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&#34;3-set-a-deadline&#34;&gt;3. Set a deadline!&lt;/h2&gt;

&lt;p&gt;Most NIH grants have three cycles a year. &lt;a href=&#34;https://grants.nih.gov/grants/how-to-apply-application-guide/due-dates-and-submission-policies/due-dates.htm&#34; target=&#34;_blank&#34;&gt;Source&lt;/a&gt;
&lt;img src=&#34;/img/nih/dueDates.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;4-search-for-a-funding-opportunity&#34;&gt;4. Search for a funding opportunity&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Parent Announcements (PAs)&lt;/strong&gt;. NIH does not micromanage like NSF. Most NIH grant proposals are investigator-initiated. Many proposals are not responding to specific funding opportunities (RFPs/RFAs), but to generic PAs, such as the &lt;a href=&#34;https://grants.nih.gov/grants/guide/pa-files/PA-18-484.html&#34; target=&#34;_blank&#34;&gt;PA for R01&lt;/a&gt;, &lt;a href=&#34;https://grants.nih.gov/grants/guide/pa-files/PA-18-489.html&#34; target=&#34;_blank&#34;&gt; PA for R21,&lt;/a&gt; and   &lt;a href=&#34;https://grants.nih.gov/grants/guide/pa-files/PA-18-504.html&#34; target=&#34;_blank&#34;&gt;PA for R15.&lt;/a&gt;   These links as of June 2018. To get the most updated versions, I often just Google &amp;ldquo;&lt;strong&gt;NIH parent R01&lt;/strong&gt;&amp;rdquo;.  Note that not all NIH centers participate in all PAs.&lt;/li&gt;
&lt;li&gt;Funding opportunity announcements(FOAs)  by specific centers can be searched &lt;a href=&#34;https://grants.nih.gov/funding/index.htm&#34; target=&#34;_blank&#34;&gt;here&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;5. Page limits
&lt;img src=&#34;/img/nih/pageLimites.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;6-sample-applications-are-very-helpful&#34;&gt;6. Sample applications are very helpful&lt;/h2&gt;

&lt;p&gt;Take a quick look at these &lt;a href=&#34;https://www.niaid.nih.gov/grants-contracts/sample-applications&#34; target=&#34;_blank&#34;&gt;examples&lt;/a&gt;.  I learned a lot from them. It is much more efficient to learn from examples than reading the guidelines. If you know someone that has a successful proposal. Email him/her to ask for a copy. Many people share.&lt;/p&gt;

&lt;h2 id=&#34;7-use-proposal-guides-as-a-reference&#34;&gt;7. Use Proposal Guides as a reference&lt;/h2&gt;

&lt;p&gt;It is available as a &lt;a href=&#34;https://grants.nih.gov/grants/how-to-apply-application-guide/forms-d/general-forms-d.pdf&#34; target=&#34;_blank&#34;&gt;big PDF file&lt;/a&gt; or &lt;a href=&#34;https://grants.nih.gov/grants/how-to-apply-application-guide/forms-d/general/g.100-how-to-use-the-application-instructions.htm&#34; target=&#34;_blank&#34;&gt;section by section&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&#34;8-use-sciencv-to-generate-your-biosketch&#34;&gt;8. Use SciENcv to generate your biosketch&lt;/h2&gt;

&lt;p&gt;Most of us have old versions. But if your is a few years old, try &lt;a href=&#34;https://www.ncbi.nlm.nih.gov/sciencv/&#34; target=&#34;_blank&#34;&gt;SciENcv&lt;/a&gt;!  It generated an updated, nicely formatted biosketch with links to publications. And a link to all my papers on My NCBI&amp;rsquo;s  &lt;a href=&#34;https://www.ncbi.nlm.nih.gov/myncbi/&#34; target=&#34;_blank&#34;&gt;My Bibliography&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&#34;9-use-assisted-referral-tool-art-to-identify-csr-study-sections&#34;&gt;9. Use Assisted Referral Tool (ART) to identify CSR study sections&lt;/h2&gt;

&lt;p&gt;You paste your project summary to the &lt;a href=&#34;https://art.csr.nih.gov/ART/selection.jsp&#34; target=&#34;_blank&#34;&gt;ART tool,  &lt;/a&gt;and it recommends study sections and NIH Centers. I was surprised by how good this tool is. Hey, it is 2018! AI is everywhere. Specifying study sections and Centers are optional. This is one of the many reasons I like NIH. They make it easy for you.  NSF, on the other hand, is so complex with millions of funding opportunities to search for, billions of jargons to decode.&lt;/p&gt;

&lt;h2 id=&#34;10-submission&#34;&gt;10. Submission&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Develop a budget with the help of someone from the budget office. Or use their template Excel file.&lt;/li&gt;
&lt;li&gt;Start the institutional &lt;strong&gt;routing&lt;/strong&gt; process early.  You only need a summary and a budget.&lt;/li&gt;
&lt;li&gt;Log in to era&lt;strong&gt;&lt;a href=&#34;https://public.era.nih.gov/commons/&#34; target=&#34;_blank&#34;&gt; Commons&lt;/a&gt;&lt;/strong&gt;. Your institutions can create that for you.&lt;/li&gt;
&lt;li&gt;After logging in to era Commons&lt;strong&gt;,&lt;/strong&gt; use &lt;strong&gt;&lt;a href=&#34;https://public.era.nih.gov/assist&#34; target=&#34;_blank&#34;&gt;ASSIST&lt;/a&gt;  &lt;/strong&gt;to navigate the submission process.  Some helpful information on ASSIST is &lt;a href=&#34;https://era.nih.gov/erahelp/ASSIST/Default.htm&#34; target=&#34;_blank&#34;&gt;here&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Once you have a decent draft of the proposal, complete with all required components,  send it out to someone ( a colleague or a grand specialist) to help edit. &lt;strong&gt;While waiting for edits and feedbacks, start working on the forms&lt;/strong&gt;. Generate PDFs for all the components and upload them to ASSIST. Also,  fill in all the required forms. You may need some of the optional forms, like the Modular Budget.  Now you have a &lt;strong&gt;complete application package&lt;/strong&gt; that theoretically could be submitted.  Going forward, you only need to replace the key PDFs.&lt;/li&gt;
&lt;li&gt;Ask a grant specialist to check the application package for errors and compliance.  You can go back to revise your Word document.&lt;/li&gt;
&lt;li&gt;Try to finish everything two days before the deadline and let them submit.  Things can and will go wrong if everything is pushed down to the last hour.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;11-after-submission&#34;&gt;11. After submission&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;While you are working on it, your proposal is in &amp;ldquo;Work in Progress&amp;rdquo; status. It has an ID like &amp;ldquo;&lt;strong&gt;ASSIST 321779&lt;/strong&gt;&amp;rdquo;.  Make it into &amp;ldquo;Ready-for-submission&amp;rdquo; status, so that your signing official can do the actual submission.&lt;/li&gt;
&lt;li&gt;Once submitted, it is assigned a &lt;strong&gt;GRANTs.gov ID&lt;/strong&gt; like &amp;ldquo;&lt;strong&gt;GRANT12643962&lt;/strong&gt;&amp;rdquo;.  You will receive some automatic messages of status changes and error and warnings from both ASSIST and GRANTS.gov. These IDs are especially useful when you retracted an application, fixed the errors and re-submitted.&lt;/li&gt;
&lt;li&gt;ASSIST is just for submission. After submission, you check for status and error messages in the &lt;strong&gt;Status&lt;/strong&gt; menu in &lt;strong&gt;era Commons&lt;/strong&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Once submitted, relax and enjoy life. Try not to check the status every 5 minutes like me! You will not get a score until 4 months later (see the table below). If you get a decent score but not awarded, you can revise the proposal and try again in the next cycle. Similar to the way you revise papers, focus on addressing the criticisms, as the reviewers may be the same. This is another reason I like the NIH system. It is relatively quick.&lt;/p&gt;

&lt;p&gt;     At NSF, one of my proposals was listed as pending for 13 months with zero feedback. I only realized that my &amp;ldquo;no-news-is-good-news&amp;rdquo; mood was foolish after I emailed them! NSF program officers do not even return my emails sometimes. Sorry for a sore loser&amp;rsquo;s complaints. But the NIH system is relatively more friendly.&lt;/p&gt;

&lt;p&gt;  Please let me know if you have questions or different opinions by commenting below.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/img/nih/reviewCycle.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://grants.nih.gov/grants/how-to-apply-application-guide/due-dates-and-submission-policies/due-dates.htm&#34; target=&#34;_blank&#34;&gt;Link&lt;/a&gt;    Note: Picture is from &lt;a href=&#34;https://www.youtube.com/watch?v=j9BCvEo7J8s&#34; target=&#34;_blank&#34;&gt;https://www.youtube.com/watch?v=j9BCvEo7J8s&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Reproduce iDEP analyses with auto-generated R Markdown</title>
      <link>/post/reproducing-idep-analyses-with-auto-generated-r-markdown/</link>
      <pubDate>Sun, 08 Jul 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/reproducing-idep-analyses-with-auto-generated-r-markdown/</guid>
      <description>

&lt;p&gt;&lt;a href=&#34;http://bioinformatics.sdstate.edu/idep&#34; target=&#34;_blank&#34;&gt;iDEP&lt;/a&gt; is a tool for interactive analysis of RNA-Seq data. After analyzing their data, users have the option to download a R Markdown file, toegether with other data files, to reproduce the entire workflow. This blog is both the easiest and the hardest of all. It is easy because everything below was automatically generated by iDEP; it is hard as I have to write code to write code when developing iDEP.&lt;/p&gt;

&lt;h2 id=&#34;1-read-data&#34;&gt;1. Read data&lt;/h2&gt;

&lt;p&gt;R packages and iDEP core Functions.
    Users can also download the iDEP_core_functions.R file.
    Many R packages needs to be installed first. This may take hours.
    Each of these packages took years to develop.So be a patient thief. Sometimes dependencies needs to be installed manually.
    If you are using an older version of R, and having trouble with package installation,
    try un-install the current version of R, delete all folders and files, and  reinstall from scratch.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; if(file.exists(&#39;iDEP_core_functions.R&#39;))
    source(&#39;iDEP_core_functions.R&#39;) else 
    source(&#39;https://raw.githubusercontent.com/iDEP-SDSU/idep/master/shinyapps/idep/iDEP_core_functions.R&#39;) 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We are using the downloaded gene expression file where gene IDs has
    been converted to Ensembl gene IDs. This is because the ID conversion database is too large
    to download. You can use your original file if your file uses Ensembl ID, or you do not want
    to use the pathway files available in iDEP (or it is not available).&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; inputFile &amp;lt;- &#39;C:/Users/Xijin.Ge/Downloads/Downloaded_Converted_Data.csv&#39;  # Expression matrix
 sampleInfoFile &amp;lt;- &#39;C:/Users/Xijin.Ge/Downloads/Downloaded_sampleInfoFile.csv&#39; # Experiment design file 
 geneInfoFile &amp;lt;- &#39;C:/Users/Xijin.Ge/Downloads/Mouse__mmusculus_gene_ensembl_GeneInfo.csv&#39; #Gene symbols, location etc. 
 geneSetFile &amp;lt;- &#39;C:/Users/Xijin.Ge/Downloads/Mouse__mmusculus_gene_ensembl.db&#39;  # pathway database in SQL; can be GMT format 
 STRING10_speciesFile &amp;lt;- &#39;https://raw.githubusercontent.com/iDEP-SDSU/idep/master/shinyapps/idep/STRING10_species.csv&#39; 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Parameters for reading data&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; input_missingValue &amp;lt;- &#39;geneMedian&#39; #Missing values imputation method
 input_dataFileFormat &amp;lt;- 1  #1- read counts, 2 FKPM/RPKM or DNA microarray
 input_minCounts &amp;lt;- 0.5 #Min counts
 input_NminSamples &amp;lt;- 1 #Minimum number of samples 
 input_countsLogStart &amp;lt;- 4  #Pseudo count for log CPM
 input_CountsTransform &amp;lt;- 1 #Methods for data transformation of counts. 1-EdgeR&#39;s logCPM 2-VST, 3-rlog 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; readData.out &amp;lt;- readData(inputFile) 
 library(knitr)   #  install if needed. for showing tables with kable 
 kable( head(readData.out$data) )    # show the first few rows of data 
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p53_mock_1&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p53_mock_2&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p53_mock_3&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p53_mock_4&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p53_IR_1&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p53_IR_2&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p53_IR_3&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p53_IR_4&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;null_mock_1&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;null_mock_2&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;null_IR_1&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;null_IR_2&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;ENSMUSG00000075014&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.986190&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.245204&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.622005&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12.445437&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19.58986&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21.07925&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.279954&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17.40506&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13.23741&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12.91427&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.949322&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14.57512&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;ENSMUSG00000076617&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.174331&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.020764&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17.901045&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16.892389&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.06544&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.52019&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16.933927&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17.68636&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17.18909&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17.39665&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17.663020&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17.21374&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;ENSMUSG00000015656&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.349228&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.086274&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.392536&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14.817324&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.95674&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.75896&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16.233039&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16.04712&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.03582&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14.98886&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.603855&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17.00075&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;ENSMUSG00000052305&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13.766147&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.436670&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.523028&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.927563&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.57175&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.22625&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.125088&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.20851&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.81668&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17.59129&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.311098&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.82093&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;ENSMUSG00000069917&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13.511114&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.202619&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.240337&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.915347&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.33765&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.20676&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.280270&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.32910&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.51218&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17.41403&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.236792&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.73450&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;ENSMUSG00000075015&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.023733&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7.791965&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.161421&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.809036&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16.98655&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.47457&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.767006&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14.96939&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.59269&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.25800&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.742948&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12.00540&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; readSampleInfo.out &amp;lt;- readSampleInfo(sampleInfoFile) 
 kable( readSampleInfo.out )  
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;p53&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Treatment&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;p53_mock_1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;wt&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;mock&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;p53_mock_2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;wt&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;mock&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;p53_mock_3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;wt&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;mock&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;p53_mock_4&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;wt&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;mock&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;p53_IR_1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;wt&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;IR&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;p53_IR_2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;wt&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;IR&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;p53_IR_3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;wt&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;IR&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;p53_IR_4&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;wt&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;IR&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;null_mock_1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;null&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;mock&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;null_mock_2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;null&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;mock&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;null_IR_1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;null&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;IR&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;null_IR_2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;null&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;IR&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; input_selectOrg =&amp;quot;NEW&amp;quot; 
 input_selectGO &amp;lt;- &#39;KEGG&#39;   #Gene set category 
 input_noIDConversion = TRUE  
 allGeneInfo.out &amp;lt;- geneInfo(geneInfoFile) 
 converted.out = NULL 
 convertedData.out &amp;lt;- convertedData()    
 nGenesFilter()  
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;6882 genes in 12 samples. 6882  genes passed filter.\n Original gene IDs used.&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; convertedCounts.out &amp;lt;- convertedCounts()  # converted counts, just for compatibility 
 readCountsBias()  # detecting bias in sequencing depth 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;Warning! Sequencing depth bias detected. Total read counts are significantly different among sample groups (p= 1.04e-02 ) based on ANOVA.&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;2-pre-process&#34;&gt;2. Pre-process&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# Read counts per library 
 parDefault = par() 
 par(mar=c(12,4,2,2)) 
 # barplot of total read counts
 x &amp;lt;- readData.out$rawCounts
 groups = as.factor( detectGroups(colnames(x ) ) )
 if(nlevels(groups)&amp;lt;=1 | nlevels(groups) &amp;gt;20 )  
  col1 = &#39;green&#39;  else
  col1 = rainbow(nlevels(groups))[ groups ]             
         
 barplot( colSums(x)/1e6, 
        col=col1,las=3, main=&amp;quot;Total read counts (millions)&amp;quot;)  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; # Box plot 
 x = readData.out$data 
 boxplot(x, las = 2, col=col1,
    ylab=&#39;Transformed expression levels&#39;,
    main=&#39;Distribution of transformed data&#39;) 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-8-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; #Density plot 
 par(parDefault) 
 densityPlot()       
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-9-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; # Scatter plot of the first two samples 
 plot(x[,1:2],xlab=colnames(x)[1],ylab=colnames(x)[2], 
    main=&#39;Scatter plot of first two samples&#39;) 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-10-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; ####plot gene or gene family
 input_selectOrg =&amp;quot;BestMatch&amp;quot; 
 input_geneSearch &amp;lt;- &#39;HOXA&#39; #Gene ID for searching 
 genePlot()  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-11-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; input_useSD &amp;lt;- &#39;FALSE&#39; #Use standard deviation instead of standard error in error bar? 
 geneBarPlotError()       
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-12-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;3-heatmap&#34;&gt;3. Heatmap&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; # hierarchical clustering tree
 x &amp;lt;- readData.out$data
 maxGene &amp;lt;- apply(x,1,max)
 # remove bottom 25% lowly expressed genes, which inflate the PPC
 x &amp;lt;- x[which(maxGene &amp;gt; quantile(maxGene)[1] ) ,] 
 plot(as.dendrogram(hclust2( dist2(t(x)))), ylab=&amp;quot;1 - Pearson C.C.&amp;quot;, type = &amp;quot;rectangle&amp;quot;) 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-13-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; #Correlation matrix
 input_labelPCC &amp;lt;- TRUE #Show correlation coefficient? 
 correlationMatrix() 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-14-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; # Parameters for heatmap
 input_nGenes &amp;lt;- 1000   #Top genes for heatmap
 input_geneCentering &amp;lt;- TRUE    #centering genes ?
 input_sampleCentering &amp;lt;- FALSE #Center by sample?
 input_geneNormalize &amp;lt;- FALSE   #Normalize by gene?
 input_sampleNormalize &amp;lt;- FALSE #Normalize by sample?
 input_noSampleClustering &amp;lt;- FALSE  #Use original sample order
 input_heatmapCutoff &amp;lt;- 4   #Remove outliers beyond number of SDs 
 input_distFunctions &amp;lt;- 1   #which distant funciton to use
 input_hclustFunctions &amp;lt;- 1 #Linkage type
 input_heatColors1 &amp;lt;- 1 #Colors
 input_selectFactorsHeatmap &amp;lt;- &#39;Sample_Name&#39;    #Sample coloring factors 
 #png(&#39;heatmap.png&#39;, width = 10, height = 15, units = &#39;in&#39;, res = 300) 
 #staticHeatmap() 
 #dev.off()  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/img/heatmap.png&#34; alt=&#34;heatmap&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# heatmapPlotly() # interactive heatmap using Plotly 
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;4-k-means-clustering&#34;&gt;4. K-means clustering&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; input_nGenesKNN &amp;lt;- 2000    #Number of genes fro k-Means
 input_nClusters &amp;lt;- 4   #Number of clusters 
 maxGeneClustering = 12000
 input_kmeansNormalization &amp;lt;- &#39;geneMean&#39;    #Normalization
 input_KmeansReRun &amp;lt;- 0 #Random seed 

 distributionSD()  #Distribution of standard deviations 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-17-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; KmeansNclusters()  #Number of clusters 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-18-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; Kmeans.out = Kmeans()   #Running K-means 
 KmeansHeatmap()   #Heatmap for k-Means 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-19-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; #Read gene sets for enrichment analysis 
 sqlite  &amp;lt;- dbDriver(&#39;SQLite&#39;)
 input_selectGO3 &amp;lt;- &#39;GOBP&#39;  #Gene set category
 input_minSetSize &amp;lt;- 15 #Min gene set size
 input_maxSetSize &amp;lt;- 2000   #Max gene set size 
 GeneSets.out &amp;lt;-readGeneSets( geneSetFile,
    convertedData.out, input_selectGO3,input_selectOrg,
    c(input_minSetSize, input_maxSetSize)  )  
 # Alternatively, users can use their own GMT files by
 #GeneSets.out &amp;lt;- readGMTRobust(&#39;somefile.GMT&#39;)  
 results &amp;lt;- KmeansGO()  #Enrichment analysis for k-Means clusters   
 results$adj.Pval &amp;lt;- format( results$adj.Pval,digits=3 )
 kable( results, row.names=FALSE) 
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;Cluster&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;adj.Pval&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Genes&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Pathways&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.69e-144&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;121&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;RNA processing&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.99e-140&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;106&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Ribonucleoprotein complex biogenesis&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.29e-134&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;103&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NcRNA metabolic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3.50e-117&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;84&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Ribosome biogenesis&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6.34e-115&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;84&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NcRNA processing&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3.48e-107&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;144&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Organonitrogen compound metabolic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.71e-101&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;119&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Organonitrogen compound biosynthetic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6.86e-93&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;65&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;RRNA processing&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.89e-92&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;65&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;RRNA metabolic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.05e-75&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;74&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Translation&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.08e-25&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;36&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Cellular response to stress&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4.56e-23&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;36&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Apoptotic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4.56e-23&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;37&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Cell death&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.85e-23&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;36&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Programmed cell death&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.85e-23&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;25&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Apoptotic signaling pathway&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.23e-20&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;24&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Positive regulation of cell death&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.44e-20&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;23&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Cellular response to DNA damage stimulus&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3.58e-19&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;18&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Intrinsic apoptotic signaling pathway&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.01e-18&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;22&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Positive regulation of programmed cell death&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.18e-18&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;14&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Intrinsic apoptotic signaling pathway in response to DNA damage&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;C&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.39e-63&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;115&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Immune system process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;8.23e-45&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;86&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Positive regulation of response to stimulus&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.18e-44&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;76&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Immune response&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.51e-42&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;81&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Establishment of protein localization&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7.23e-42&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;76&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Macromolecular complex assembly&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.29e-40&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;69&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Regulation of immune system process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.29e-40&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;69&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Protein complex assembly&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.29e-40&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;75&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Protein transport&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.29e-40&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;69&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Protein complex biogenesis&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.29e-40&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;72&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Protein complex subunit organization&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;D&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;9.62e-94&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;147&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Immune system process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6.16e-55&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;99&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Positive regulation of response to stimulus&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.38e-52&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;93&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Positive regulation of molecular function&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6.50e-52&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;93&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Protein phosphorylation&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.86e-51&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;84&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Defense response&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7.25e-51&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;86&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Regulation of intracellular signal transduction&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.02e-49&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;72&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Cell activation&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.24e-47&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;88&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Regulation of transport&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.00e-46&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;95&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Response to external stimulus&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.13e-46&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;73&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Vesicle-mediated transport&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; input_seedTSNE &amp;lt;- 0    #Random seed for t-SNE
 input_colorGenes &amp;lt;- TRUE   #Color genes in t-SNE plot? 
 tSNEgenePlot()  #Plot genes using t-SNE 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## Warning: package &#39;Rtsne&#39; was built under R version 3.5.1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-21-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;5-pca-and-beyond&#34;&gt;5. PCA and beyond&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; input_selectFactors &amp;lt;- &#39;Sample_Name&#39;   #Factor coded by color
 input_selectFactors2 &amp;lt;- &#39;Sample_Name&#39;  #Factor coded by shape
 input_tsneSeed2 &amp;lt;- 0   #Random seed for t-SNE 
 #PCA, MDS and t-SNE plots
 PCAplot()  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-22-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; MDSplot() 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-23-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; tSNEplot()  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-24-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; #Read gene sets for pathway analysis using PGSEA on principal components 
 input_selectGO6 &amp;lt;- &#39;GOBP&#39; 
 GeneSets.out &amp;lt;-readGeneSets( geneSetFile,
    convertedData.out, input_selectGO6,input_selectOrg,
    c(input_minSetSize, input_maxSetSize)  )  
 PCApathway() # Run PGSEA analysis 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-25-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; cat( PCA2factor() )   #The correlation between PCs with factors 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## 
##  Correlation between Principal Components (PCs) with factors
## PC1 is correlated with Treatment (p=6.56e-05).
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;6-differentially-expressed-genes-deg1&#34;&gt;6. Differentially Expressed Genes (DEG1)&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; input_CountsDEGMethod &amp;lt;- 3 #DESeq2= 3,limma-voom=2,limma-trend=1 
 input_limmaPval &amp;lt;- 0.1 #FDR cutoff
 input_limmaFC &amp;lt;- 2 #Fold-change cutoff
 input_selectModelComprions &amp;lt;- c(&#39;p53: wt vs. null&#39;,&#39;Treatment: IR vs. mock&#39;)   #Selected comparisons
 input_selectFactorsModel &amp;lt;- c(&#39;p53&#39;,&#39;Treatment&#39;)   #Selected comparisons
 input_selectInteractions &amp;lt;- &#39;p53:Treatment&#39;    #Selected comparisons
 input_selectBlockFactorsModel &amp;lt;- NULL  #Selected comparisons
 factorReferenceLevels.out &amp;lt;- c(&#39;p53:null&#39;,&#39;Treatment:mock&#39;) 

 limma.out &amp;lt;- limma()
 DEG.data.out &amp;lt;- DEG.data()
 limma.out$comparisons 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;wt-null&amp;quot;               &amp;quot;IR-mock&amp;quot;               &amp;quot;I:p53_wt.Treatment_IR&amp;quot;
## [4] &amp;quot;wt-null_for_IR&amp;quot;        &amp;quot;IR-mock_for_wt&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; input_selectComparisonsVenn = limma.out$comparisons[1:3] # use first three comparisons
 input_UpDownRegulated &amp;lt;- FALSE #Split up and down regulated genes 
 vennPlot() # Venn diagram 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-28-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;  sigGeneStats() # number of DEGs as figure 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-29-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;  sigGeneStatsTable() # number of DEGs as table 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##                                 Comparisons   Up Down
## wt-null                             wt-null   20   16
## IR-mock                             IR-mock 1532  702
## I:p53_wt-Treatment_IR I:p53_wt-Treatment_IR  694  478
## wt-null_for_IR               wt-null_for_IR 1118  577
## IR-mock_for_wt               IR-mock_for_wt 1856  487
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;7-differentially-expressed-genes-deg1&#34;&gt;7. Differentially Expressed Genes (DEG1)&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; input_selectContrast &amp;lt;- &#39;I:p53_wt.Treatment_IR&#39;    #Selected comparisons 
 selectedHeatmap.data.out &amp;lt;- selectedHeatmap.data()
 selectedHeatmap()   # heatmap for DEGs in selected comparison
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-31-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; # Save gene lists and data into files
 write.csv( selectedHeatmap.data()$genes, &#39;heatmap.data.csv&#39;) 
 write.csv(DEG.data(),&#39;DEG.data.csv&#39; )
 write(AllGeneListsGMT() ,&#39;AllGeneListsGMT.gmt&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; input_selectGO2 &amp;lt;- &#39;GSKB.TF.Target&#39;    #Gene set category 
 geneListData.out &amp;lt;- geneListData()  
 volcanoPlot()  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-32-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# scatterPlot()  
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;  MAplot()  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-34-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;  geneListGOTable.out &amp;lt;- geneListGOTable()  
 # Read pathway data again 
 GeneSets.out &amp;lt;-readGeneSets( geneSetFile,
    convertedData.out, input_selectGO2,input_selectOrg,
    c(input_minSetSize, input_maxSetSize)  ) 
 input_removeRedudantSets &amp;lt;- TRUE   #Remove highly redundant gene sets? 
 results &amp;lt;- geneListGO()  #Enrichment analysis for k-Means clusters 
 results$adj.Pval &amp;lt;- format( results$adj.Pval,digits=3 )
 kable( results, row.names=FALSE) 
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;Direction&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;adj.Pval&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;nGenes&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Pathways&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;Down regulated&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3.3e-61&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;95&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Organonitrogen compound metabolic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4.8e-53&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;84&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Small molecule metabolic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.2e-51&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;75&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Cell cycle&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.4e-48&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;62&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DNA metabolic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3.4e-45&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;67&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Organonitrogen compound biosynthetic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6.7e-45&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;61&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Cell cycle process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7.2e-43&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;71&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Macromolecular complex assembly&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.5e-40&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;68&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Cellular response to stress&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3.0e-40&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;52&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Mitotic cell cycle&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7.6e-39&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;49&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Mitotic cell cycle process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;Up regulated&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6.0e-41&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;82&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Tissue development&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6.8e-39&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;79&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Regulation of transcription from RNA polymerase II promoter&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6.8e-39&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;80&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Transcription from RNA polymerase II promoter&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6.8e-39&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;85&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Apoptotic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6.8e-39&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;84&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Cell development&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.5e-38&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;85&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Programmed cell death&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7.7e-38&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;86&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Cell death&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.1e-37&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;78&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Positive regulation of nitrogen compound metabolic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.5e-36&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;74&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Positive regulation of nucleobase-containing compound metabolic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.3e-35&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;86&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Cellular response to organic substance&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;STRING-db API access.
    We need to find the taxonomy id of your species, this used by STRING.
  First we try to guess the ID based on iDEP&amp;rsquo;s database. Users can also skip this step and assign NCBI taxonomy id directly by
  findTaxonomyID.out = 10090 # mouse 10090, human 9606 etc.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; STRING10_species = read.csv(STRING10_speciesFile)  
 ix = grep(&#39;Mus musculus&#39;, STRING10_species$official_name )
 findTaxonomyID.out &amp;lt;- STRING10_species[ix,1] # find taxonomyID
 findTaxonomyID.out  
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## [1] 10090
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Enrichment analysis using STRING&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;  STRINGdb_geneList.out &amp;lt;- STRINGdb_geneList() #convert gene lists
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## Warning:  we couldn&#39;t map to STRING 8% of your identifiers
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; input_STRINGdbGO &amp;lt;- &#39;Process&#39;  #&#39;Process&#39;, &#39;Component&#39;, &#39;Function&#39;, &#39;KEGG&#39;, &#39;Pfam&#39;, &#39;InterPro&#39; 
 results &amp;lt;- stringDB_GO_enrichmentData()  # enrichment using STRING 
 results$adj.Pval &amp;lt;- format( results$adj.Pval,digits=3 )
 kable( results, row.names=FALSE) 
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;Direction&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;adj.Pval&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;nGenes&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Pathways&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;Up regulated&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4.5e-11&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;66&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;intracellular signal transduction&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.6e-10&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;51&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;apoptotic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4.5e-10&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;51&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;programmed cell death&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;9.8e-10&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;51&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;cell death&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;9.8e-10&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;51&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;death&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.2e-09&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;71&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;tissue development&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4.1e-09&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;26&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;apoptotic signaling pathway&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.2e-09&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;intrinsic apoptotic signaling pathway&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;9.7e-09&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;intrinsic apoptotic signaling pathway in response to DNA damage&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.7e-08&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;58&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;regulation of apoptotic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3.2e-08&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;65&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;cell development&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3.7e-08&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;62&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;positive regulation of molecular function&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.2e-08&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;47&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;negative regulation of signal transduction&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.2e-08&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;62&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;cell surface receptor signaling pathway&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.2e-08&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;57&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;regulation of programmed cell death&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;Down regulated&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.2e-15&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;60&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;cell cycle&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.2e-15&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;25&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;protein folding&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3.1e-14&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;65&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;small molecule metabolic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3.1e-14&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;33&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;small molecule biosynthetic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.1e-13&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;53&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;single-organism biosynthetic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3.4e-13&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;61&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;organonitrogen compound metabolic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.2e-13&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;46&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;organonitrogen compound biosynthetic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.4e-12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;38&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;mitotic cell cycle&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.4e-12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;46&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;cell cycle process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3.1e-12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;37&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;mitotic cell cycle process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7.6e-12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;30&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ncRNA metabolic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.8e-11&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;organic acid biosynthetic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.8e-11&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;carboxylic acid biosynthetic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.0e-11&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;33&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;cell division&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;8.6e-11&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;37&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DNA metabolic process&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;PPI network retrieval and analysis&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; input_nGenesPPI &amp;lt;- 100 #Number of top genes for PPI retrieval and analysis 
 stringDB_network1(1) #Show PPI network 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-38-1.png&#34; width=&#34;672&#34; /&gt;
Generating interactive PPI&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; write(stringDB_network_link(), &#39;PPI_results.html&#39;) # write results to html file 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## Warning:  we couldn&#39;t map to STRING 8% of your identifiers
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; browseURL(&#39;PPI_results.html&#39;) # open in browser 
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;8-pathway-analysis&#34;&gt;8. Pathway analysis&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; input_selectContrast1 &amp;lt;- &#39;I:p53_wt.Treatment_IR&#39;   #select Comparison 
 #input_selectContrast1 = limma.out$comparisons[3] # manually set
 input_selectGO &amp;lt;- &#39;KEGG&#39;   #Gene set category 
 #input_selectGO=&#39;custom&#39; # if custom gmt file
 input_minSetSize &amp;lt;- 15 #Min size for gene set
 input_maxSetSize &amp;lt;- 2000   #Max size for gene set 
 # Read pathway data again 
 GeneSets.out &amp;lt;-readGeneSets( geneSetFile,
    convertedData.out, input_selectGO,input_selectOrg,
    c(input_minSetSize, input_maxSetSize)  ) 
 input_pathwayPvalCutoff &amp;lt;- 0.2 #FDR cutoff
 input_nPathwayShow &amp;lt;- 30   #Top pathways to show
 input_absoluteFold &amp;lt;- FALSE    #Use absolute values of fold-change?
 input_GenePvalCutoff &amp;lt;- 1  #FDR to remove genes 

 input_pathwayMethod = 1  # 1  GAGE
 gagePathwayData.out &amp;lt;- gagePathwayData()  # pathway analysis using GAGE  
   
 results &amp;lt;- gagePathwayData.out  #Enrichment analysis for k-Means clusters  
 results$adj.Pval &amp;lt;- format( results$adj.Pval,digits=3 )
 kable( results, row.names=FALSE) 
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;Direction&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;GAGE  analysis: I:p53_wt.Treatment_IR&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;statistic&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Genes&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;adj.Pval&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;Down&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Ribosome biogenesis in eukaryotes&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-4.6634&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;40&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.3e-03&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;RNA transport&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-4.2098&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;62&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.9e-03&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Spliceosome&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-4.0557&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;39&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4.5e-03&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Protein processing in endoplasmic reticulum&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-3.9119&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;54&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4.5e-03&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Metabolic pathways&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-3.7276&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;449&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4.5e-03&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;DNA replication&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-3.4728&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3.5e-02&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Proteasome&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-3.221&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4.1e-02&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Aminoacyl-tRNA biosynthesis&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-3.2197&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.0e-02&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Pyrimidine metabolism&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-3.1178&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;50&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4.0e-02&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Biosynthesis of amino acids&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-3.1022&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;32&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4.1e-02&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Carbon metabolism&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-2.9154&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;47&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.0e-02&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Oxidative phosphorylation&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-2.5729&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;46&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.1e-01&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Ribosome&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-2.5555&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;28&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.2e-01&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Oocyte meiosis&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-2.5519&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;39&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.1e-01&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Progesterone-mediated oocyte maturation&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;-2.2879&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;27&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2.0e-01&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; pathwayListData.out = pathwayListData() 
 enrichmentPlot(pathwayListData.out, 25  ) 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## Warning: package &#39;dendextend&#39; was built under R version 3.5.1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-41-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;  enrichmentNetwork(pathwayListData.out )  
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## Warning: package &#39;igraph&#39; was built under R version 3.5.1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-42-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;#  enrichmentNetworkPlotly(pathwayListData.out) 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; input_pathwayMethod = 3  # 1  fgsea 
 fgseaPathwayData.out &amp;lt;- fgseaPathwayData() #Pathway analysis using fgsea 
 results &amp;lt;- fgseaPathwayData.out  #Enrichment analysis for k-Means clusters 
 results$adj.Pval &amp;lt;- format( results$adj.Pval,digits=3 )
 kable( results, row.names=FALSE) 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;  pathwayListData.out = pathwayListData() 
 enrichmentPlot(pathwayListData.out, 25  ) 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-45-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;  enrichmentNetwork(pathwayListData.out )  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-46-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;#  enrichmentNetworkPlotly(pathwayListData.out) 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;   PGSEAplot() # pathway analysis using PGSEA 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## 
## Computing P values using ANOVA
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-48-1.png&#34; width=&#34;864&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;9-chromosome&#34;&gt;9. Chromosome&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; input_selectContrast2 &amp;lt;- &#39;IR-mock_for_wt&#39;  #select Comparison 
 #input_selectContrast2 = limma.out$comparisons[3] # manually set
 input_limmaPvalViz &amp;lt;- 0.1  #FDR to filter genes
 input_limmaFCViz &amp;lt;- 2  #FDR to filter genes 
# genomePlotly() # shows fold-changes on the genome 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/img/genome.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;10-biclustering&#34;&gt;10. Biclustering&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; input_nGenesBiclust &amp;lt;- 1000    #Top genes for biclustering
 input_biclustMethod &amp;lt;- &#39;BCCC()&#39;    #Method: &#39;BCCC&#39;, &#39;QUBIC&#39;, &#39;runibic&#39; ... 
 biclustering.out = biclustering()  # run analysis
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## Warning: package &#39;biclust&#39; was built under R version 3.5.1
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; input_selectBicluster &amp;lt;- 1 #select a cluster 
 biclustHeatmap()   # heatmap for selected cluster 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-50-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; input_selectGO4 &amp;lt;- &#39;GOBP&#39;  #Gene set category 
 # Read pathway data again 
 GeneSets.out &amp;lt;-readGeneSets( geneSetFile,
    convertedData.out, input_selectGO4,input_selectOrg,
    c(input_minSetSize, input_maxSetSize)  )  
 results &amp;lt;- geneListBclustGO()  #Enrichment analysis for k-Means clusters   
 results$adj.Pval &amp;lt;- format( results$adj.Pval,digits=3 )
 kable( results, row.names=FALSE) 
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;adj.Pval&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Genes&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Pathways&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;3.1e-124&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;207&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Immune system process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;1.5e-89&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;157&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Organonitrogen compound metabolic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;4.7e-86&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;148&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Positive regulation of molecular function&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;5.4e-86&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;155&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Cell death&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;2.0e-83&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;139&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Homeostatic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;3.2e-81&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;136&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Macromolecular complex assembly&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;3.5e-80&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;146&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Programmed cell death&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;2.9e-79&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;144&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Apoptotic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;1.1e-75&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;132&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Regulation of cell death&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;2.2e-75&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;117&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Cell-cell adhesion&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&#34;11-co-expression-network&#34;&gt;11. Co-expression network&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; input_mySoftPower &amp;lt;- 5 #SoftPower to cutoff
 input_nGenesNetwork &amp;lt;- 1000    #Number of top genes
 input_minModuleSize &amp;lt;- 20  #Module size minimum 
 wgcna.out = wgcna()   # run WGCNA  
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## ==========================================================================
## *
## *  Package WGCNA 1.63 loaded.
## *
## *    Important note: It appears that your system supports multi-threading,
## *    but it is not enabled within WGCNA in R. 
## *    To allow multi-threading within WGCNA with all available cores, use 
## *
## *          allowWGCNAThreads()
## *
## *    within R. Use disableWGCNAThreads() to disable threading if necessary.
## *    Alternatively, set the following environment variable on your system:
## *
## *          ALLOW_WGCNA_THREADS=&amp;lt;number_of_processors&amp;gt;
## *
## *    for example 
## *
## *          ALLOW_WGCNA_THREADS=8
## *
## *    To set the environment variable in linux bash shell, type 
## *
## *           export ALLOW_WGCNA_THREADS=8
## *
## *     before running R. Other operating systems or shells will
## *     have a similar command to achieve the same aim.
## *
## ==========================================================================
## 
## 
##    Power SFT.R.sq   slope truncated.R.sq mean.k. median.k. max.k.
## 1      1   0.9720  2.7600          0.966   572.0     612.0    711
## 2      2   0.9490  1.2200          0.956   412.0     449.0    578
## 3      3   0.9050  0.7070          0.923   325.0     353.0    495
## 4      4   0.7480  0.4190          0.797   269.0     287.0    439
## 5      5   0.5350  0.2490          0.615   230.0     239.0    398
## 6      6   0.1820  0.1090          0.255   200.0     204.0    367
## 7      7   0.0040  0.0131          0.185   178.0     175.0    342
## 8      8   0.0965 -0.0738          0.144   160.0     152.0    321
## 9      9   0.2500 -0.1240          0.238   145.0     133.0    303
## 10    10   0.4570 -0.1930          0.431   132.0     118.0    287
## 11    12   0.5670 -0.2940          0.514   113.0      98.9    263
## 12    14   0.6340 -0.3830          0.587    97.8      84.7    243
## 13    16   0.6890 -0.4420          0.655    86.2      73.5    227
## 14    18   0.7120 -0.4930          0.673    76.9      63.8    213
## 15    20   0.7290 -0.5420          0.683    69.3      55.7    201
## TOM calculation: adjacency..
## ..will not use multithreading.
##  Fraction of slow calculations: 0.000000
## ..connectivity..
## ..matrix multiplication (system BLAS)..
## ..normalization..
## ..done.
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; softPower()  # soft power curve 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-53-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;  modulePlot()  # plot modules  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-54-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;  listWGCNA.Modules.out = listWGCNA.Modules() #modules
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; input_selectGO5 &amp;lt;- &#39;GOBP&#39;  #Gene set category 
 # Read pathway data again 
 GeneSets.out &amp;lt;-readGeneSets( geneSetFile,
    convertedData.out, input_selectGO5,input_selectOrg,
    c(input_minSetSize, input_maxSetSize)  ) 
 input_selectWGCNA.Module &amp;lt;- &#39;1. turquoise (495 genes)&#39; #Select a module
 input_topGenesNetwork &amp;lt;- 10    #SoftPower to cutoff
 input_edgeThreshold &amp;lt;- 0.4 #Number of top genes 
 moduleNetwork()    # show network of top genes in selected module
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##  softConnectivity: FYI: connecitivty of genes with less than 4 valid samples will be returned as NA.
##  ..calculating connectivities..
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-08-reproducing-idep-analyses-with-auto-generated-r-markdown_files/figure-html/unnamed-chunk-55-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt; input_removeRedudantSets &amp;lt;- TRUE   #Remove redundant gene sets 
 results &amp;lt;- networkModuleGO()  #Enrichment analysis of selected module
 results$adj.Pval &amp;lt;- format( results$adj.Pval,digits=3 )
 kable( results, row.names=FALSE) 
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;adj.Pval&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Genes&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Pathways&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;6.2e-68&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;106&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Organonitrogen compound metabolic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;3.0e-62&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;61&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Ribonucleoprotein complex biogenesis&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;6.9e-62&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;68&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;RNA processing&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;4.0e-61&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;84&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Organonitrogen compound biosynthetic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;2.4e-56&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;57&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NcRNA metabolic process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;4.2e-53&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;101&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Immune system process&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;2.0e-49&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;81&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Macromolecular complex assembly&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;3.0e-48&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;46&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Ribosome biogenesis&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;3.4e-48&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;84&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Establishment of protein localization&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;4.7e-48&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;63&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Cellular amide metabolic process&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
</description>
    </item>
    
    <item>
      <title>Teaching R to High School Students</title>
      <link>/post/teaching-r-and-data-science-to-high-school-students/</link>
      <pubDate>Sun, 08 Jul 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/teaching-r-and-data-science-to-high-school-students/</guid>
      <description>&lt;p&gt;&lt;img src=&#34;/img/camp/image004.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://www.sdstate.edu/news/2018/06/students-learn-programming-app-development-camp?utm_source=hs_email&amp;amp;utm_medium=email&amp;amp;utm_content=64144462&amp;amp;_hsenc=p2ANqtz-_GMx-lha6-Yk5VVMEPWiMRcfAioHOCnUazL8YSbb0v3uOtt6tQmg33g99AH3R7xlkX4DHIaCWb6zyNquolgksVAvhEjw&amp;amp;_hsmi=64144462&#34; target=&#34;_blank&#34;&gt;Press release&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thirteen high school students from across the state participated in this year’s Data Analytics Camp at South Dakota State University (SDSU)  main campus from June 18th to 21st, 2018. There were six girls and seven boys. The students lived in college student’s dorms for four days. Most learning activities were in a computer lab in Solberg Hall. As most college students are away during the summer, the high school students got to use a lot of facilities and services. Funding from National Science Foundation (NSF) enabled us to provide lodging, food, and all activities free of charge to the students. The goal of this camp is to promote STEM education, especially in girls.&lt;/p&gt;

&lt;p&gt;The students learned programming in the R language to analyze data and created web applications. Instead of the traditional way of explaining the data structures and rules, I followed learning from example approach. I just showed them examples of how I use R to analyze data. After 5 hours of a crash course, the students wrote their own code to solve real problems for their project.&lt;/p&gt;

&lt;p&gt;The presentations of their projects on Thursday went well, and they achieved a lot during a very short amount of time. They found many interesting data sets online. They analyzed data sets related to the climate, video game sales, exoplanets, high-school debates, and wars. Using the Shiny technology that can turn R code into web apps, some students created websites. The &lt;a href=&#34;http://camp.shinyapps.io/VideoGames/&#34; target=&#34;_blank&#34;&gt;Video Game Sales App&lt;/a&gt; shows that correlation between critics score and sales varies significantly among genres. The &lt;a href=&#34;https://camp.shinyapps.io/Noah_Klock/&#34; target=&#34;_blank&#34;&gt;Wars of the World&lt;/a&gt; reveals the statistics of wars from 1800s to today. The &lt;a href=&#34;https://camp.shinyapps.io/StateTemperatures/&#34; target=&#34;_blank&#34;&gt;State Temperature app&lt;/a&gt; shows the historical temperatures recordings across the world.&lt;/p&gt;

&lt;p&gt;Although not online yet, the Debate Spyder app is a complex Shiny app created by 4 students from Brookings High School. Complete with user log-in and password, it enables students to retrieve debate data from a national database, analyze their opponent and calculates a threat score. Even though one of the team members has programming experience with other languages, it is remarkable that a group of high school students with zero programming experience in R can accomplish something like this in just three and half days. The website is practically useful to any students that participate in debates.&lt;/p&gt;

&lt;p&gt;The ability for young minds to learn coding to solve problems so quickly is truly amazing. The project-lead strategy obviously helps. Another factor is that these students are probably all self-selected star students from their schools. They were well-behaved, motivated, and engaged in the classroom and beyond. Amidst many depressing and confusing news headlines these days, interacting with this group of students made me feel hopeful about our future.&lt;/p&gt;

&lt;p&gt;Between classes, we invite guest speakers working in analytics related fields. Dr. Kurt Cogswell, head of the Math/Stat department, talked about how Data Scientists consistently ranked #1 in the best jobs by various career websites. Ms. Kelly Crevier, Business Intelligence Manager at First Bank and Trust, talked about how analytics help make her employer be more efficient and detect frauds. Dr. Valerie Bares, Senior Biostatistician at Sanford Research, drove down from Sioux Falls to discuss how she used mathematics and statistics to help find cures and treatments for various diseases. She also demonstrated a Shiny app for collecting survey data. We purposely invited these two women as local role models for girls towards STEM fields. Dr. Cedric Neumann, assistant professor at SDSU Math/Stat department, talked about how math and analytics help solve crimes by analyzing fingerprints. Dr. Gary Hatfield, Associate Professor in the department, spoke about how spatial data are gathered and took the students on a walk across the campus using GPS coordinates. Dr. Teresa Hall, head of the Construction Management Department, arranged a tour of the engineering facilities, including cool 3D printers.&lt;/p&gt;

&lt;p&gt;The students spend as much time doing fun activities as they do in the classroom. Some activities reinforce statistics concepts. They counted chocolate chips on cookies and analyzed the difference between two brands of cookies. They observed the statistical difference in their pulses before and after climbing the campanile. Other fun activities include twisting balloons and climbing the rock wall in the wellness center. They also visited the dairy bar and enjoyed world famous SDSU ice cream. Tuesday night is the movie night, and they enjoyed a movie at the Brookings Cinema 5 theatre. On Wednesday night, some watched a play at the Prairie Repertory Theatre.&lt;/p&gt;

&lt;p&gt;Dr. Adam Hoppe, Director of the &lt;a href=&#34;http://biosntr.org/&#34; target=&#34;_blank&#34;&gt;BioSNTR&lt;/a&gt; that directly funded this camp, gave closing remarks and presented awards for students.&lt;/p&gt;

&lt;p&gt;As their instructor, I also learned a lot from them. As they used some of the advanced techniques after showing an example, I will change the way how I teach my class on R programming for undergraduate and graduate students. Many of the datasets they found will be used in my class this fall.&lt;/p&gt;

&lt;p&gt;“If you can learn this much in three and half days, what can you potentially achieve during the rest of this summer? Don’t just watch Netflix, go save the world!” This was my challenge to them at the end.&lt;/p&gt;

&lt;p&gt;After the camp, some students said that this camp made them think differently about their career path.&lt;/p&gt;

&lt;p&gt;Bill Alsaker, an instructor in the department, is an essential part of the camp helping everything from chaperone at the dorm, teach how to use Excel to statistics activities. Linda Wendt and Jianli Qi, Becky Pistulka helped tremendously in advertising, communications, food, and lodging.&lt;/p&gt;

&lt;p&gt;Next year’s camp will be announced at a &lt;a href=&#34;https://www.facebook.com/SDSUDataAnalytics/&#34; target=&#34;_blank&#34;&gt;Facebook page:&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The camp is supported by &lt;a href=&#34;http://biosntr.org/&#34; target=&#34;_blank&#34;&gt;BioSNTR&lt;/a&gt;, an &lt;a href=&#34;https://www.nsf.gov/&#34; target=&#34;_blank&#34;&gt;NSF&lt;/a&gt;-funded virtual research center part of &lt;a href=&#34;http://sdepscor.org/&#34; target=&#34;_blank&#34;&gt;SD EPSCoR&lt;/a&gt;, with help from the &lt;a href=&#34;https://www.sdstate.edu/mathematics-statistics&#34; target=&#34;_blank&#34;&gt;Department Mathematics and Statistics&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/img/camp/image006.png&#34; alt=&#34;er&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Vitiligo Treatment Protocols</title>
      <link>/post/vitiligo-treatment-protocols/</link>
      <pubDate>Sun, 08 Jul 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/vitiligo-treatment-protocols/</guid>
      <description>&lt;p&gt;As a scientist who also suffers from vitiligo, I spent a day trying to read the current SCIENTIFIC findings published in peer-reviewed scientific journals.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Two type of vitiligo: segmental (localized) vs. non-segmental. Most are non-segmental.&lt;/li&gt;
&lt;li&gt;Some evidence suggests that vitiligo patients are low in &lt;a href=&#34;http://www.ncbi.nlm.nih.gov/pubmed/27057010&#34; target=&#34;_blank&#34;&gt;antioxidants&lt;/a&gt;, &lt;a href=&#34;http://www.ncbi.nlm.nih.gov/pubmed/26422855&#34; target=&#34;_blank&#34;&gt;vitamin D&lt;/a&gt;, &lt;a href=&#34;http://www.ncbi.nlm.nih.gov/pubmed/24517587&#34; target=&#34;_blank&#34;&gt;zinc&lt;/a&gt;, and &lt;a href=&#34;http://www.ncbi.nlm.nih.gov/pubmed/24517587&#34; target=&#34;_blank&#34;&gt;copper&lt;/a&gt;. Vitiligo patients often suffer low glutathione peroxidase (GPx) as suggested by &lt;a href=&#34;http://www.ncbi.nlm.nih.gov/pubmed/27218102&#34; target=&#34;_blank&#34;&gt;this&lt;/a&gt; and other papers.&lt;/li&gt;
&lt;li&gt;Vitiligo is a loss of pigmentation in the skin. Loss of a type of cells called melanocyte that produces melanin. Pathology is unclear, but the evidence is strong for autoimmune disease. In other words, our immune cells attack melanocytes. Oxidative stress by reactive oxygen species might play a role.&lt;/li&gt;
&lt;li&gt;There is no cure for vitiligo. But most patients see improvements with current treatments. It may take months.&lt;/li&gt;
&lt;li&gt;Many treatment exits, but few are rigorously tested in controlled clinical trials.  Scientifically sound results published in peer-reviewed scientific journals are available in PubMed.org.&lt;/li&gt;
&lt;li&gt;Standard treatment protocols recommended by scientists and doctors, such as the &lt;a href=&#34;http://www.espcr.org/vetf/&#34; target=&#34;_blank&#34;&gt;Vitiligo European Task Force&lt;/a&gt;. The following charts are from a book “Pigmentary Disorders: A Comprehensive Compendium” by Koushik Lahiri, Manas Chatterjee, Rashmi Sarka.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&#34;/img/vitiligo/image001.png&#34; alt=&#34;Image1&#34; /&gt;
&lt;img src=&#34;/img/vitiligo/image003.png&#34; alt=&#34;Image2&#34; /&gt;
&lt;img src=&#34;/img/vitiligo/image005.png&#34; alt=&#34;Image3&#34; /&gt;&lt;/p&gt;

&lt;p&gt;As can be seen from these two figures, the most widely used therapies are Narrow-band ultraviolet B (NB-UVB), topical corticosteroid, topical calcineurin inhibitors.
These therapies can be classified into the following categories:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Phototherapy uses different lights to treat vitiligo. Narrow-band ultraviolet B (NB-UVB) is one of the most effective methods. It can be targeted to small areas or the whole body.&lt;/li&gt;
&lt;li&gt;Topical therapies such as a topical corticosteroid, topical calcineurin inhibitors (Tacrolimus, pimecrolimus, etc.) are effective for selected areas. But not for long-term use. These are standard recommended methods to try first for segmental vitiligo, small, limited patches. For large areas of vitiligo throughout the body, the standard approach is NB-UVB for three months, in combination with topical therapies.&lt;/li&gt;
&lt;li&gt;Systemic treatment can be done through oral medicines such as corticosteroids. Oral corticosteroids are shown to stop the progression of vitiligo and induce repigmentation. But side effects are a concern. Antioxidants, either oral or topical, can help protect against reactive oxygen species that are believed to cause vitiligo.&lt;/li&gt;
&lt;li&gt;Surgical therapy. Transplant of skins or even &lt;a href=&#34;http://www.ncbi.nlm.nih.gov/pubmed/26865785&#34; target=&#34;_blank&#34;&gt;hair follicular&lt;/a&gt;. Methods such as suction blister epidermal grafts are very effective and safe.&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;Camouflage. Cosmetic camouflage improves quality of life. Some are permanent (tattoos, and micropigmentation) should be used with caution. Using &lt;a href=&#34;http://www.dermnetnz.org/treatments/dihydroxyacetone.html&#34; target=&#34;_blank&#34;&gt;DHA creams&lt;/a&gt; to camouflage seem to be &lt;a href=&#34;http://www.ncbi.nlm.nih.gov/pubmed/18377610&#34; target=&#34;_blank&#34;&gt;safe and effective&lt;/a&gt;. These creams are used in self-tanning and will last 5-7 days.&lt;/li&gt;
&lt;li&gt;Combination therapy combines these methods.

&lt;ul&gt;
&lt;li&gt;Topical creams are often combined with phototherapy.&lt;/li&gt;
&lt;li&gt;Oral MPD mini-pulse therapy combined with NBUVB appears effective in arresting vitiligo progression and rapidly inducing repigmentation with minimal side effects.&lt;/li&gt;
&lt;li&gt;The combined treatment with oral ALA, betamethasone injection and NB-UVB was effective and safe on non-segmental progressive vitiligo. ALA could accelerate the initial response of repigmentation.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Alternative therapy. &lt;a href=&#34;http://www.ncbi.nlm.nih.gov/pubmed/18498646&#34; target=&#34;_blank&#34;&gt;Many&lt;/a&gt; are being tested. But their effectiveness are not well supported.

&lt;ul&gt;
&lt;li&gt;Diet supplements such as Vitamin C, E, ginko biloba extracts. Supplements for zinc and copper. L-phenylalanine used with phototherapy, and oral Ginkgo biloba as monotherapy show promise.&lt;/li&gt;
&lt;li&gt;Some Chinese herbal medicines act as photosensitizing agents to induce effects like sun burn to treat vitiligo.&lt;/li&gt;
&lt;li&gt;Combine vitamin E with phototherapy.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;My vitiligo, however, keeps progressing. Hope someday there is a safe and effective cure.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Using Amazon EC2 to run large data analyses cheaply</title>
      <link>/post/using-amazon-ec2-to-run-large-data-analysis-cheaply/</link>
      <pubDate>Thu, 05 Jul 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/using-amazon-ec2-to-run-large-data-analysis-cheaply/</guid>
      <description>

&lt;p&gt;&lt;a href=&#34;https://aws.amazon.com/ec2/spot/&#34; target=&#34;_blank&#34;&gt;Spot instances&lt;/a&gt; on Amazon Elastic Compute Cloud (EC2) allow researchers to do high performance computing at very low cost. For example, a 64-core workstation with 256 GB of memory can be rented at about $0.7 per hour, which is ~80% off regular on-demand prices. You can request 10 of such servers and use them for 5 days and 2 hours and it only cost you a few hundred dollars.These are spare computing capacities that could be abruptly terminated. But such interruptions are rare, and can be tolerated by some jobs.&lt;/p&gt;

&lt;p&gt;Here I document how I requested an instance (virtual machine) on Amazon EC2, established a connection via SSH, and configured the Linux machine to run R using Docker containers (also new to me). I know little about Linux and networking. If I can make it work, so can you. The instructions below may not be the best way to do things, as I do not understand a lot of the technical details.&lt;/p&gt;

&lt;h2 id=&#34;main-topics-covered-this-tutorial&#34;&gt;Main topics covered this tutorial:&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Set up Key Pairs and Security Groups to enable SHH login,&lt;/li&gt;
&lt;li&gt;Request spot instance (virtual machine),&lt;/li&gt;
&lt;li&gt;SHH access to the instance via Putty and Filezilla,&lt;/li&gt;
&lt;li&gt;Install Docker software,&lt;/li&gt;
&lt;li&gt;Build a Docker image based on the Bioconductor Docker definition files,&lt;/li&gt;
&lt;li&gt;Start R and compute from within the container,&lt;/li&gt;
&lt;li&gt;Create a &amp;ldquo;volume&amp;rdquo; (a virtual hard drive) and attach it to running instances,&lt;/li&gt;
&lt;li&gt;Take a snapshot of a volume, copy it across regions, and use it to create a volume,&lt;/li&gt;
&lt;li&gt;Google Compute Engine set-up.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;these-are-the-steps-i-took&#34;&gt;These are the steps I took:&lt;/h2&gt;

&lt;ol&gt;
&lt;li&gt;Create an account and sign in to Amazon EC2. You can use your Amazon account. You will need a credit card number.
&lt;img src=&#34;/img/postEC2/image001.png&#34; alt=&#34;EC2&#34; /&gt;&lt;/li&gt;
&lt;li&gt;Create a key pair using the menu on the left in the NETWORK &amp;amp; SECURITY. A file named XXX.pem will be downloaded automatically. I called it key1.pem. This file will be needed to establish SHH connection later.
&lt;img src=&#34;/img/postEC2/image003.png&#34; alt=&#34;Keypair&#34; /&gt;&lt;/li&gt;
&lt;li&gt;Create a Security Group.  Under the NETWORK&amp;amp; SECURITY, click on Security Groups and then choose Create Security Group.  Select SSH from the &amp;ldquo;Type&amp;rdquo; column.  The default outbound rule seems to work. We will use this Security Group when we specify our instances.
&lt;img src=&#34;/img/postEC2/image005.png&#34; alt=&#34;rert&#34; /&gt;&lt;/li&gt;
&lt;li&gt;Start requesting an instance (virtual machine) by clicking on the Spot Requests on the left. Instances initiated with Spot Requests are much cheaper than regular instances. They are computers at idle. They can be terminated abruptly though.
&lt;img src=&#34;/img/postEC2/image007.png&#34; alt=&#34;rert&#34; /&gt;&lt;/li&gt;
&lt;li&gt;Start the Spot Advisor and enter your request. Change the amount required to 1. Otherwise, 20 instances will be requested. A 64-core instance with 256GB memory costs $0.67 per hour or about $16 per day.  Note that Amazon has web servers all across the world. You can switch regions from the top right of the screen. Prices and availability of resources vary greatly across the region.
&lt;img src=&#34;/img/postEC2/image009.png&#34; alt=&#34;rert&#34; /&gt;&lt;/li&gt;
&lt;li&gt;Configure your instance

&lt;ul&gt;
&lt;li&gt;Choose Ubuntu Server 16.04&lt;/li&gt;
&lt;li&gt;Increase EBS volumes to 20 GB from the default 8GB&lt;/li&gt;
&lt;li&gt;Make sure the key pair you created (key1) is used.&lt;/li&gt;
&lt;li&gt;Choose the SHH-enabled Security group we created.
&lt;img src=&#34;/img/postEC2/image011.png&#34; alt=&#34;rert&#34; /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Click Launch and wait a few minutes for Amazon to fulfill this request. Reasons for failed requests vary. There are limits on the maximum number of spot instances for a region such as us-east-2b. There are also limits on new users. These can be lifted by filing a request in the Support Center.
&lt;img src=&#34;/img/postEC2/image013.png&#34; alt=&#34;rert&#34; /&gt;&lt;/li&gt;
&lt;li&gt;Once fulfilled, the instance is listed under Instances.
&lt;img src=&#34;/img/postEC2/image015.png&#34; alt=&#34;image&#34; /&gt;&lt;/li&gt;
&lt;li&gt;To connect to the instance, click on the Connect button (above), information like this will be shown.
&lt;img src=&#34;/img/postEC2/image017.png&#34; alt=&#34;image&#34; /&gt;&lt;/li&gt;
&lt;li&gt;Download Puttygen.exe to convert the key1.pem we got from Amazon to a private key file, &amp;ldquo;key1-Ec2.ppk&amp;rdquo;.  &lt;img src=&#34;/img/postEC2/image019.png&#34; alt=&#34;image&#34; /&gt;&lt;/li&gt;
&lt;li&gt;Download and start Putty.exe

&lt;ul&gt;
&lt;li&gt;Copy and paste the public DNS, such as ec2-52-14-231-133.us-east-2.compute.amazonaws.com&lt;/li&gt;
&lt;li&gt;Under Connection and Data, enter the user name: ubuntu or ec2-user&lt;/li&gt;
&lt;li&gt;Under Connection -&amp;gt; SSH  -&amp;gt; Auth, upload the converted private key file &amp;ldquo;key1-Ec2.ppk&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;Save this session info as EC2-spot3, so that next time we can easily connect to this instances without going through a-c.
&lt;img src=&#34;/img/postEC2/image021.png&#34; alt=&#34;image&#34; /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;We are connected to the instance!!!&lt;br /&gt;
&lt;img src=&#34;/img/postEC2/image023.png&#34; alt=&#34;image&#34; /&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;To copy files to this instance, use FileZilla and follow directions &lt;a href=&#34;http://angus.readthedocs.io/en/2014/amazon/transfer-files-between-instance.html&#34; target=&#34;_blank&#34;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Go to Edit -&amp;gt; Settings to add the key1.pem file as a security key&lt;/li&gt;
&lt;li&gt;File -&amp;gt; Site Manager -&amp;gt; New Site:&lt;/li&gt;
&lt;li&gt;Change Protocol to SFTP;  paste host name, Change Logon Type to Normal;  and enter the username &amp;ldquo;ubuntu&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;Alternatively, we can use scp:&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;scp -i ../key1.pem  animals.tar.gz     ubuntu@ec2-52-14-179-157.us-east-2.compute.amazonaws.com:/mnt/data/
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Install Docker software follow this. I know little about Linux and install software on Linux is always a headache. But Docker containers can simplify things a lot, as many standard pre-defined computing environments can be easily cloned and deployed. See &lt;a href=&#34;https://docs.docker.com/install/linux/docker-ce/ubuntu/#install-using-the-repository&#34; target=&#34;_blank&#34;&gt;instruction&lt;/a&gt;, summerized below:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo apt-get update
sudo apt-get install \
    apt-transport-https \
    ca-certificates \
    curl \
    software-properties-common
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
sudo add-apt-repository \
   &amp;quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu \
   $(lsb_release -cs) \
   stable&amp;quot;
sudo apt-get update
sudo apt-get install docker-ce
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Define your docker image. Save this  as a file called: Dockerfile in a folder such as /home/ubuntu/dockers/. See &lt;a href=&#34;https://www.bioconductor.org/help/docker/&#34; target=&#34;_blank&#34;&gt;here for the Bioconductor docker&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# Bioconductor image: https://www.bioconductor.org/help/docker/
FROM bioconductor/release_core2
# Install R packages
RUN R -e &#39;install.packages(c(&amp;quot;foreach&amp;quot;,&amp;quot;doSNOW&amp;quot;))&#39;
# Install Bioconductor packages
RUN R -e &#39;source(&amp;quot;https://bioconductor.org/biocLite.R&amp;quot;);
biocLite(c(&amp;quot;GO.db&amp;quot;, &amp;quot;GOstats&amp;quot;), suppressUpdates = T)&#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Create an image called mybioconductor. Navigate to the folder that contains the file named Dockerfile, and then&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo docker build -t mybioconductor  .
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Create a data folder&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mkdir ~/data
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Start Bioconductor Docker container instance called bio1. Make the /home/ubuntu/data folder visible in the Docker container as /data.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo docker run -v /home/ubuntu/data:/data --name bio1 -t mybioconductor 
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Within the container, you now have the most recent R and Bioconductor. Note that you are logged in as root in the container with IDs like 9c4b9c5d1492.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# Access the container
sudo docker exec -it bio1 /bin/bash 
R    # start R
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/img/postEC2/image025.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;To run large R jobs in the background use nohup. It is safe to exit the container and terminate the SHH connection.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;nohup R CMD BATCH myScript.R &amp;gt; nohup.out &amp;amp; 
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;The following steps are optional.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Create a volume (logical hard drive) from ELASTIC BLOCK STORE on the EC2 interface. Create a volume in the exactly the same region, such as us-east-2b, as the instance you want to attach to. These storages  persist even if the instance is terminated. I typically run computing on these attached volumes, instead of home directory on the instances.&lt;/li&gt;
&lt;li&gt;Attach the volume to the instance. Select the newly created volumne. Using Actions &amp;ndash;&amp;gt; Attach volumne to attach the volumne to a disired instance in the same region.&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Mount the created volume to a folder called /mnt. Note that the volume needs to be mounted again after reboot. &lt;a href=&#34;https://n2ws.com/blog/how-to-guides/connect-aws-ebs-volume-another-instance&#34; target=&#34;_blank&#34;&gt;Details.&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd /
sudo mkdir mnt  # create a folder
sudo chmod -R a+rwX /mnt # make the folder accessible to all
lsblk    # check the list of devices 
sudo mkfs.ext4 /dev/xvdf   # create a file system. data will be lost!
sudo mount /dev/xvdf  /mnt 
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Snapshots can be created from the volumnes as backup. Storage is relatively cheap at $0.05 per GB per month. These snapshots can be copied across regions, such as from US East (Ohio) to US West (N. California). We can create a volume based on the snapshot and access the data. To mount volumes created from snapshots, please note that file system already exists. And we should be mounting the xvdf1, not xvdf. &lt;a href=&#34;https://serverfault.com/questions/632905/cannot-mount-an-existing-ebs-on-aws&#34; target=&#34;_blank&#34;&gt;Details.&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd /
sudo mkdir mnt  # create folder
lsblk    # check the list of devices 
sudo mount /dev/xvdf1  /mnt      
sudo chmod -R a+rwX /mnt    # make folder writable to all
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;When your instance is terminated, Amazon will fill your fleet request with a new instance automatically. If the instance is in the same region (us-ease-2b), you can attached the data volumne and continue your calculation. Once Amazon created a replacement instance in us-east-2c, but my data volumne was in use-east-2b. I have to take a snapshot of the volume, and then use it to create another volume in us-east-2c.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Google Compute Engine also allows Preemptiable VMs, similar to Amazon EC2 Spot Instances. Google Compute Engine can be set up following a similar fashion following &lt;a href=&#34;https://www.onepagezen.com/google-cloud-ftp-filezilla-quick-start/&#34; target=&#34;_blank&#34;&gt;instructions.&lt;/a&gt;  SHH connection can be directly established in Chrome Browser.
Summary:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Login and create instance at Google  Compute Engine&lt;/li&gt;
&lt;li&gt;Download PuttyGen&lt;/li&gt;
&lt;li&gt;click Generate to create key pairs&lt;/li&gt;
&lt;li&gt;Save private key file&lt;/li&gt;
&lt;li&gt;Copy the public key to clipboard&lt;/li&gt;
&lt;li&gt;Click Metadata in Compute Engine menu and add SHH Key by paste the public key&lt;/li&gt;
&lt;li&gt;Filezella &amp;ndash;&amp;gt; Edit &amp;ndash;&amp;gt; settings &amp;ndash;&amp;gt; SFTP  &amp;ndash;&amp;gt; Add key file&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Following these step, I was able to create 3 fairly powerful servers, each with 64 cores, 256GB memory and 50GB SSD. Using the foreach and doSNOW  R packages, we can use all the cores in parallel at 100%.  I shut them down when all finished in a few days. It costed less than $200. Yes, the flexibility and affordability of computing are here. It is less complicated than you think.&lt;/p&gt;

&lt;p&gt;Please let me know if you have any comments or suggestions.&lt;/p&gt;

&lt;p&gt;Note: This was intially a note for myself taken using OneNote. Translating to Markdown is such a painful process. It remained me of the early days Fortran programming. Counting spaces&amp;hellip; Someone simplify it! I need to figure out a way to insert a html file directly into Blogdown as a post.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Blogdown notes</title>
      <link>/post/blogdown-notes/</link>
      <pubDate>Mon, 02 Jul 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/blogdown-notes/</guid>
      <description>&lt;p&gt;This website is created using RStudio following this &lt;a href=&#34;https://alison.rbind.io/post/up-and-running-with-blogdown/&#34; target=&#34;_blank&#34;&gt;tutorial&lt;/a&gt; with tips from &lt;a href=&#34;https://divingintogeneticsandgenomics.rbind.io/post/hugo-academic-theme-blog-down-deployment-some-details/&#34; target=&#34;_blank&#34;&gt;Ming Tang&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;To start a new post, choose &amp;ldquo;New post&amp;rdquo; from Addins.
Use Markdown for texts.  Use RMarkdown if it contains R markdown to render plots, etc.&lt;/p&gt;

&lt;p&gt;Choose which files you want to work on from the right bottom window. Save the files changed and the webpage is rendered automatically in the Viewer window.&lt;/p&gt;

&lt;p&gt;To disable a widget, change the header from active=true to active=false&lt;/p&gt;

&lt;p&gt;Use Git GUI to push to GitHub.&lt;/p&gt;

&lt;p&gt;Just like magic, the website will refresh automatically at Netlify.com.&lt;/p&gt;

&lt;p&gt;To add a lot of figures to a &lt;a href=&#34;https://gex.netlify.com/post/using-amazon-ec2-to-run-large-data-analysis-cheaply/&#34; target=&#34;_blank&#34;&gt;post&lt;/a&gt;, creaste sub-folders like postEC2, and then in the Markdown file use:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; ![image](/img/postEC2/image025.png)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;For R markdown files, the current folder has to be blog/content/post.  For complex calculations, such as the iDEP R Markdown, try the markdown separately, then import to Blogdown.&lt;/p&gt;

&lt;p&gt;Microsoft Word documents can be saved as html, which can then be converted to Markdown format.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>DESeq2 experimental design and interpretation</title>
      <link>/post/deseq2-experimental-design-and-interpretation/</link>
      <pubDate>Mon, 02 Jul 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/deseq2-experimental-design-and-interpretation/</guid>
      <description>

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/factors5.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Update. 11/13/17  Thanks to Mike Love for pointing out an error. This is just my understanding. There maybe other errors.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;To allow complex study designs in iDEP(&lt;a href=&#34;http://ge-lab.org/idep/&#34; target=&#34;_blank&#34;&gt;http://ge-lab.org/idep/&lt;/a&gt;), I tried to understand how factoral models are built and the desired results are extracted from DESeq2.  The following is based on the help document from the resutls( ) function in DESeq2, plus some of Mike Love&amp;rsquo;s answers to questions from users.&lt;/p&gt;

&lt;p&gt;An important point I want to make is the interpretation of results is tricky when the study design involve multiple factors.  See figure above for an example involving 3 genotypes under 3  conditions.  Similar to regression analysis in R, the &lt;em&gt;reference levels&lt;/em&gt; for categorical factors forms the foundation of our intereptation. Yet, by default, they are determined alphabetically.&lt;/p&gt;

&lt;p&gt;Before runing DESeq2, it is essential to choose appropriate reference levels for each factors. This can be done by the relevel( ) function in R. Reference level is the baseline level of a factor that forms the basis of meaningful comparisons. In a wildtype vs. mutant experiment, &amp;ldquo;wild-type&amp;rdquo; is the reference level. In treated vs. untreated, the reference level is obviously untreated. More details in Exmple 3.&lt;/p&gt;

&lt;p&gt;iDEP provides a GUI to DESeq2 for most experimental desings. It also provides convienent interface for exploratory data anlysis and pathway analysis. Try it at &lt;a href=&#34;http://ge-lab.org/idep/&#34; target=&#34;_blank&#34;&gt;http://ge-lab.org/idep/&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&#34;example-1-two-group-comparison&#34;&gt;Example 1: two-group comparison&lt;/h1&gt;

&lt;p&gt;First make some example data.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(DESeq2)
dds &amp;lt;- makeExampleDESeqDataSet(n=10000,m=6)
assay(dds)[ 1:10,]
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##        sample1 sample2 sample3 sample4 sample5 sample6
## gene1        6       4      11       1       2      13
## gene2        9      12      23      13      14      28
## gene3       58     121     173     178     118      97
## gene4        0       4       0       3       8       3
## gene5       27       3       6       9       8      12
## gene6       48       8      35      38      21      13
## gene7       36      50      61      52      44      22
## gene8        6       8      16      14      18      19
## gene9      214     266     419     198     157     166
## gene10      20      12      16      12      16       2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This is a very simple experiment design with two conditions.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;colData(dds)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## DataFrame with 6 rows and 1 column
##         condition
##          &amp;lt;factor&amp;gt;
## sample1         A
## sample2         A
## sample3         A
## sample4         B
## sample5         B
## sample6         B
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;dds &amp;lt;- DESeq(dds)
resultsNames(dds)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;Intercept&amp;quot;        &amp;quot;condition_B_vs_A&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This shows the results available. Note that by default, R will choose a reference level for factors based on alphabetical order. Here A is the referece level. Fold change is defined as B compaired with A. To change reference levels, try the relevel( ) function.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res &amp;lt;- results(dds, contrast=c(&amp;quot;condition&amp;quot;,&amp;quot;B&amp;quot;,&amp;quot;A&amp;quot;))
res &amp;lt;- res[order(res$padj),]
library(knitr)
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene9056&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;360.168909&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-2.045379&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001372&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene3087&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;43.897516&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-2.203303&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000173&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0857004&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene3763&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;72.409877&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.834787&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000433&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1434364&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene2054&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;322.494963&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.537408&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000682&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1692730&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene4617&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.227415&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.125238&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0002015&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4001027&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;If we want to use B as control and define fold change using B as baseline. Then we can do this:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res &amp;lt;- results(dds, contrast=c(&amp;quot;condition&amp;quot;,&amp;quot;A&amp;quot;,&amp;quot;B&amp;quot;))
ix = which.min(res$padj)
res &amp;lt;- res[order(res$padj),]
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene9056&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;360.168909&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.045379&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001372&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene3087&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;43.897516&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.203303&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000173&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0857004&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene3763&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;72.409877&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.834787&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000433&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1434364&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene2054&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;322.494963&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.537408&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000682&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1692730&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene4617&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.227415&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-6.125238&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0002015&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4001027&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;As you can see, the fold-change are completely opposite direction. Here we show the most significant gene.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-6-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;p&gt;#Example 2: Multiple groups
Suppose we have three groups A, B, and C.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;dds &amp;lt;- makeExampleDESeqDataSet(n=100,m=6)
dds$condition &amp;lt;- factor( c( &amp;quot;A&amp;quot;,&amp;quot;A&amp;quot;,&amp;quot;B&amp;quot;,&amp;quot;B&amp;quot;,&amp;quot;C&amp;quot;,&amp;quot;C&amp;quot;) )
dds &amp;lt;- DESeq(dds)
res = results(dds, contrast=c(&amp;quot;condition&amp;quot;,&amp;quot;C&amp;quot;,&amp;quot;A&amp;quot;))
res &amp;lt;- res[order(res$padj),]
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.634986&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-5.101773&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0348679&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5515088&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene20&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.678176&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-4.490982&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0445664&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5515088&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene34&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;56.068672&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.462155&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0167820&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5515088&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene35&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;537.847175&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.177240&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0087913&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5515088&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene41&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;93.967810&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.064734&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0412034&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5515088&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&#34;example-3-two-conditions-two-genotypes-with-an-interaction-term&#34;&gt;Example 3: two conditions, two genotypes, with an interaction term&lt;/h1&gt;

&lt;p&gt;Here we have two genotypes, wild-type (WT), and mutant (MU). Two conditions, control (Ctrl) and treated (Trt). We are interested in the responses of both wild-type and mutant to treatment. We are also interested in the differences in response between genotypes, which is captured by the interaction term in linear models.&lt;/p&gt;

&lt;p&gt;First, we construct example data. Note that we changed sample names from &amp;ldquo;sample1&amp;rdquo; to &amp;ldquo;Wt_Ctrl_1&amp;rdquo;, according to the two factors.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;dds &amp;lt;- makeExampleDESeqDataSet(n=10000,m=12)
dds$condition &amp;lt;- factor( c( rep(&amp;quot;Ctrl&amp;quot;,6), rep(&amp;quot;Trt&amp;quot;,6) ) )
dds$genotype &amp;lt;- factor(rep(rep(c(&amp;quot;WT&amp;quot;,&amp;quot;MU&amp;quot;),each=3),2))
colnames(dds) &amp;lt;- paste(as.character( dds$genotype),as.character( dds$condition),rownames(colData(dds)),  sep=&amp;quot;_&amp;quot;  )
colnames(dds) = gsub(&amp;quot;sample&amp;quot;,&amp;quot;&amp;quot;,colnames(dds))
kable(assay(dds)[1:5,])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;WT_Ctrl_1&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;WT_Ctrl_2&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;WT_Ctrl_3&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;MU_Ctrl_4&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;MU_Ctrl_5&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;MU_Ctrl_6&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;WT_Trt_7&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;WT_Trt_8&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;WT_Trt_9&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;MU_Trt_10&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;MU_Trt_11&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;MU_Trt_12&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;81&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;47&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;135&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;72&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;81&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;80&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;76&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;57&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;52&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;49&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;64&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;57&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;70&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;77&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;94&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;54&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;54&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;36&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;51&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;66&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;57&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;51&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;47&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;67&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;37&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;28&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;36&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;40&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;kable( colData(dds))
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;condition&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;genotype&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;WT_Ctrl_1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Ctrl&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;WT&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;WT_Ctrl_2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Ctrl&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;WT&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;WT_Ctrl_3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Ctrl&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;WT&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;MU_Ctrl_4&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Ctrl&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;MU&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;MU_Ctrl_5&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Ctrl&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;MU&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;MU_Ctrl_6&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Ctrl&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;MU&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;WT_Trt_7&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Trt&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;WT&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;WT_Trt_8&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Trt&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;WT&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;WT_Trt_9&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Trt&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;WT&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;MU_Trt_10&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Trt&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;MU&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;MU_Trt_11&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Trt&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;MU&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;MU_Trt_12&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Trt&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;MU&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Check reference levels:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;dds$condition
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##  [1] Ctrl Ctrl Ctrl Ctrl Ctrl Ctrl Trt  Trt  Trt  Trt  Trt  Trt 
## Levels: Ctrl Trt
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;As you could see, &amp;ldquo;Ctrl&amp;rdquo; apeared first in the 2nd line, indicating it is the reference level for factor condition, as we can expect based on alphabetical order. This is what we want and we do not need to do anything.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;dds$genotype
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##  [1] WT WT WT MU MU MU WT WT WT MU MU MU
## Levels: MU WT
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;But  &amp;ldquo;Mu&amp;rdquo; is the reference level for genotype, which is will give us results difficult to interpret. We need to change it.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;dds$genotype = relevel( dds$genotype, &amp;quot;WT&amp;quot;)
dds$genotype
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##  [1] WT WT WT MU MU MU WT WT WT MU MU MU
## Levels: WT MU
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Set up the model, and run DESeq2:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;design(dds) &amp;lt;- ~ genotype + condition + genotype:condition
dds &amp;lt;- DESeq(dds) 
resultsNames(dds)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;Intercept&amp;quot;               &amp;quot;genotype_MU_vs_WT&amp;quot;      
## [3] &amp;quot;condition_Trt_vs_Ctrl&amp;quot;   &amp;quot;genotypeMU.conditionTrt&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Below, we are going to use the combination of the different results (&amp;ldquo;genotype_MU_vs_WT&amp;rdquo;, &amp;ldquo;condition_Trt_vs_Ctrl&amp;rdquo;, &amp;ldquo;genotypeMU.conditionTrt&amp;rdquo; ) to derive biologically meaningful comparisons.&lt;/p&gt;

&lt;p&gt;##The  effect of treatment in wild-type (the main effect).&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, contrast=c(&amp;quot;condition&amp;quot;,&amp;quot;Trt&amp;quot;,&amp;quot;Ctrl&amp;quot;))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene275&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;25.38836&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.607896&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000588&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2684841&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene2744&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;101.02954&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.670837&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001099&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2684841&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5441&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;58.67469&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.758921&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001261&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2684841&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene7021&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;74.29359&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.610853&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001345&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2684841&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene7795&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;326.43308&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.624323&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000407&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2684841&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;This is for WT, treated compared with untreated. Note that WT is not mentioned, because it is the reference level. In other words, this is the difference between samples No. 7-9, compared with samples No. 1-3.&lt;/p&gt;

&lt;p&gt;Here we show the most significant gene.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-14-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;p&gt;##The effect of treatment in mutant
This is, by definition, the main effect &lt;em&gt;plus&lt;/em&gt; the interaction term (the extra condition effect in genotype Mutant compared to genotype WT).&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res &amp;lt;- results(dds, list( c(&amp;quot;condition_Trt_vs_Ctrl&amp;quot;,&amp;quot;genotypeMU.conditionTrt&amp;quot;) ))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5102&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.69017&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.757057&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.60e-06&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0156912&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene7367&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;170.69259&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.481016&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.19e-05&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0396827&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene8351&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;27.77227&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.033622&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.80e-06&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0396827&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene8034&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;53.34342&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.841023&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.62e-05&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0403724&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene7272&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;92.82351&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.414967&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.70e-05&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1125817&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Note that it has to be &lt;em&gt;list&lt;/em&gt;( c(&amp;ldquo;condition_Trt_vs_Ctrl&amp;rdquo;,&amp;ldquo;genotypeMU.conditionTrt&amp;rdquo;) ). If list( ) is ommitted, the results would be drastically different. Perhaps only the first coefficient is used.&lt;/p&gt;

&lt;p&gt;This measures the effect of treatment in mutant. In other words, samples No. 10-12 compared with samples No. 4-6.&lt;/p&gt;

&lt;p&gt;Here we show the most significant gene, which is downregulated expressed in samples 10-12, than samples 4-6 , as expected.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-16-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;p&gt;##What is the difference between mutant and wild-type without treatment?&lt;/p&gt;

&lt;p&gt;As Ctrl is the reference level, we can just retrieve the &amp;ldquo;genotype_MU_vs_WT&amp;rdquo;.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, contrast=c(&amp;quot;genotype&amp;quot;,&amp;quot;MU&amp;quot;,&amp;quot;WT&amp;quot;))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5102&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.69017&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-4.714519&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000020&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0195596&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene2289&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;45.04711&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.763615&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000333&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1218107&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene3388&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;122.85582&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.529323&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000366&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1218107&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene915&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;39.03250&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.104003&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001133&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2374861&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene8351&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;27.77227&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-2.653182&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001190&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2374861&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;In other words, this is the samples No.4-6  compared with No. 1-3. Here we show the most significant gene.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-18-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;p&gt;##With treatment, what is the difference between mutant and wild-type?&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, list( c(&amp;quot;genotype_MU_vs_WT&amp;quot;,&amp;quot;genotypeMU.conditionTrt&amp;quot;) ))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene4127&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;50.03677&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.925094&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000091&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0910879&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene3879&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;34.67704&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-2.133203&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000283&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0940393&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene4799&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24.11059&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-2.459345&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000197&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0940393&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5441&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;58.67469&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.744769&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001418&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2357639&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5926&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;161.16737&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.524163&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001339&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2357639&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;This gives us the difference between genotype MU and WT, under condition Trt. In other words, this is the sampless No. 10-12 compared with samples 7-9.&lt;/p&gt;

&lt;p&gt;Here we show the most significant gene.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-20-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;the-different-response-in-genotypes-interaction-term&#34;&gt;The different response in genotypes (interaction term)&lt;/h2&gt;

&lt;p&gt;Is the  effect of treatment &lt;em&gt;different&lt;/em&gt; across genotypes? This is the interaction term.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, name=&amp;quot;genotypeMU.conditionTrt&amp;quot;)
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5102&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.69017&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7.395771&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000341&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5441&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;58.67469&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-3.297673&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000004&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0019104&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene8034&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;53.34342&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-2.564030&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000205&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0682558&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene8858&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14.68650&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.703936&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000297&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0742076&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene4799&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24.11059&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-2.990101&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001234&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2463661&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Here we show the most significant gene.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-22-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;p&gt;In wild-type, this gene is upregulated by treatment, while for the  mutant, it is downregulated.&lt;/p&gt;

&lt;h1 id=&#34;example-4-two-conditionss-three-genotpes-with-interaction-terms&#34;&gt;Example 4: Two conditionss, three genotpes with interaction terms&lt;/h1&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;dds &amp;lt;- makeExampleDESeqDataSet(n=10000,m=18)
dds$genotype &amp;lt;- factor(rep(rep(c(&amp;quot;I&amp;quot;,&amp;quot;II&amp;quot;,&amp;quot;III&amp;quot;),each=3),2))
colnames(dds) &amp;lt;- paste(rownames(colData(dds)), as.character( dds$condition), as.character( dds$genotype),sep=&amp;quot;_&amp;quot;  )
colnames(dds) = gsub(&amp;quot;sample&amp;quot;,&amp;quot;S&amp;quot;,colnames(dds))
design(dds) &amp;lt;- ~ genotype + condition + genotype:condition
dds &amp;lt;- DESeq(dds)
kable( colData(dds))
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;condition&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;genotype&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;sizeFactor&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S1_A_I&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.053964&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S2_A_I&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.058935&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S3_A_I&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.061629&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S4_A_II&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.047347&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S5_A_II&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.059813&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S6_A_II&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.049639&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S7_A_III&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.060271&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S8_A_III&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.057331&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S9_A_III&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.052053&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S10_B_I&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.053989&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S11_B_I&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.044408&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S12_B_I&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.042376&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S13_B_II&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.042354&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S14_B_II&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.050094&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S15_B_II&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.045868&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S16_B_III&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.050772&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S17_B_III&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.047934&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;S18_B_III&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.036983&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;resultsNames(dds)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;Intercept&amp;quot;              &amp;quot;genotype_II_vs_I&amp;quot;      
## [3] &amp;quot;genotype_III_vs_I&amp;quot;      &amp;quot;condition_B_vs_A&amp;quot;      
## [5] &amp;quot;genotypeII.conditionB&amp;quot;  &amp;quot;genotypeIII.conditionB&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;the-condition-effect-for-genotype-i-the-main-effect&#34;&gt;The condition effect for genotype I (the main effect)&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, contrast=c(&amp;quot;condition&amp;quot;,&amp;quot;B&amp;quot;,&amp;quot;A&amp;quot;))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene9348&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;48.01943&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.915941&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000155&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1546441&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene928&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;60.03093&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.562622&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001151&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5748158&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene931&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;439.23135&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.101161&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0004187&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.6066182&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene4483&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16.83153&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.957899&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0005487&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.6066182&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene4612&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;29.09139&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.742999&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0006893&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.6066182&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-24-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;the-condition-effect-for-genotype-iii&#34;&gt;The condition effect for genotype III.&lt;/h2&gt;

&lt;p&gt;This is the main effect &lt;em&gt;plus&lt;/em&gt; the interaction term
(the extra condition effect in genotype III compared to genotype I).&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, contrast=list( c(&amp;quot;condition_B_vs_A&amp;quot;,&amp;quot;genotypeIII.conditionB&amp;quot;) ))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene316&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;63.666427&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.724235&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000294&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2936262&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene252&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.751827&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-6.012712&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001418&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2977597&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene2068&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16.851863&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-2.725616&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001422&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2977597&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene6828&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19.669827&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.840392&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000635&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2977597&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene7420&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;85.226424&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.510240&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001788&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2977597&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-25-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;the-condition-effect-for-genotype-ii&#34;&gt;The condition effect for genotype II.&lt;/h2&gt;

&lt;p&gt;This is the main effect &lt;em&gt;plus&lt;/em&gt; the interaction term
(the extra condition effect in genotype II compared to genotype I).&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, contrast=list( c(&amp;quot;condition_B_vs_A&amp;quot;,&amp;quot;genotypeII.conditionB&amp;quot;) ))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene980&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;71.929692&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.711667&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0005822&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.648323&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene1177&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;109.057633&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.281177&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0002111&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.648323&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5118&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.487054&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-5.757413&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0005110&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.648323&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5570&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23.786589&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.329791&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0004286&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.648323&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene6519&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;94.137270&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.422193&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001399&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.648323&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-26-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;p&gt;This is equivalent to using numeric vector referencing to each of the results.&lt;/p&gt;

&lt;p&gt;[1] &amp;ldquo;Intercept&amp;rdquo;              &amp;ldquo;genotype_II_vs_I&amp;rdquo;       &amp;ldquo;genotype_III_vs_I&amp;rdquo;&lt;br /&gt;
[4] &amp;ldquo;condition_B_vs_A&amp;rdquo;       &amp;ldquo;genotypeII.conditionB&amp;rdquo;  &amp;ldquo;genotypeIII.conditionB&amp;rdquo;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, contrast= c(0,0,0,1,1,0))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene980&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;71.929692&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.711667&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0005822&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.648323&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene1177&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;109.057633&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.281177&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0002111&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.648323&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5118&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.487054&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-5.757413&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0005110&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.648323&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5570&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23.786589&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.329791&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0004286&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.648323&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene6519&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;94.137270&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.422193&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001399&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.648323&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-27-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;the-effect-of-iii-vs-ii-under-condition-a&#34;&gt;The effect of III vs. II, under condition A.&lt;/h2&gt;

&lt;p&gt;This is the  effect of &amp;ldquo;genotype_III_vs_I&amp;rdquo;  &lt;em&gt;minus&lt;/em&gt;     &amp;ldquo;genotype_II_vs_I&amp;rdquo; ?&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, contrast= c(0,-1,1,0,0,0))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene7875&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;172.84101&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.316870&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000354&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.3541800&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene316&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;63.66643&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.399247&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0006044&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5256726&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene557&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17.92683&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.980097&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0008418&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5256726&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene1243&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;51.92628&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.844387&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0004523&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5256726&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene1702&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;55.34857&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.631481&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0006698&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5256726&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-28-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;the-interaction-term-for-condition-effect-in-genotype-iii-vs-genotype-i&#34;&gt;The interaction term for condition effect in genotype III vs genotype I.&lt;/h2&gt;

&lt;p&gt;This tests if the condition effect is different in III compared to I&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, name=&amp;quot;genotypeIII.conditionB&amp;quot;)
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene9348&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;48.019429&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-2.714891&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000104&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1042074&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene6251&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14.477069&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-4.780646&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000479&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2395245&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene839&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;161.393935&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.662756&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000886&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2950638&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene9383&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.149222&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-6.436304&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001560&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.3896367&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene931&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;439.231351&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.562204&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0003858&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4506833&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-29-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;the-interaction-term-for-condition-effect-in-genotype-iii-vs-genotype-ii&#34;&gt;The interaction term for condition effect in genotype III vs genotype II.&lt;/h2&gt;

&lt;p&gt;This tests if the condition effect is different in III compared to II&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, contrast=list(&amp;quot;genotypeIII.conditionB&amp;quot;, &amp;quot;genotypeII.conditionB&amp;quot;))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5761&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;27.797507&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.231182&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000012&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0116510&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene6598&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;100.143591&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.317486&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000214&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1068006&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene3491&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;325.224707&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.942243&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001168&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2853814&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene4635&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.411707&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.206116&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000963&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2853814&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene5118&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.487054&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.088922&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0002454&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2853814&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-30-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;h1 id=&#34;example-5-three-conditions-three-genotypes-with-interaction-terms&#34;&gt;Example 5: Three conditions, three genotypes with interaction terms&lt;/h1&gt;

&lt;p&gt;For a more complex example, we now have a 3x3 factorial design. It is convenent to use a diagram to represent study design and the coefficients generated by DESeq2. Each connections in the diagram below represents a coefficient for a contrast and we can use the combination of these to define desired contrasts by travelling through the graph/network.
&lt;img src=&#34;I:/factors5.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;dds &amp;lt;- makeExampleDESeqDataSet(n=10000,m=18)
dds$genotype &amp;lt;- factor(rep(rep(c(&amp;quot;I&amp;quot;,&amp;quot;II&amp;quot;,&amp;quot;III&amp;quot;),each=3),2))
dds$condition &amp;lt;-factor(rep(c(&amp;quot;A&amp;quot;,&amp;quot;B&amp;quot;,&amp;quot;C&amp;quot;), 6)  )
colnames(dds) &amp;lt;- paste(as.character( dds$genotype), as.character( dds$condition),rownames(colData(dds)), sep=&amp;quot;_&amp;quot;  )
colnames(dds) = gsub(&amp;quot;sample&amp;quot;,&amp;quot;&amp;quot;,colnames(dds))
design(dds) &amp;lt;- ~ genotype + condition + genotype:condition
dds &amp;lt;- DESeq(dds)
kable( colData(dds))
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;condition&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;genotype&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;sizeFactor&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;I_A_1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.055853&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;I_B_2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.037228&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;I_C_3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;C&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.048146&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;II_A_4&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.048901&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;II_B_5&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.062858&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;II_C_6&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;C&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.036711&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;III_A_7&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.052625&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;III_B_8&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.033361&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;III_C_9&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;C&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.040028&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;I_A_10&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.054525&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;I_B_11&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.045331&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;I_C_12&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;C&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;I&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.036150&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;II_A_13&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.052502&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;II_B_14&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.047103&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;II_C_15&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;C&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;II&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.063802&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;III_A_16&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;A&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.053762&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;III_B_17&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;B&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.041255&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;III_C_18&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;C&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;III&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.048660&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;resultsNames(dds)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;Intercept&amp;quot;              &amp;quot;genotype_II_vs_I&amp;quot;      
## [3] &amp;quot;genotype_III_vs_I&amp;quot;      &amp;quot;condition_B_vs_A&amp;quot;      
## [5] &amp;quot;condition_C_vs_A&amp;quot;       &amp;quot;genotypeII.conditionB&amp;quot; 
## [7] &amp;quot;genotypeIII.conditionB&amp;quot; &amp;quot;genotypeII.conditionC&amp;quot; 
## [9] &amp;quot;genotypeIII.conditionC&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;To derive desired contrasts, we can travel on the network of factor levels, using the given 9 coefficients as bridges.For example, we are interested in the difference between genotpes III vs. II, under condition C. This is not readily available. But we can travel from C to III, then III to I, I to II, and then II to C. Namely the path is C&amp;ndash;III&amp;ndash;I&amp;ndash;II&amp;ndash;C. In terms of coefficients: (III-I) - (II-I) + III.C - II.C=
      &amp;ldquo;genotype_III_vs_I&amp;rdquo; - &amp;ldquo;genotype_II_vs_I&amp;rdquo;  + &amp;ldquo;genotypeIII.conditionC&amp;rdquo; - &amp;ldquo;genotypeII.conditionC&amp;rdquo;
For such a complex contrast, we can use the numerical combination using a vector:
c(0,-1,1,0,0,0,0,-1,1 )
These numbers are applied to the coefficients in the resultsNames. To double check we order them:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;cbind(resultsNames(dds),c(0,-1,1,0,0,0,0,-1,1 ) )
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##       [,1]                     [,2]
##  [1,] &amp;quot;Intercept&amp;quot;              &amp;quot;0&amp;quot; 
##  [2,] &amp;quot;genotype_II_vs_I&amp;quot;       &amp;quot;-1&amp;quot;
##  [3,] &amp;quot;genotype_III_vs_I&amp;quot;      &amp;quot;1&amp;quot; 
##  [4,] &amp;quot;condition_B_vs_A&amp;quot;       &amp;quot;0&amp;quot; 
##  [5,] &amp;quot;condition_C_vs_A&amp;quot;       &amp;quot;0&amp;quot; 
##  [6,] &amp;quot;genotypeII.conditionB&amp;quot;  &amp;quot;0&amp;quot; 
##  [7,] &amp;quot;genotypeIII.conditionB&amp;quot; &amp;quot;0&amp;quot; 
##  [8,] &amp;quot;genotypeII.conditionC&amp;quot;  &amp;quot;-1&amp;quot;
##  [9,] &amp;quot;genotypeIII.conditionC&amp;quot; &amp;quot;1&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now we can extract the contrast.&lt;/p&gt;

&lt;h2 id=&#34;the-effect-of-iii-vs-ii-under-condition-c&#34;&gt;The effect of III vs. II, under condition C.&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;res = results(dds, contrast= c(0,-1,1,0,0,0,0,0,1 ))
ix = which.min(res$padj) # most significant
res &amp;lt;- res[order(res$padj),] # sort
kable(res[1:5,-(3:4)])
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;baseMean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;log2FoldChange&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;pvalue&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;padj&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene793&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;50.368566&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.737810&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.36e-05&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1460573&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene1161&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;827.243573&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.844200&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.39e-05&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1460573&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene3314&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23.430794&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.580687&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.57e-05&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1460573&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene4445&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;51.054925&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-3.096770&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.96e-05&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1736784&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;gene1555&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.073803&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.771498&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.70e-05&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1937244&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;barplot(assay(dds)[ix,],las=2, main=rownames(dds)[ ix  ]  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-deseq2-experimental-design-and-interpretation_files/figure-html/unnamed-chunk-33-1.png&#34; width=&#34;576&#34; /&gt;&lt;/p&gt;

&lt;p&gt;How about many factors, each with many levels? It&amp;rsquo;s going to become increasingly complex. Drawing a network graph like the one above can help you find the right combination.&lt;/p&gt;

&lt;p&gt;Please let me know if you have any comment.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>First experience with Docker</title>
      <link>/post/i-tried-docker/</link>
      <pubDate>Mon, 02 Jul 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/i-tried-docker/</guid>
      <description>

&lt;p&gt;With the help of my students, I finally figured out how to use Docker to define an isolated environment.  I wanted to run the most recent version of R and Bioconductor in a Linux machine without bothering IT support people.&lt;/p&gt;

&lt;p&gt;Turns out it is a one-liner, if you have the docker software installed:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;sudo docker run --name=my-r-base --rm -ti -v /home/gex/Rdocker:/myData bioconductor/release_core2  /bin/bash
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;It downloads the most recent &lt;a href=&#34;https://www.bioconductor.org/help/docker/&#34; target=&#34;_blank&#34;&gt;Bioconductor image&lt;/a&gt; from Docker hub, and runs it. A local folder /home/gex/Rdocker is mapped to /myData in the container.&lt;/p&gt;

&lt;p&gt;It’s quite useful to have an environment that you can mess with.&lt;/p&gt;

&lt;p&gt;If you want to customize the docker image with additional R packages and use it more than once. Here is the complete steps:&lt;/p&gt;

&lt;h2 id=&#34;1-install-docker-community-edition-ce-software-follow-this-instruction-https-docs-docker-com-install-linux-docker-ce-ubuntu-install-using-the-repository-summerized-below&#34;&gt;1. Install Docker community edition (ce) software follow this &lt;a href=&#34;https://docs.docker.com/install/linux/docker-ce/ubuntu/#install-using-the-repository&#34; target=&#34;_blank&#34;&gt;instruction&lt;/a&gt;, summerized below:&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;```
sudo apt-get update
sudo apt-get install \
    apt-transport-https \
    ca-certificates \
    curl \
    software-properties-common
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
sudo add-apt-repository \
   &amp;quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu \
   $(lsb_release -cs) \
   stable&amp;quot;
sudo apt-get update
sudo apt-get install docker-ce
```
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;2-save-this-as-a-file-called-dockerfile&#34;&gt;2.   Save this  as a file called: Dockerfile&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;# Use biocondocuter image from Docker hub
# https://www.bioconductor.org/help/docker/
FROM bioconductor/release_core2

# Install R packages
RUN R -e &#39;install.packages(c(&amp;quot;foreach&amp;quot;,&amp;quot;doSNOW&amp;quot;))&#39;

# install Bioconductor packages
RUN R -e &#39;source(&amp;quot;https://bioconductor.org/biocLite.R&amp;quot;);
          biocLite(c(&amp;quot;GO.db&amp;quot;, &amp;quot;GOstats&amp;quot;), suppressUpdates = T)&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You can find docker images for many typical use at ]Docker hub.](&lt;a href=&#34;https://hub.docker.com/&#34; target=&#34;_blank&#34;&gt;https://hub.docker.com/&lt;/a&gt;)&lt;/p&gt;

&lt;h2 id=&#34;3-navigate-to-the-folder-that-contains-the-dockerfile-create-image-called-bioconductor&#34;&gt;3.   Navigate to the folder that contains the Dockerfile. Create image called bioconductor.&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;sudo docker build -t bioconductor .
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;4-run-an-instance-mapping-rdocker-folder-in-the-host-to-mydata-in-the-container&#34;&gt;4.   Run an instance (mapping Rdocker folder in the host to /myData in the container)&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;docker run -v /home/gex/Rdocker:/myData --name bio1 -t bioconductor
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a href=&#34;https://deis.com/blog/2015/creating-sharing-first-docker-image/&#34; target=&#34;_blank&#34;&gt;More info&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&#34;5-access-docker-instance&#34;&gt;5.   Access docker instance&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;sudo docker exec -it bio1 /bin/bash
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;6-run-large-r-script-from-within-the-container&#34;&gt;6.   Run large R script from within the container&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;nohup R CMD BATCH gene_mapping_all.R &amp;gt; nohup.out &amp;amp;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;7-exit-the-docker-container&#34;&gt;7. Exit the docker container&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;exit
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;8-check-docker-container-status&#34;&gt;8. Check docker container status&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;sudo docker ps
sudo docker stats
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;9-stop-and-remove-a-docker-instance&#34;&gt;9.   Stop and remove a docker instance&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;sudo docker stop bio1
sudo docker rm bio1
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Predict mass shootings</title>
      <link>/post/predict-mass-shootings/</link>
      <pubDate>Mon, 02 Jul 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/predict-mass-shootings/</guid>
      <description>

&lt;p&gt;Using the mass shooting data from &lt;a href=&#34;https://www.motherjones.com/politics/2012/12/mass-shootings-mother-jones-full-data/&#34; target=&#34;_blank&#34;&gt;Mother Jones website,&lt;/a&gt;
I tried to forecast the number of mass shoottings and total fatalities in the rest of 2018. Some of the R scripts are from this &lt;a href=&#34;http://a-little-book-of-r-for-time-series.readthedocs.io/en/latest/src/timeseries.html&#34; target=&#34;_blank&#34;&gt;website.&lt;/a&gt; Please let me know if I there is any error. I am not an expert on time series analysis. &lt;a href=&#34;www.twitter.com&#34; target=&#34;_blank&#34;&gt;Twitter&lt;/a&gt; @StevenXGe&lt;/p&gt;

&lt;p&gt;In recent years, mass shootings are becomming more frequent and more deadly. The models suggest for the rest of 2018, there probably be about 6 more shootings, killing about 59 people in the U.S.&lt;/p&gt;

&lt;p&gt;#Data&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;url = &amp;quot;https://docs.google.com/spreadsheet/pub?key=0AswaDV9q95oZdG5fVGJTS25GQXhSTDFpZXE0RHhUdkE&amp;amp;output=csv&amp;quot;
x = read.csv(url)
colnames(x)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##  [1] &amp;quot;case&amp;quot;                               
##  [2] &amp;quot;location&amp;quot;                           
##  [3] &amp;quot;date&amp;quot;                               
##  [4] &amp;quot;year&amp;quot;                               
##  [5] &amp;quot;summary&amp;quot;                            
##  [6] &amp;quot;Fatalities&amp;quot;                         
##  [7] &amp;quot;Injured&amp;quot;                            
##  [8] &amp;quot;total_victims&amp;quot;                      
##  [9] &amp;quot;Venue&amp;quot;                              
## [10] &amp;quot;Prior.signs.of.mental.health.issues&amp;quot;
## [11] &amp;quot;Mental.health...details&amp;quot;            
## [12] &amp;quot;Weapons.obtained.legally&amp;quot;           
## [13] &amp;quot;Where.obtained&amp;quot;                     
## [14] &amp;quot;Type.of.weapons&amp;quot;                    
## [15] &amp;quot;Weapon.details&amp;quot;                     
## [16] &amp;quot;Race&amp;quot;                               
## [17] &amp;quot;Gender&amp;quot;                             
## [18] &amp;quot;Sources&amp;quot;                            
## [19] &amp;quot;Mental.Health.Sources&amp;quot;              
## [20] &amp;quot;latitude&amp;quot;                           
## [21] &amp;quot;longitude&amp;quot;                          
## [22] &amp;quot;Type&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;#Data cleaning&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;x = x[,c(&amp;quot;date&amp;quot;,&amp;quot;year&amp;quot;,&amp;quot;Fatalities&amp;quot;,&amp;quot;Race&amp;quot;,&amp;quot;Gender&amp;quot;,&amp;quot;Type&amp;quot;)]
x$Race = gsub(&amp;quot;white&amp;quot;,&amp;quot;White&amp;quot;,as.character(x$Race) )
x$Race = as.factor(x$Race)
summary(x)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##         date         year        Fatalities          Race   
##           : 2   Min.   :1982   Min.   : 3.000   White  :56  
##  1/17/1989: 1   1st Qu.:1998   1st Qu.: 5.000   black  : 9  
##  1/28/18  : 1   Median :2009   Median : 6.000   Asian  : 8  
##  1/30/2006: 1   Mean   :2006   Mean   : 8.313   Black  : 7  
##  1/6/2017 : 1   3rd Qu.:2015   3rd Qu.: 8.000   Latino : 7  
##  1/8/2011 : 1   Max.   :2018   Max.   :58.000   Other  : 5  
##  (Other)  :94   NA&#39;s   :2      NA&#39;s   :2        (Other): 9  
##            Gender      Type   
##               : 2        : 2  
##  Female       : 2   Mass :85  
##  M            :26   Spree:14  
##  Male         :70             
##  Male &amp;amp; Female: 1             
##                               
## 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;x = subset(x,x$year != 2018)
x$date = as.Date(x$date,&amp;quot;%m/%d/%Y&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;the-number-of-mass-shootings-per-year&#34;&gt;The number of mass shootings per year&lt;/h1&gt;

&lt;p&gt;There is no mass shooting in 1983, 1985, and 2002.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;yearly = table(x$year)
yearly = c(1,0, yearly)
names(yearly)[1:4]= 1982:1985
yearly[3]=2
yearly[4]=0 
yearly = c(yearly[1:20],0, yearly[21:35])
names(yearly)[21] = &amp;quot;2002&amp;quot;
barplot(yearly)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-predict-mass-shootings_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Clearly, the frequency of mass shootings is increasing in the last 6 years.&lt;/p&gt;

&lt;h2 id=&#34;time-series-model&#34;&gt;Time series model&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;series = ts(yearly,start=c(1982)) 
yforecast = HoltWinters(series, beta=FALSE, gamma=FALSE)
yforecast
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## Holt-Winters exponential smoothing without trend and without seasonal component.
## 
## Call:
## HoltWinters(x = series, beta = FALSE, gamma = FALSE)
## 
## Smoothing parameters:
##  alpha: 0.5024872
##  beta : FALSE
##  gamma: FALSE
## 
## Coefficients:
##       [,1]
## a 8.446514
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;plot(yforecast, main=&amp;quot;Number of mass shootings &amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-predict-mass-shootings_files/figure-html/unnamed-chunk-3-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;p&gt;The red line is probably the model.&lt;/p&gt;

&lt;h2 id=&#34;making-forecast&#34;&gt;Making forecast&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# install.packages(&amp;quot;forecast&amp;quot;)
library(forecast)
shottings = forecast(yforecast, h = 1)
shottings
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##      Point Forecast    Lo 80   Hi 80    Lo 95    Hi 95
## 2018       8.446514 6.239526 10.6535 5.071217 11.82181
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The model predicts there would be about 8.4 mass shootings this year. Since 2 already happened. There probably would be 6 incidences of mass shooting for the rest of 2018. The 95% confidence interval is between 5 and  11. So it is very likely at least 3 more shootings will occur in 2018.&lt;/p&gt;

&lt;h1 id=&#34;total-fatalities-in-2018&#34;&gt;Total fatalities in 2018&lt;/h1&gt;

&lt;h2 id=&#34;prepare-data&#34;&gt;Prepare data&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;tem = aggregate(x$Fatalities, by=list(x$year), FUN=sum)
tem2 = rbind( tem[1,], c(1983,0), tem[2,],c(1985,0),tem[3:18,], c(2002, 0), tem[19:33, ] ) 
fatalities = tem2[,2]
names(fatalities) = tem2[,1]
barplot(fatalities, las=2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-predict-mass-shootings_files/figure-html/unnamed-chunk-5-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;p&gt;This data is noisy, but we still see an uptake in total fatalities in the last 10 years.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;series = ts(fatalities,start=c(1982))
yforecast = HoltWinters(series, beta=FALSE, gamma=FALSE)
yforecast
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;## Holt-Winters exponential smoothing without trend and without seasonal component.
## 
## Call:
## HoltWinters(x = series, beta = FALSE, gamma = FALSE)
## 
## Smoothing parameters:
##  alpha: 0.4323295
##  beta : FALSE
##  gamma: FALSE
## 
## Coefficients:
##       [,1]
## a 79.90564
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;plot(yforecast, main=&amp;quot;Total fatalities from mass shooting&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/post/2018-07-02-predict-mass-shootings_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;shottings = forecast(yforecast, h = 1)
shottings
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;##      Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95
## 2018       79.90564 53.81795 105.9933 40.00795 119.8033
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;So this model predicts that about 80 people will be killed in mass shootings in 2018. Since there were 21 in Florida and Pennsylvania already. The rest of 2018 will see about 59 people getting killed. I hope these are not going to happen in schools.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Privacy Policy</title>
      <link>/privacy/</link>
      <pubDate>Thu, 28 Jun 2018 00:00:00 -0500</pubDate>
      
      <guid>/privacy/</guid>
      <description>&lt;p&gt;&amp;hellip;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Example Talk</title>
      <link>/talk/example-talk/</link>
      <pubDate>Sun, 01 Jan 2017 00:00:00 -0600</pubDate>
      
      <guid>/talk/example-talk/</guid>
      <description>&lt;p&gt;Embed your slides or video here using &lt;a href=&#34;https://sourcethemes.com/academic/post/writing-markdown-latex/&#34; target=&#34;_blank&#34;&gt;shortcodes&lt;/a&gt;. Further details can easily be added using &lt;em&gt;Markdown&lt;/em&gt; and $\rm \LaTeX$ math code.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Deep Learning</title>
      <link>/project/deep-learning/</link>
      <pubDate>Wed, 27 Apr 2016 00:00:00 -0500</pubDate>
      
      <guid>/project/deep-learning/</guid>
      <description>&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.&lt;/p&gt;

&lt;p&gt;Nullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.&lt;/p&gt;

&lt;p&gt;Cras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.&lt;/p&gt;

&lt;p&gt;Suspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.&lt;/p&gt;

&lt;p&gt;Aliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>External Project</title>
      <link>/project/example-external-project/</link>
      <pubDate>Wed, 27 Apr 2016 00:00:00 -0500</pubDate>
      
      <guid>/project/example-external-project/</guid>
      <description></description>
    </item>
    
    <item>
      <title>A Person Re-Identification System For Mobile Devices</title>
      <link>/publication/person-re-identification/</link>
      <pubDate>Tue, 01 Sep 2015 00:00:00 -0500</pubDate>
      
      <guid>/publication/person-re-identification/</guid>
      <description>&lt;p&gt;More detail can easily be written here using &lt;em&gt;Markdown&lt;/em&gt; and $\rm \LaTeX$ math code.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Mobile visual clothing search</title>
      <link>/publication/clothing-search/</link>
      <pubDate>Mon, 01 Jul 2013 00:00:00 -0500</pubDate>
      
      <guid>/publication/clothing-search/</guid>
      <description>&lt;p&gt;More detail can easily be written here using &lt;em&gt;Markdown&lt;/em&gt; and $\rm \LaTeX$ math code.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
